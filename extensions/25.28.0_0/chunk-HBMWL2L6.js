import{b as be}from"./chunk-IEY2ZFRQ.js";import{mc as z,nc as ve,oc as Se}from"./chunk-FDJQKATD.js";import{T as H,W as ne,bc as ae,ec as q}from"./chunk-MP5PPKB7.js";import{B as te,D as re,l as u}from"./chunk-NRW4C74H.js";import{c as U,f as W,h as b,l as $e,m as Buffer,n as A}from"./chunk-YJSZZTEX.js";var De=U((_,we)=>{b();A();var Ae=typeof self<"u"?self:_,Z=function(){function r(){this.fetch=!1,this.DOMException=Ae.DOMException}return r.prototype=Ae,new r}();(function(r){var a=function(e){var n={searchParams:"URLSearchParams"in r,iterable:"Symbol"in r&&"iterator"in Symbol,blob:"FileReader"in r&&"Blob"in r&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in r,arrayBuffer:"ArrayBuffer"in r};function s(t){return t&&DataView.prototype.isPrototypeOf(t)}if(n.arrayBuffer)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(t){return t&&o.indexOf(Object.prototype.toString.call(t))>-1};function f(t){if(typeof t!="string"&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function i(t){return typeof t!="string"&&(t=String(t)),t}function h(t){var c={next:function(){var y=t.shift();return{done:y===void 0,value:y}}};return n.iterable&&(c[Symbol.iterator]=function(){return c}),c}function l(t){this.map={},t instanceof l?t.forEach(function(c,y){this.append(y,c)},this):Array.isArray(t)?t.forEach(function(c){this.append(c[0],c[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(c){this.append(c,t[c])},this)}l.prototype.append=function(t,c){t=f(t),c=i(c);var y=this.map[t];this.map[t]=y?y+", "+c:c},l.prototype.delete=function(t){delete this.map[f(t)]},l.prototype.get=function(t){return t=f(t),this.has(t)?this.map[t]:null},l.prototype.has=function(t){return this.map.hasOwnProperty(f(t))},l.prototype.set=function(t,c){this.map[f(t)]=i(c)},l.prototype.forEach=function(t,c){for(var y in this.map)this.map.hasOwnProperty(y)&&t.call(c,this.map[y],y,this)},l.prototype.keys=function(){var t=[];return this.forEach(function(c,y){t.push(y)}),h(t)},l.prototype.values=function(){var t=[];return this.forEach(function(c){t.push(c)}),h(t)},l.prototype.entries=function(){var t=[];return this.forEach(function(c,y){t.push([y,c])}),h(t)},n.iterable&&(l.prototype[Symbol.iterator]=l.prototype.entries);function m(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function w(t){return new Promise(function(c,y){t.onload=function(){c(t.result)},t.onerror=function(){y(t.error)}})}function v(t){var c=new FileReader,y=w(c);return c.readAsArrayBuffer(t),y}function p(t){var c=new FileReader,y=w(c);return c.readAsText(t),y}function x(t){for(var c=new Uint8Array(t),y=new Array(c.length),P=0;P<c.length;P++)y[P]=String.fromCharCode(c[P]);return y.join("")}function D(t){if(t.slice)return t.slice(0);var c=new Uint8Array(t.byteLength);return c.set(new Uint8Array(t)),c.buffer}function T(){return this.bodyUsed=!1,this._initBody=function(t){this._bodyInit=t,t?typeof t=="string"?this._bodyText=t:n.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:n.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:n.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():n.arrayBuffer&&n.blob&&s(t)?(this._bodyArrayBuffer=D(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):n.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||d(t))?this._bodyArrayBuffer=D(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||(typeof t=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n.blob&&(this.blob=function(){var t=m(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?m(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(v)}),this.text=function(){var t=m(this);if(t)return t;if(this._bodyBlob)return p(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(x(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n.formData&&(this.formData=function(){return this.text().then(R)}),this.json=function(){return this.text().then(JSON.parse)},this}var B=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function I(t){var c=t.toUpperCase();return B.indexOf(c)>-1?c:t}function S(t,c){c=c||{};var y=c.body;if(t instanceof S){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,c.headers||(this.headers=new l(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,!y&&t._bodyInit!=null&&(y=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=c.credentials||this.credentials||"same-origin",(c.headers||!this.headers)&&(this.headers=new l(c.headers)),this.method=I(c.method||this.method||"GET"),this.mode=c.mode||this.mode||null,this.signal=c.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&y)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(y)}S.prototype.clone=function(){return new S(this,{body:this._bodyInit})};function R(t){var c=new FormData;return t.trim().split("&").forEach(function(y){if(y){var P=y.split("="),F=P.shift().replace(/\+/g," "),E=P.join("=").replace(/\+/g," ");c.append(decodeURIComponent(F),decodeURIComponent(E))}}),c}function k(t){var c=new l,y=t.replace(/\r?\n[\t ]+/g," ");return y.split(/\r?\n/).forEach(function(P){var F=P.split(":"),E=F.shift().trim();if(E){var X=F.join(":").trim();c.append(E,X)}}),c}T.call(S.prototype);function C(t,c){c||(c={}),this.type="default",this.status=c.status===void 0?200:c.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in c?c.statusText:"OK",this.headers=new l(c.headers),this.url=c.url||"",this._initBody(t)}T.call(C.prototype),C.prototype.clone=function(){return new C(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},C.error=function(){var t=new C(null,{status:0,statusText:""});return t.type="error",t};var N=[301,302,303,307,308];C.redirect=function(t,c){if(N.indexOf(c)===-1)throw new RangeError("Invalid status code");return new C(null,{status:c,headers:{location:t}})},e.DOMException=r.DOMException;try{new e.DOMException}catch{e.DOMException=function(c,y){this.message=c,this.name=y;var P=Error(c);this.stack=P.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function M(t,c){return new Promise(function(y,P){var F=new S(t,c);if(F.signal&&F.signal.aborted)return P(new e.DOMException("Aborted","AbortError"));var E=new XMLHttpRequest;function X(){E.abort()}E.onload=function(){var j={status:E.status,statusText:E.statusText,headers:k(E.getAllResponseHeaders()||"")};j.url="responseURL"in E?E.responseURL:j.headers.get("X-Request-URL");var g="response"in E?E.response:E.responseText;y(new C(g,j))},E.onerror=function(){P(new TypeError("Network request failed"))},E.ontimeout=function(){P(new TypeError("Network request failed"))},E.onabort=function(){P(new e.DOMException("Aborted","AbortError"))},E.open(F.method,F.url,!0),F.credentials==="include"?E.withCredentials=!0:F.credentials==="omit"&&(E.withCredentials=!1),"responseType"in E&&n.blob&&(E.responseType="blob"),F.headers.forEach(function(j,g){E.setRequestHeader(g,j)}),F.signal&&(F.signal.addEventListener("abort",X),E.onreadystatechange=function(){E.readyState===4&&F.signal.removeEventListener("abort",X)}),E.send(typeof F._bodyInit>"u"?null:F._bodyInit)})}return M.polyfill=!0,r.fetch||(r.fetch=M,r.Headers=l,r.Request=S,r.Response=C),e.Headers=l,e.Request=S,e.Response=C,e.fetch=M,Object.defineProperty(e,"__esModule",{value:!0}),e}({})})(Z);Z.fetch.ponyfill=!0;delete Z.fetch.polyfill;var K=Z;_=K.fetch;_.default=K.fetch;_.fetch=K.fetch;_.Headers=K.Headers;_.Request=K.Request;_.Response=K.Response;we.exports=_});var xe=U((Dt,Ee)=>{b();A();(function(){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a={rotl:function(e,n){return e<<n|e>>>32-n},rotr:function(e,n){return e<<32-n|e>>>n},endian:function(e){if(e.constructor==Number)return a.rotl(e,8)&16711935|a.rotl(e,24)&4278255360;for(var n=0;n<e.length;n++)e[n]=a.endian(e[n]);return e},randomBytes:function(e){for(var n=[];e>0;e--)n.push(Math.floor(Math.random()*256));return n},bytesToWords:function(e){for(var n=[],s=0,o=0;s<e.length;s++,o+=8)n[o>>>5]|=e[s]<<24-o%32;return n},wordsToBytes:function(e){for(var n=[],s=0;s<e.length*32;s+=8)n.push(e[s>>>5]>>>24-s%32&255);return n},bytesToHex:function(e){for(var n=[],s=0;s<e.length;s++)n.push((e[s]>>>4).toString(16)),n.push((e[s]&15).toString(16));return n.join("")},hexToBytes:function(e){for(var n=[],s=0;s<e.length;s+=2)n.push(parseInt(e.substr(s,2),16));return n},bytesToBase64:function(e){for(var n=[],s=0;s<e.length;s+=3)for(var o=e[s]<<16|e[s+1]<<8|e[s+2],d=0;d<4;d++)s*8+d*6<=e.length*8?n.push(r.charAt(o>>>6*(3-d)&63)):n.push("=");return n.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/ig,"");for(var n=[],s=0,o=0;s<e.length;o=++s%4)o!=0&&n.push((r.indexOf(e.charAt(s-1))&Math.pow(2,-2*o+8)-1)<<o*2|r.indexOf(e.charAt(s))>>>6-o*2);return n}};Ee.exports=a})()});var oe=U((Tt,Te)=>{b();A();var se={utf8:{stringToBytes:function(r){return se.bin.stringToBytes(unescape(encodeURIComponent(r)))},bytesToString:function(r){return decodeURIComponent(escape(se.bin.bytesToString(r)))}},bin:{stringToBytes:function(r){for(var a=[],e=0;e<r.length;e++)a.push(r.charCodeAt(e)&255);return a},bytesToString:function(r){for(var a=[],e=0;e<r.length;e++)a.push(String.fromCharCode(r[e]));return a.join("")}}};Te.exports=se});var Ce=U((Ft,Re)=>{b();A();(function(){var r=xe(),a=oe().utf8,e=oe().bin,n=function(o){o.constructor==String?o=a.stringToBytes(o):typeof Buffer<"u"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(o)?o=Array.prototype.slice.call(o,0):Array.isArray(o)||(o=o.toString());var d=r.bytesToWords(o),f=o.length*8,i=[],h=1732584193,l=-271733879,m=-1732584194,w=271733878,v=-1009589776;d[f>>5]|=128<<24-f%32,d[(f+64>>>9<<4)+15]=f;for(var p=0;p<d.length;p+=16){for(var x=h,D=l,T=m,B=w,I=v,S=0;S<80;S++){if(S<16)i[S]=d[p+S];else{var R=i[S-3]^i[S-8]^i[S-14]^i[S-16];i[S]=R<<1|R>>>31}var k=(h<<5|h>>>27)+v+(i[S]>>>0)+(S<20?(l&m|~l&w)+1518500249:S<40?(l^m^w)+1859775393:S<60?(l&m|l&w|m&w)-1894007588:(l^m^w)-899497514);v=w,w=m,m=l<<30|l>>>2,l=h,h=k}h+=x,l+=D,m+=T,w+=B,v+=I}return[h,l,m,w,v]},s=function(o,d){var f=r.wordsToBytes(n(o));return d&&d.asBytes?f:d&&d.asString?e.bytesToString(f):r.bytesToHex(f)};s._blocksize=16,s._digestsize=20,Re.exports=s})()});var Be=U((_t,Xe)=>{Xe.exports={name:"@phantom-labs/blocklist",version:"0.13.0",main:"index.js",types:"index.d.ts",repository:"git@github.com:phantom-labs/blocklist.git",author:"Jordan Leigh <AlwaysBCoding@gmail.com>",license:"MIT",scripts:{build:"node build.js"},dependencies:{"js-yaml":"^4.1.0",sha3:"^2.1.4"}}});var Ie=U((Lt,qe)=>{qe.exports={blocklist:["phantomweb.app","aurory.app","solvision.io","staratlas.art","starsatlas.com","sollet.cc","raydlum.io","aurorynft.com","sneks.gg","solletweb.io","i-sollet.com","fancyfrenchienft.art","solanawebwallet.online","phahtom.com","server-syncwallet.com","staratias.app","raydium.network","grapesnetwork.me","staratias.art","soistarter.org","audius-nft.top","aurory.me","degenapes.app","phantom-app.online","phantomwallet.net","dapps-node.com","phantom-app.link","solanaoutage.com","walletconnectdapps.net","staratlas.cx","web-phantom.app","0120tt.com"],whitelist:[],fuzzylist:[],contentHash:"830ea1c9a833213eabc17990adf053081f503b1203ca9a2c711db7199e657293"}});var Pe=U(le=>{b();A();var{version:Ze}=Be(),Qe=Ie(),Ye=()=>Ze,et=()=>Qe;le.getVersion=Ye;le.getBlocklist=et});var Ue=U(G=>{"use strict";b();A();G.__esModule=!0;G.distance=G.closest=void 0;var L=new Uint32Array(65536),tt=function(r,a){for(var e=r.length,n=a.length,s=1<<e-1,o=-1,d=0,f=e,i=e;i--;)L[r.charCodeAt(i)]|=1<<i;for(i=0;i<n;i++){var h=L[a.charCodeAt(i)],l=h|d;h|=(h&o)+o^o,d|=~(h|o),o&=h,d&s&&f++,o&s&&f--,d=d<<1|1,o=o<<1|~(l|d),d&=l}for(i=e;i--;)L[r.charCodeAt(i)]=0;return f},rt=function(r,a){for(var e=a.length,n=r.length,s=[],o=[],d=Math.ceil(e/32),f=Math.ceil(n/32),i=0;i<d;i++)o[i]=-1,s[i]=0;for(var h=0;h<f-1;h++){for(var l=0,m=-1,w=h*32,v=Math.min(32,n)+w,p=w;p<v;p++)L[r.charCodeAt(p)]|=1<<p;for(var i=0;i<e;i++){var x=L[a.charCodeAt(i)],D=o[i/32|0]>>>i&1,T=s[i/32|0]>>>i&1,B=x|l,I=((x|T)&m)+m^m|x|T,S=l|~(I|m),R=m&I;S>>>31^D&&(o[i/32|0]^=1<<i),R>>>31^T&&(s[i/32|0]^=1<<i),S=S<<1|D,R=R<<1|T,m=R|~(B|S),l=S&B}for(var p=w;p<v;p++)L[r.charCodeAt(p)]=0}for(var k=0,C=-1,N=h*32,M=Math.min(32,n-N)+N,p=N;p<M;p++)L[r.charCodeAt(p)]|=1<<p;for(var t=n,i=0;i<e;i++){var x=L[a.charCodeAt(i)],D=o[i/32|0]>>>i&1,T=s[i/32|0]>>>i&1,B=x|k,I=((x|T)&C)+C^C|x|T,S=k|~(I|C),R=C&I;t+=S>>>n-1&1,t-=R>>>n-1&1,S>>>31^D&&(o[i/32|0]^=1<<i),R>>>31^T&&(s[i/32|0]^=1<<i),S=S<<1|D,R=R<<1|T,C=R|~(B|S),k=S&B}for(var p=N;p<M;p++)L[r.charCodeAt(p)]=0;return t},ke=function(r,a){if(r.length<a.length){var e=a;a=r,r=e}return a.length===0?r.length:r.length<=32?tt(r,a):rt(r,a)};G.distance=ke;var nt=function(r,a){for(var e=1/0,n=0,s=0;s<a.length;s++){var o=ke(r,a[s]);o<e&&(e=o,n=s)}return a[n]};G.closest=nt});var _e=U((de,$)=>{b();A();(function(){"use strict";var r;try{r=typeof Intl<"u"&&typeof Intl.Collator<"u"?Intl.Collator("generic",{sensitivity:"base"}):null}catch{console.log("Collator could not be initialized and wouldn't be used")}var a=Ue(),e=[],n=[],s={get:function(o,d,f){var i=f&&r&&f.useCollator;if(i){var h=o.length,l=d.length;if(h===0)return l;if(l===0)return h;var m,w,v,p,x;for(v=0;v<l;++v)e[v]=v,n[v]=d.charCodeAt(v);e[l]=l;var D;for(v=0;v<h;++v){for(w=v+1,p=0;p<l;++p)m=w,D=r.compare(o.charAt(v),String.fromCharCode(n[p]))===0,w=e[p]+(D?0:1),x=m+1,w>x&&(w=x),x=e[p+1]+1,w>x&&(w=x),e[p]=m;e[p]=w}return w}return a.distance(o,d)}};typeof define<"u"&&define!==null&&define.amd?define(function(){return s}):typeof $<"u"&&$!==null&&typeof de<"u"&&$.exports===de?$.exports=s:(typeof self<"u"&&typeof self.postMessage=="function"&&typeof self.importScripts=="function"||typeof self<"u"&&self!==null)&&(self.Levenshtein=s)})()});b();A();b();A();var Fe=W(De(),1),Oe=W(Ce(),1),ie=W($e(),1),V=(r=>(r.BLOCK="BLOCK",r.NONE="NONE",r))(V||{});function Je(r,a){for(let e=0;e<r.k;e++){let n=(0,Oe.default)(`${r.salt}_${a}_${e}`,{asBytes:!0}),o=ie.Buffer.from(n).subarray(0,4).readUInt32BE(0)%r.bits,d=Math.floor(o/24),f=ie.Buffer.from(r.bitVector.slice(d*4,d*4+4),"base64"),i=o%24,h=Math.floor(i/8),l=i%8;if(!(f[h]&1<<7-l))return!1}return!0}var It=typeof self<"u"&&self.fetch?self.fetch:Fe.default;function ce(r,a,e,n){let o=new URL(n).hostname.toLowerCase().replace(/\.$/,"").split(".");for(let d=0;d<o.length-1;d++){let f=o.slice(d).join(".");if(a.includes(f)||Je(r,f)&&!e.includes(f))return"BLOCK"}return"NONE"}var Q=W(Pe());var ze=W(_e());b();A();var Le="https://blocklist.phantom.app/multichain.json",ue="https://blowfish-blocklist-proxy.phantom.app",at="https://github.com/phantom-labs/blocklist",Wt=(r=3)=>({retry:r,retryDelay:a=>Math.min(1e3*2**a,3e4)}),st={SLIPPAGE_EXCEEDED:"SLIPPAGE_EXCEEDED",INSUFFICIENT_FUNDS:"INSUFFICIENT_FUNDS",INSUFFICIENT_GAS:"INSUFFICIENT_GAS",UNKNOWN_ERROR:"UNKNOWN_ERROR",SIMULATION_FAILED:"SIMULATION_FAILED",TRANSACTION_EXPIRED:"TRANSACTION_EXPIRED",ACCOUNT_FROZEN:"ACCOUNT_FROZEN",SIMULATION_TIMEOUT:"SIMULATION_TIMEOUT",STALE_QUOTE:"STALE_QUOTE"};function ot(r){return{1:"1-critical-alert",2:"2-alert",3:"3-critical-error",4:"4-error",5:"5-information"}[r]}var ct=3,me=6e5,lt=6e4,ar=u.object({type:u.union([u.literal("all"),u.literal("blocklist"),u.literal("whitelist"),u.literal("error"),u.literal("fuzzy"),u.literal("blowfishBloomFilter")]),result:u.boolean(),source:u.optional(u.string()),match:u.string().optional(),isSubdomainDomainWhitelisted:u.boolean().optional()}),sr=u.object({localHash:u.any(),cursor:u.any()}),ye=u.object({bitVector:u.string(),k:u.number(),hash:u.string(),bits:u.number(),salt:u.string()}),Ke=u.union([u.object({bloomFilter:ye,bloomFilterHash:u.string(),recentlyAdded:u.array(u.string()),recentlyRemoved:u.array(u.string()),nextCursor:u.string()}),u.object({bloomFilter:ye.optional(),bloomFilterHash:u.optional(u.string()),recentlyAdded:u.array(u.string()),recentlyRemoved:u.array(u.string()),nextCursor:u.string()})]),Ve=u.object({bloomFilter:ye,lastUpdated:u.number()}).nullish(),Ge=u.object({recentlyAdded:u.array(u.string()),recentlyRemoved:u.array(u.string()),lastUpdated:u.number().optional()}).nullish(),J=class{blocklist;whitelist;fuzzylist;tolerance;constructor(a,e,n,s){this.blocklist=fe(a),this.whitelist=fe(e),this.fuzzylist=fe(n),this.tolerance=s||ct}check(a,e){if(!a)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let n=Y(a),s=ge(n);if(ut(s,this.whitelist)){let i=new URL(a).hostname;if(he(ge(i),this.blocklist)){let l={type:"blocklist",result:!0,source:i,isSubdomainDomainWhitelisted:!0};return e.capture("blockedDomain",{data:l}),l}else return{type:"whitelist",result:!1,source:i,isSubdomainDomainWhitelisted:!0}}if(he(s,this.whitelist))return{type:"whitelist",result:!1,source:n,isSubdomainDomainWhitelisted:!1};if(he(s,this.blocklist)){let i={type:"blocklist",result:!0,source:n,isSubdomainDomainWhitelisted:!1};return e.capture("blockedDomain",{data:i}),i}if(this.tolerance>0){let i=He(s);i=i.replace("www.","");let h=this.fuzzylist.find(l=>{let m=He(l);return ze.default.get(i,m)<=this.tolerance});if(h)return{type:"fuzzy",result:!0,match:dt(h),source:n,isSubdomainDomainWhitelisted:!1}}return{type:"all",result:!1,source:n,isSubdomainDomainWhitelisted:!1}}},Y=r=>{let a=new URL(r).hostname.replace(/\.$/,"").split(".");return a.slice(0).slice(-(a.length===4?3:2)).join(".")},fe=r=>r.map(ge),ge=r=>r.split(".").reverse(),dt=r=>r.slice().reverse().join("."),He=r=>r.slice(1).reverse().join("."),he=(r,a)=>a.some(e=>e.length>r.length?!1:e.every((n,s)=>r[s]===n)),ut=(r,a)=>a.some(e=>e[0]===r[0]&&e[1]===r[1]&&e[2]==="*"),ft=async r=>{let a=(0,Q.getBlocklist)(),e=await r.get("cachedBlocklistDiff"),n=null;try{n=JSON.parse(`${e}`)}catch(s){q.captureError(new Error(`Error parsing blocklist diff: ${s?.message}`),"generic")}if(n&&n.expiresAt&&n.expiresAt>Date.now())return new J(a.blocklist.concat(n.blocklist),a.whitelist.concat(n.whitelist),a.fuzzylist.concat(n.fuzzylist));{let s={},o=(0,Q.getVersion)();n&&(s.lastContentHash=`${n.contentHash}`),o&&(s.localBlocklistVersion=`${o}`);let d=await H.headers(s).get(Le);if(d.status===200){let f=d.data;return f.expiresAt=Date.now()+me,r.set("cachedBlocklistDiff",JSON.stringify(f)),new J(a.blocklist.concat(f.blocklist),a.whitelist.concat(f.whitelist),a.fuzzylist.concat(f.fuzzylist))}else{if(d.status===304)return n.expiresAt=Date.now()+me,r.set("cachedBlocklistDiff",JSON.stringify(n)),new J(a.blocklist.concat(n.blocklist),a.whitelist.concat(n.whitelist),a.fuzzylist.concat(n.fuzzylist));throw new Error("Invalid response from blocklist")}}},ht=async(r,a,e)=>{let n,s;try{n=await ae.isFeatureEnabledAsync("kill-blowfish-blocklist-cursor"),s=await ae.isFeatureEnabledAsync("kill-previous-blocklist")}catch{n=!1,s=!1}let o;try{if(s)return n?Me(e,r,a):Ne(e,r,a);{o=await ft(r);let d=o.check(e,a);return d.type==="all"?n?Me(e,r,a):Ne(e,r,a):d}}catch{return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}}},Ne=async(r,a,e)=>{if(!r)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let n=Y(r),s=await a.getAll(["cachedBloomFilter","cachedBloomFilterHash","cachedScanDataRecents","cachedScanDataCursor"]),o=s.cachedBloomFilter??null,d=s.cachedBloomFilterHash??null,f=s.cachedScanDataCursor??null,i=s.cachedScanDataRecents??null,h=null,l={recentlyAdded:[],recentlyRemoved:[],lastUpdated:0},m=null;if(o){let v=Ve.safeParse(o);v.success?h=v.data:await pe(a)}if(i){let v=Ge.safeParse(i);v.success?l=v.data:await pe(a)}if(f){let p=u.string().safeParse(f);p.success?m=p.data:await pe(a)}if(!l||l.lastUpdated==null||Date.now()>l.lastUpdated+lt){let v={localHash:d,cursor:m},p=await H.post(ue,v);if(p.status!==200)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let x=p.data,D,T=Ke.safeParse(x);if(T.success)D=T.data;else return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let B=[],I=[],S=typeof d=="string"&&D.bloomFilterHash?d!==D.bloomFilterHash:!1;l!=null&&!S&&(B=l.recentlyAdded,I=l.recentlyRemoved),B=B.concat(D.recentlyAdded),I=I.concat(D.recentlyRemoved),B=B.filter(k=>D.recentlyRemoved.indexOf(k)<0),I=I.filter(k=>D.recentlyAdded.indexOf(k)<0);let R={recentlyAdded:B,recentlyRemoved:I,lastUpdated:Date.now()};if(await a.set("cachedScanDataRecents",R),l=R,D.nextCursor!==m&&await a.set("cachedScanDataCursor",D.nextCursor),D.bloomFilter!=null){let k={bloomFilter:D.bloomFilter,lastUpdated:Date.now()};await Promise.all([a.set("cachedBloomFilter",k),a.set("cachedBloomFilterHash",D.bloomFilterHash)]),h=k}}if(!h)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let w=ce(h.bloomFilter,l.recentlyAdded,l.recentlyRemoved,r);if(w===V.BLOCK){let v={result:!0,source:n,type:"blowfishBloomFilter"};return e.capture("blockedDomain",{data:v}),v}else if(w===V.NONE)return{result:!1,type:"all",isSubdomainDomainWhitelisted:!1};return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}};async function pe(r){await r.remove(["cachedBloomFilter","cachedBloomFilterHash","cachedScanDataRecents","cachedScanDataCursor"])}var Me=async(r,a,e)=>{if(!r)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let n=Y(r),s=await a.getAll(["cachedBloomFilter","cachedBloomFilterHash","cachedScanDataRecents"]),o=s.cachedBloomFilter??null,d=s.cachedBloomFilterHash??null,f=s.cachedScanDataRecents??null,i=null,h={recentlyAdded:[],recentlyRemoved:[],lastUpdated:0};if(o){let m=Ve.safeParse(o);m.success?i=m.data:await a.remove(["cachedBloomFilter","cachedBloomFilterHash","cachedScanDataRecents"])}if(f){let m=Ge.safeParse(f);m.success?h=m.data:await a.remove(["cachedBloomFilter","cachedBloomFilterHash","cachedScanDataRecents"])}if(!h||h.lastUpdated==null||Date.now()>h.lastUpdated+me){let m={localHash:d},w=await H.post(ue,m);if(w.status!==200)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let v=w.data,p,x=Ke.safeParse(v);if(x.success)p=x.data;else return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let D={recentlyAdded:p.recentlyAdded,recentlyRemoved:p.recentlyRemoved,lastUpdated:Date.now()};if(await a.set("cachedScanDataRecents",D),h=D,p.bloomFilter!=null){let T={bloomFilter:p.bloomFilter,lastUpdated:Date.now()};await Promise.all([a.set("cachedBloomFilter",T),a.set("cachedBloomFilterHash",p.bloomFilterHash)]),i=T}}if(!i)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let l=ce(i.bloomFilter,h.recentlyAdded,h.recentlyRemoved,r);if(l===V.BLOCK){let m={result:!0,source:n,type:"blowfishBloomFilter"};return e.capture("blockedDomain",{data:m}),m}else if(l===V.NONE)return{result:!1,type:"all",isSubdomainDomainWhitelisted:!1};return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}};b();A();b();A();var pt=r=>r/1e8;b();A();b();A();var ee={GREEN:"accentSuccess",RED:"accentAlert",WHITE:"textPrimary"};function yt(r){switch(r){case"PLUS":return ee.GREEN;case"MINUS":return ee.RED;case"EQUAL":return ee.WHITE;default:return ee.WHITE}}function gt(r){let a=r?.advancedDetails&&"safeguard"in r.advancedDetails?r?.advancedDetails?.safeguard:void 0;if(a?.recommended&&!a?.shouldBundle&&!a.error&&!a.verifyError&&a?.transactions&&a.transactions.length>0)return a.transactions}function je(r,a){if(r.params&&"safeguard"in r.params&&r.params.safeguard&&a?.advancedDetails&&"safeguard"in a.advancedDetails&&a.advancedDetails.safeguard?.transactions){let e=a.advancedDetails.safeguard;if(e.error)return e.error;let n=r.params.transactions,s=e.transactions;if(s){let o;try{Se(n,s)}catch(d){d instanceof z?o=d:d instanceof Error?o=z.createUnknownError(d.message):o=z.createUnknownError("Non error type",d)}if(o)return a.advancedDetails.safeguard.verifyError=o,o}}}function We(r){if(r.advancedDetails&&"requestId"in r.advancedDetails)return r.advancedDetails.requestId}b();A();b();A();var vt=async(r,a,e)=>{let n=`/simulation/v1?language=${r}`,s=await H.api().post(n,{...e,chainId:e.networkID,appVersion:te,platform:re,deviceId:a});if(!ne(s))throw new Error("Failed to scan message");return s.data},St=async(r,a,e)=>{let n=`/simulation/v1?language=${r}`,s={...e.params,...e.params&&"safeguard"in e.params?{safeguard:{...e.params.safeguard,lighthouseProgramId:ve}}:{}},o=await H.api().post(n,{...e,chainId:e.networkID,params:s,metadata:e.metadata,appVersion:te,platform:re,deviceId:a});if(!ne(o))throw new Error("Failed to scan transaction");let d=o.data,f=je(e,d);if(f instanceof z){let i=We(d);q.captureMessage(`Verify error ${i??""}: ${f.message}`,"safeguard")}return d};var Lr=u.union([u.literal("signTransaction"),u.literal("signAllTransactions"),u.literal("signAndSendTransaction"),u.literal("signAndSendAllTransactions")]);b();A();var bt=(g=>(g.HasOnboarded="hasOnboarded",g.ResetHasOnboarded="resetHasOnboarded",g.LockExtension="lockExtension",g.UnlockExtension="unlockExtension",g.IsExtensionUnlocked="IsExtensionUnlocked",g.SetPassword="setPassword",g.VerifyPassword="verifyPassword",g.UpdatePassword="updatePassword",g.ImportPrivateKeyAccount="importPrivateKeyAccount",g.ImportReadOnlyAccount="importReadOnlyAccount",g.ImportSeedAccount="importSeedAccount",g.ImportSeedlessAccount="importSocialSeedAccount",g.IsExistingSeed="isExistingSeed",g.AddAccountForSeed="addAccountForSeed",g.AddAccountForSeedless="addAccountForSeedless",g.AddLedgerAccounts="addLedgerAccounts",g.DeriveAddresses="deriveAddresses",g.ExportPrivateKey="exportPrivateKey",g.ExportEntropy="exportEntropy",g.SetAccountIcon="setAccountIcon",g.RemoveAccount="removeAccount",g.ReorderAccount="reorderAccount",g.GetAllAccounts="getAllAccounts",g.GetAllSeeds="getAllSeeds",g.GetAllSeedless="getAllSeedlessSeeds",g.GetAuthenticationPublicKey="getAuthenticationPublicKey",g.Sign="sign",g.SyncAccounts="syncAccounts",g.CheckVaultIntegrity="checkVaultIntegrity",g.LogMessage="logMessage",g.DownloadLogs="downloadLogs",g.ProviderInjectionOptions="providerInjectionOptions",g.ServiceWorkerMutexAcquire="serviceWorkerMutexAcquire",g.ServiceWorkerMutexRelease="serviceWorkerMutexRelease",g))(bt||{});b();A();function Yr(r,a,e=be()){return{jsonrpc:"2.0",id:e,method:r,params:a}}export{pt as a,at as b,Wt as c,st as d,ot as e,Y as f,ht as g,yt as h,gt as i,vt as j,St as k,bt as l,Yr as m};
//# sourceMappingURL=chunk-HBMWL2L6.js.map
