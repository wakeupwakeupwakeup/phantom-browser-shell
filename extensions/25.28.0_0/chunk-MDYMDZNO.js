import{$ as wt,A as _n,Da as At,Ea as Ie,K as Vn,Ta as kt,U as He,_ as Ln,a as ze,eb as Kn,f as Dn,j as Pe,k as K,l as G,ma as ye,na as Fe,o as Mn,oa as ae,p as Nn,qa as Qn,za as Wn}from"./chunk-G3SJLT24.js";import{d as Gn,e as qn,f as $n}from"./chunk-RL5NICHE.js";import{Hb as Cn,J as Tn,K as bn,L as qe,M as wn,N as An,O as $e,Sb as Ce,Ta as kn,Ub as Pn,Vb as bt,Wa as vn,Xb as Fn,Yb as In,_b as Bn,lc as je,qc as On,sc as Un,tc as Rn,ub as Sn,yb as En,zb as xn}from"./chunk-FDJQKATD.js";import{Y as hn,a as mn,c as fn,j as gn}from"./chunk-OGTXJ4NL.js";import{Bc as X,Ec as W,Hb as Ke,O as rn,P as L,Se as se,T as q,Vd as Ge,W as Y,Zf as ge,ec as F,g as ko,gb as sn,lb as N,ne as So,oc as ie,qc as cn,rb as an,sb as We,tb as z,u as vo,uc as un,vc as ln,vf as ee,wb as fe,wc as dn,xc as pn,zc as $}from"./chunk-MP5PPKB7.js";import{u as nn}from"./chunk-LV3AOIIH.js";import{b as O,da as on,l as xe,y as P}from"./chunk-LT72WXA6.js";import{Da as yn,Q as Z,c as M,f as oe,l}from"./chunk-NRW4C74H.js";import{f as U,h as s,i as f,m as Buffer,n as a}from"./chunk-YJSZZTEX.js";s();a();var Eo=0;function b(e,t){let n=`atom${++Eo}`,r={toString(){return(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof e=="function"?r.read=e:(r.init=e,r.read=xo,r.write=Co),t&&(r.write=t),r}function xo(e){return e(this)}function Co(e,t,n){return t(this,typeof n=="function"?n(e(this)):n)}var jn=(e,t)=>e.unstable_is?e.unstable_is(t):t===e,St=e=>"init"in e,vt=e=>!!e.write,Ye=new WeakMap,Et=e=>{var t;return xt(e)&&!((t=Ye.get(e))!=null&&t[1])},Po=(e,t)=>{let n=Ye.get(e);if(n)n[1]=!0,n[0].forEach(r=>r(t));else if((import.meta.env?import.meta.env.MODE:void 0)!=="production")throw new Error("[Bug] cancelable promise not found")},Fo=e=>{if(Ye.has(e))return;let t=[new Set,!1];Ye.set(e,t);let n=()=>{t[1]=!0};e.then(n,n),e.onCancel=r=>{t[0].add(r)}},xt=e=>typeof e?.then=="function",zn=e=>"v"in e||"e"in e,Je=e=>{if("e"in e)throw e.e;if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!("v"in e))throw new Error("[Bug] atom state is not initialized");return e.v},Hn=(e,t,n)=>{n.p.has(e)||(n.p.add(e),t.then(()=>{n.p.delete(e)},()=>{n.p.delete(e)}))},Io=(e,t,n,r)=>{var o;if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&n===e)throw new Error("[Bug] atom cannot depend on itself");t.d.set(n,r.n),Et(t.v)&&Hn(e,t.v,r),(o=r.m)==null||o.t.add(e)},Bo=Symbol.for("JOTAI.EXPERIMENTAL.FLUSHSTOREHOOK"),Jn=(...e)=>{let[t,n,r,o,i,d]=e,c=w=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!w)throw new Error("Atom is undefined or null");let h=t(w);return h||(h={d:new Map,p:new Set,n:0},n(w,h),i?.(w,Qe)),h},p=new WeakMap,u=new Map,m=new Set,g=new Set,y=()=>{var w;let h=[],A=k=>{try{k()}catch(E){h.push(E)}};do{(w=Qe[Bo])==null||w.call(Qe);let k=new Set,E=k.add.bind(k);u.forEach(v=>{var C;return(C=v.m)==null?void 0:C.l.forEach(E)}),u.clear(),m.forEach(E),m.clear(),g.forEach(E),g.clear(),k.forEach(A),u.size&&ne()}while(u.size||m.size||g.size);if(h.length)throw h[0]},T=(w,h,A)=>{let k="v"in h,E=h.v,v=Et(h.v)?h.v:null;if(xt(A)){Fo(A);for(let C of h.d.keys())Hn(w,A,c(C));h.v=A}else h.v=A;delete h.e,(!k||!Object.is(E,h.v))&&(++h.n,v&&Po(v,A))},S=w=>{var h;let A=c(w);if(zn(A)&&(A.m&&p.get(w)!==A.n||Array.from(A.d).every(([I,re])=>S(I).n===re)))return A;A.d.clear();let k=!0,E=()=>{A.m&&(Se(w,A),ne(),y())},v=I=>{if(jn(w,I)){let Tt=c(I);if(!zn(Tt))if(St(I))T(I,Tt,I.init);else throw new Error("no atom init");return Je(Tt)}let re=S(I);try{return Je(re)}finally{Io(w,A,I,re),k||E()}},C,B,Q={get signal(){return C||(C=new AbortController),C.signal},get setSelf(){return(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!vt(w)&&console.warn("setSelf function cannot be used with read-only atom"),!B&&vt(w)&&(B=(...I)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&k&&console.warn("setSelf function cannot be called in sync"),!k)return yt(w,...I)}),B}};try{let I=r(w,v,Q);return T(w,A,I),xt(I)&&((h=I.onCancel)==null||h.call(I,()=>C?.abort()),I.then(E,E)),A}catch(I){return delete A.v,A.e=I,++A.n,A}finally{k=!1}},x=w=>Je(S(w)),D=w=>{var h;let A=new Map;for(let k of((h=w.m)==null?void 0:h.t)||[]){let E=c(k);E.m&&A.set(k,E)}for(let k of w.p)A.set(k,c(k));return A},J=w=>{let h=[w];for(;h.length;){let A=h.pop();for(let[k,E]of D(A))p.has(k)||(p.set(k,E.n),h.push(E))}},ne=()=>{var w;let h=[],A=new WeakSet,k=new WeakSet,E=Array.from(u);for(;E.length;){let[v,C]=E[E.length-1];if(k.has(v)){E.pop();continue}if(A.has(v)){p.get(v)===C.n?h.push([v,C,C.n]):(p.delete(v),u.set(v,C)),k.add(v),E.pop();continue}A.add(v);for(let[B,Q]of D(C))A.has(B)||E.push([B,Q])}for(let v=h.length-1;v>=0;--v){let[C,B,Q]=h[v],I=!1;for(let re of B.d.keys())if(re!==C&&u.has(re)){I=!0;break}I&&(S(C),Se(C,B),Q!==B.n&&(u.set(C,B),(w=B.u)==null||w.call(B))),p.delete(C)}},me=(w,...h)=>{let A=!0,k=v=>Je(S(v)),E=(v,...C)=>{var B;let Q=c(v);try{if(jn(w,v)){if(!St(v))throw new Error("atom not writable");let I=Q.n,re=C[0];T(v,Q,re),Se(v,Q),I!==Q.n&&(u.set(v,Q),(B=Q.u)==null||B.call(Q),J(Q));return}else return me(v,...C)}finally{A||(ne(),y())}};try{return o(w,k,E,...h)}finally{A=!1}},yt=(w,...h)=>{try{return me(w,...h)}finally{ne(),y()}},Se=(w,h)=>{var A;if(h.m&&!Et(h.v)){for(let[k,E]of h.d)if(!h.m.d.has(k)){let v=c(k);Ee(k,v).t.add(w),h.m.d.add(k),E!==v.n&&(u.set(k,v),(A=v.u)==null||A.call(v),J(v))}for(let k of h.m.d||[])if(!h.d.has(k)){h.m.d.delete(k);let E=ht(k,c(k));E?.t.delete(w)}}},Ee=(w,h)=>{var A;if(!h.m){S(w);for(let k of h.d.keys())Ee(k,c(k)).t.add(w);if(h.m={l:new Set,d:new Set(h.d.keys()),t:new Set},(A=h.h)==null||A.call(h),vt(w)){let k=h.m,E=()=>{let v=!0,C=(...B)=>{try{return me(w,...B)}finally{v||(ne(),y())}};try{let B=d(w,C);B&&(k.u=()=>{v=!0;try{B()}finally{v=!1}})}finally{v=!1}};g.add(E)}}return h.m},ht=(w,h)=>{var A;if(h.m&&!h.m.l.size&&!Array.from(h.m.t).some(k=>{var E;return(E=c(k).m)==null?void 0:E.d.has(w)})){let k=h.m.u;k&&m.add(k),delete h.m,(A=h.h)==null||A.call(h);for(let E of h.d.keys()){let v=ht(E,c(E));v?.t.delete(w)}return}return h.m},Qe={get:x,set:yt,sub:(w,h)=>{let A=c(w),E=Ee(w,A).l;return E.add(h),y(),()=>{E.delete(h),ht(w,A),y()}},unstable_derive:w=>Jn(...w(...e))};return Qe},Oo=e=>{let t=new Set,n,r=0,o=e.unstable_derive((...c)=>{let[p,u,,m]=c;return n=p,c[1]=function(y,T){u(y,T);let S=T.h;T.h=()=>{S?.(),T.m?t.add(y):t.delete(y)}},c[3]=function(y,T,S,...x){return r?S(y,...x):m(y,T,S,...x)},c}),i=o.set;return Object.assign(o,{dev4_get_internal_weak_map:()=>({get:c=>{let p=n(c);if(!(!p||p.n===0))return p}}),dev4_get_mounted_atoms:()=>t,dev4_restore_atoms:c=>{i({read:()=>null,write:(u,m)=>{++r;try{for(let[g,y]of c)St(g)&&m(g,y)}finally{--r}}})}})},Ct=()=>{let e=new WeakMap,t=Jn(n=>e.get(n),(n,r)=>e.set(n,r).get(n),(n,...r)=>n.read(...r),(n,...r)=>n.write(...r),(n,...r)=>{var o;return(o=n.unstable_onInit)==null?void 0:o.call(n,...r)},(n,...r)=>{var o;return(o=n.onMount)==null?void 0:o.call(n,...r)});return(import.meta.env?import.meta.env.MODE:void 0)!=="production"?Oo(t):t},Be,Yn=()=>(Be||(Be=Ct(),(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=Be),globalThis.__JOTAI_DEFAULT_STORE__!==Be&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),Be);s();a();var R=U(M(),1);var Xn=(0,R.createContext)(void 0),er=e=>{let t=(0,R.useContext)(Xn);return e?.store||t||Yn()},qs=({children:e,store:t})=>{let n=(0,R.useRef)(void 0);return!t&&!n.current&&(n.current=Ct()),(0,R.createElement)(Xn.Provider,{value:t||n.current},e)},Ft=e=>typeof e?.then=="function",tr=e=>{e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t})},Uo=R.default.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(tr(e),e)}),Pt=new WeakMap,Zn=e=>{let t=Pt.get(e);return t||(t=new Promise((n,r)=>{let o=e,i=p=>u=>{o===p&&n(u)},d=p=>u=>{o===p&&r(u)},c=p=>{"onCancel"in p&&typeof p.onCancel=="function"&&p.onCancel(u=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&u===p)throw new Error("[Bug] p is not updated even after cancelation");Ft(u)?(Pt.set(u,t),o=u,u.then(i(u),d(u)),c(u)):n(u)})};e.then(i(e),d(e)),c(e)}),Pt.set(e,t)),t};function V(e,t){let n=er(t),[[r,o,i],d]=(0,R.useReducer)(u=>{let m=n.get(e);return Object.is(u[0],m)&&u[1]===n&&u[2]===e?u:[m,n,e]},void 0,()=>[n.get(e),n,e]),c=r;(o!==n||i!==e)&&(d(),c=n.get(e));let p=t?.delay;if((0,R.useEffect)(()=>{let u=n.sub(e,()=>{if(typeof p=="number"){let m=n.get(e);Ft(m)&&tr(Zn(m)),setTimeout(d,p);return}d()});return d(),u},[n,e,p]),(0,R.useDebugValue)(c),Ft(c)){let u=Zn(c);return Uo(u)}return c}function Oe(e,t){let n=er(t);return(0,R.useCallback)((...o)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!("write"in e))throw new Error("not writable atom");return n.set(e,...o)},[n,e])}function $s(e,t){return[V(e,t),Oe(e,t)]}s();a();var Do=l.object({data:l.string(),from:l.string(),to:l.string()}),Mo=l.object({transaction:Do});async function No({caip19:e,amount:t,owner:n}){let r=await q.api().post("/tokens/v1/unwrap",{owner:n,caip19:e,amount:t.toNumber()}),o=Mo.safeParse(r.data);if(!o.success){let{error:i}=o;throw F.captureError(i,"fungibles"),new Pe(`Failed to get unwrap transaction: ${i.message}`)}return o.data.transaction}var _o=({caip19:e,amount:t,owner:n})=>W({gcTime:ze.Medium,staleTime:1/0,enabled:n!==""&&t.isGreaterThan(0),queryKey:K.unwrapTransaction({caip19:e,amount:t,owner:n}),async queryFn(){return await No({caip19:e,amount:t,owner:n})}});s();a();function Vo(){let e=cn(),t=Ge(),n=$();return X({async mutationFn({accountId:r,mutations:o}){await Nn(e,t,{accountId:r,mutations:o})},async onSuccess(r,o){await Promise.all([n.invalidateQueries({queryKey:K.hiddenMints(o.accountId)}),n.invalidateQueries({queryKey:G.visibilityOverrides({accountId:o.accountId})})])}})}s();a();var Rt=U(So());s();a();s();a();var _=[];for(let e=0;e<256;++e)_.push((e+256).toString(16).slice(1));function nr(e,t=0){return(_[e[t+0]]+_[e[t+1]]+_[e[t+2]]+_[e[t+3]]+"-"+_[e[t+4]]+_[e[t+5]]+"-"+_[e[t+6]]+_[e[t+7]]+"-"+_[e[t+8]]+_[e[t+9]]+"-"+_[e[t+10]]+_[e[t+11]]+_[e[t+12]]+_[e[t+13]]+_[e[t+14]]+_[e[t+15]]).toLowerCase()}s();a();var It,Lo=new Uint8Array(16);function Bt(){if(!It){if(typeof self.crypto>"u"||!self.crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");It=self.crypto.getRandomValues.bind(self.crypto)}return It(Lo)}s();a();s();a();var Qo=typeof self.crypto<"u"&&self.crypto.randomUUID&&self.crypto.randomUUID.bind(self.crypto),Ot={randomUUID:Qo};function Wo(e,t,n){if(Ot.randomUUID&&!t&&!e)return Ot.randomUUID();e=e||{};let r=e.random??e.rng?.()??Bt();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){if(n=n||0,n<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let o=0;o<16;++o)t[n+o]=r[o];return t}return nr(r)}var Ut=Wo;s();a();var Ze={recipient:"",recipientHandle:"",addressBookRecipient:void 0,amountAsset:new O(0),amountUsd:0,transactionSpeed:"standard",solana:{references:[]},multichainTransaction:void 0},rr=class extends Error{constructor(t){super(t),this.name="SendFungibleFlowError"}};var or={sendSessionId:"",encodedCaip19:void 0,fungibleKey:void 0,splTokenAccount:void 0,analyticsRecipient:void 0,sendFormValues:Ze,shouldShowFiatValues:!1,retryArgs:void 0,confirmedFungibleAndSender:null,gasEstimation:void 0},Dt=ge((e,t)=>({...(0,Rt.default)(or),resetSendSlice:()=>{let n=(0,Rt.default)(or);n.sendSessionId=Ut(),e(n)},setAnalyticsRecipient:n=>{e({analyticsRecipient:n})},setSendFungibleKey:(n,r,o)=>{e({fungibleKey:n,splTokenAccount:r,encodedCaip19:o})},setSendFormValues:n=>{e({sendFormValues:n})},setInputAmount:n=>{let r=t();e({sendFormValues:{...r.sendFormValues,inputAmount:n}})},setShouldShowFiatValues:n=>{e({shouldShowFiatValues:n})},setRetryArgs:n=>{e({retryArgs:n})},setGasEstimation:n=>{e({gasEstimation:n})}}));s();a();var ir={collectible:void 0,sendFormValues:Ze,shouldRequireAmount:!1},Ko=ge(e=>({...ir,resetSendSlice:()=>{e({...ir})},setSendCollectible:t=>{e({collectible:t})},setSendFormValues:t=>{e({sendFormValues:t})},setShouldRequireAmount:t=>{e({shouldRequireAmount:t})}}));s();a();s();a();var Go={query:""},qo=ge(e=>({...Go,setQuery:t=>{e({query:t})}}));s();a();s();a();s();a();var Xe=U(ko(),1),ar=U(vo(),1);var sr=(0,Xe.struct)([(0,Xe.u8)("instruction")]);function cr(e,t,n,r=[],o=Ce){let i=Bn([{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0}],n,r),d=Buffer.alloc(sr.span);return sr.encode({instruction:Fn.CloseAccount},d),new ar.TransactionInstruction({keys:i,programId:o,data:d})}var lr=U(M());var $o=()=>{let{connection:e}=He(),{data:t}=ee(),{solanaChainAddress:n,accountIdentifier:r}=(0,lr.useMemo)(()=>({solanaChainAddress:t?.addresses.find(fe),accountIdentifier:t?.identifier??""}),[t]),o=ie(),i=se(),{t:d}=Z();return X({mutationFn:async c=>{if(!n)throw new Error("solanaChainAddress not loaded");if(c.type!=="CompressedSPL")throw new Error("SPL is not compressed");let p=await On({owner:c.data.walletAddress,mint:c.data.mintAddress,amount:c.data.amount,programId:c.data.programId,connection:e}),{networkID:u,address:m}=n,g={ownerAddress:m,networkID:u,data:{signature:""},type:"decompress",display:{summary:{topLeft:{text:d("assetDetailClaiming")}}}};await je({accountIdentifier:r,accountSigner:i,connection:e,feePayer:new L.PublicKey(m),pendingTransactionInput:g,storage:o,transaction:p,useSubmissionService:!1})}})};s();a();var Ve=U(M());s();a();s();a();s();a();var Te=b(new ln);function Mt(){return Mt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Mt.apply(this,arguments)}f.NODE_ENV!=="production"&&(Te.debugPrivate=!0);var jo=(e,t,n)=>e?.suspense&&zo(t,n),zo=(e,t)=>e.isPending&&!t,Ho=({result:e,throwOnError:t,query:n})=>e.isError&&!e.isFetching&&Jo(t,[e.error,n]);function Jo(e,t){return typeof e=="function"?e(...t):!!e}var Yo=e=>e.suspense&&typeof e.staleTime!="number"?Mt({},e,{staleTime:1e3}):e;function dr(e,t,n=r=>r(Te)){let r=b(0),o=b(n);f.NODE_ENV!=="production"&&(o.debugPrivate=!0);let i=b(()=>new WeakMap);f.NODE_ENV!=="production"&&(i.debugPrivate=!0);let d=b(u=>{let m=u(o),g=e(u),y=m.defaultQueryOptions(g),T=u(i).get(m);return y._optimisticResults="optimistic",T&&T.setOptions(y,{listeners:!1}),Yo(y)});f.NODE_ENV!=="production"&&(d.debugPrivate=!0);let c=b(u=>{let m=u(o),g=u(d),y=u(i),T=y.get(m);if(T)return T;let S=new t(m,g);return y.set(m,S),S});f.NODE_ENV!=="production"&&(c.debugPrivate=!0);let p=b(u=>{let m=u(c),g=u(d),y=m.getOptimisticResult(g),T=b(y);return f.NODE_ENV!=="production"&&(T.debugPrivate=!0),T.onMount=S=>{let x=m.subscribe(un.batchCalls(S));return()=>{m.getCurrentResult().isError&&m.getCurrentQuery().reset(),x()}},T});return f.NODE_ENV!=="production"&&(p.debugPrivate=!0),b(u=>{u(r);let m=u(c),g=u(d),y=u(u(p));if(jo(g,y,!1))return m.fetchOptimistic(g);if(Ho({result:y,query:m.getCurrentQuery(),throwOnError:g.throwOnError}))throw y.error;return y},(u,m)=>{m(r,g=>g+1)})}function et(e,t=n=>n(Te)){return dr(e,dn,t)}function pr(e,t=n=>n(Te)){return dr(e,pn,t)}s();a();var Mc=Symbol((import.meta.env?import.meta.env.MODE:void 0)!=="production"?"RESET":"");var Nt=(e,t,n)=>(t.has(n)?t:t.set(n,e())).get(n),Zo=new WeakMap,Xo=(e,t,n,r)=>{let o=Nt(()=>new WeakMap,Zo,t),i=Nt(()=>new WeakMap,o,n);return Nt(e,i,r)};function j(e,t,n=Object.is){return Xo(()=>{let r=Symbol(),o=([d,c])=>{if(c===r)return t(d);let p=t(d,c);return n(c,p)?c:p},i=b(d=>{let c=d(i),p=d(e);return o([p,c])});return i.init=r,i},e,t,n)}var ei=e=>typeof e?.then=="function";function ti(e=()=>{try{return self.localStorage}catch(n){(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&typeof self<"u"&&console.warn(n);return}},t){var n;let r,o,i={getItem:(p,u)=>{var m,g;let y=S=>{if(S=S||"",r!==S){try{o=JSON.parse(S,t?.reviver)}catch{return u}r=S}return o},T=(g=(m=e())==null?void 0:m.getItem(p))!=null?g:null;return ei(T)?T.then(y):y(T)},setItem:(p,u)=>{var m;return(m=e())==null?void 0:m.setItem(p,JSON.stringify(u,t?.replacer))},removeItem:p=>{var u;return(u=e())==null?void 0:u.removeItem(p)}},d=p=>(u,m,g)=>p(u,y=>{let T;try{T=JSON.parse(y||"")}catch{T=g}m(T)}),c;try{c=(n=e())==null?void 0:n.subscribe}catch{}return!c&&typeof self<"u"&&typeof self.addEventListener=="function"&&self.Storage&&(c=(p,u)=>{if(!(e()instanceof self.Storage))return()=>{};let m=g=>{g.storageArea===e()&&g.key===p&&u(g.newValue)};return self.addEventListener("storage",m),()=>{self.removeEventListener("storage",m)}}),c&&(i.subscribe=d(c)),i}var Nc=ti();s();a();s();a();s();a();var ni=e=>Qn(e)?.[0],mr=ni;function ri({caip19:e,...t}){let n=We(e);return{...t,type:e.includes("/nativeToken:")?"native":"fungible",chainName:N.getChainName(n.chainId).toLowerCase(),encodedCaip19:e,decodedCaip19:n,legacyKey:mr(n)??e}}var be=ri;var oi=l.object({account:l.string(),quantity:l.number(),quantityString:l.string()}),Ue=l.object({address:l.string(),quantity:l.number(),quantityString:l.string(),lastTransferredDate:l.coerce.date().nullish(),subaccounts:l.array(oi).optional()}),we=l.object({price:l.number(),priceChange24h:l.number().optional(),lastUpdatedAt:l.coerce.date(),marketCap:l.number().optional()}).nullish(),_t=l.object({id:l.string(),name:l.string(),imageUri:l.string().nullish().transform(e=>e??""),numTokens:l.number()}),Re=l.object({compression:l.object({compressed:l.boolean()}).optional(),creators:l.array(l.object({address:l.string(),share:l.number(),verified:l.boolean()})).nullish(),tokenProgram:l.string().nullish(),extensions:l.array(l.unknown()).nullish()}),tt=l.enum(["TRUSTED","VERIFIED","NOT_VERIFIED","POSSIBLE_SPAM","SPAM"]),Xc=l.object({totalValueUsdCentsCurrent:l.number().optional(),totalValueUsdStringCurrent:l.string().optional(),totalValueUsdCents24h:l.number().optional(),totalValueUsdString24h:l.string().optional(),totalPercentChange24h:l.number().optional()}),fr=l.object({name:l.string().nullish(),symbol:l.string().nullish(),decimals:l.number(),logoUri:l.string().nullish(),extraMetadata:Re.optional(),price:we}),nt=fr.extend({type:l.enum(["native","fungible"]),encodedCaip19:l.string(),decodedCaip19:an,spamStatus:tt,chainName:l.string(),legacyKey:l.string()}),ii=fr.extend({caip19:l.string(),spamStatus:tt.nullish().transform(e=>e??"NOT_VERIFIED")}),gr=l.union([ii.transform(e=>be(e)),nt]),eu=nt.extend({extraMetadata:Re.extend({id:l.string().nullish().default(null),description:l.string().nullish().default(null),marketCap:l.coerce.number().optional(),circulatingSupply:l.coerce.number().optional(),totalSupply:l.coerce.number().optional(),liquidity:l.coerce.number().optional(),holders:l.coerce.number().optional(),links:l.array(l.object({type:l.string(),url:l.string()})).optional(),volume24hUSD:l.coerce.number().optional(),volume24hUSDChangePercentage:l.coerce.number().optional(),trades24h:l.coerce.number().optional(),trades24hChangePercentage:l.coerce.number().optional(),uniqueWallets24h:l.coerce.number().optional(),uniqueWallets24hChangePercentage:l.coerce.number().optional(),top10HoldersPercent:l.coerce.number().optional(),mintable:l.boolean().optional(),freezable:l.boolean().optional(),mutableMetadata:l.boolean().optional(),ownershipRenounced:l.boolean().optional(),updateAuthority:l.string().optional(),createdDate:l.string().datetime().nullish().default(null)}).optional(),categories:l.array(_t),createdDate:l.coerce.date().nullish().default(null)}),yr=nt.extend({totalQuantity:l.number(),totalQuantityString:l.string(),walletAddress:l.string().optional(),queriedWalletBalances:l.array(Ue),livePrice:we}),hr=nt.extend({timestamp:l.string().nullish(),totalQuantityString:l.string(),totalQuantity:l.number(),queriedWalletBalances:l.array(Ue)});s();a();s();a();s();a();function H(e){let t=b(0),n=b(()=>({i:0}),(p,u)=>{let m=p(n);return Object.assign(m,{m:!0,peek:p,set:u}),u(t,g=>g+1),()=>{m.m=!1,d(m),c(m)}});n.onMount=p=>p();let r=b(p=>{p(t);let u=p(n);if(!u.m||u.irc||u.i&&!u.irf)return u.p;c(u);let m=new Map,g=x=>{let D=p(x);return m.set(x,D),D};g.peek=u.peek;let y=(...x)=>{try{return++u.i,u.set(...x)}finally{Array.from(m.keys(),p),--u.i}};y.recurse=(x,...D)=>{if(u.fc){if(f.NODE_ENV!=="production")throw new Error("set.recurse is not allowed in cleanup");return}try{return u.irc=!0,u.set(x,...D)}finally{u.irc=!1,Array.from(m).some(T)&&i(u)}};function T([x,D]){return p(x)!==D}++u.i;function S(){try{if(u.irf=!1,!u.m)return;d(u),u.c=o.effect(g,y)}catch(x){u.e=x,i(u)}finally{u.p=void 0,--u.i}}return u.irf?S():u.p=Promise.resolve().then(S)});if(f.NODE_ENV!=="production"){let p=function(u,m){Object.defineProperty(u,"debugLabel",{get:()=>`${o.debugLabel??"effect"}:${m}`}),u.debugPrivate=!0};p(t,"refresh"),p(n,"ref"),p(r,"base")}let o=b(p=>void p(r));return o.effect=e,o;function i(p){try{p.irf=!0,p.set(t,u=>u+1)}finally{p.irf=!1}}function d(p){if(typeof p.c=="function")try{p.fc=!0,p.c()}finally{p.fc=!1,p.c=void 0}}function c(p){if("e"in p){let u=p.e;throw delete p.e,u}}}s();a();var si=()=>{try{return typeof chrome<"u"&&(chrome.runtime?.id!==void 0||typeof browser<"u")}catch(e){return console.error("Error checking for extension context:",e),!1}},Vt=class{browser;storage;constructor(t){if(!t||!t.storage||!t.storage.local)throw new Error("[ExtensionStorage] Invalid 'browser' object received.");this.browser=t,this.storage=this.browser.storage.local}async get(t){try{let r=(await this.storage.get(t))[t];return r==null||typeof r!="string"?null:JSON.parse(r)}catch(n){return console.error(`[ExtensionStorage.get] Error getting/parsing key (${t}):`,n),null}}async getAll(t){try{let n=await this.storage.get(t),r={};for(let o in n)if(Object.prototype.hasOwnProperty.call(n,o)){let i=n[o];if(i==null||typeof i!="string")r[o]=null;else try{r[o]=JSON.parse(i)}catch(d){console.error(`[ExtensionStorage.getAll] Error parsing key (${o}):`,d),r[o]=null}}return r}catch(n){let r=`[ExtensionStorage.getAll] Error getting keys (${t}): ${n}`;throw console.error(r),new Error(r)}}async remove(t){try{await this.storage.remove(t)}catch(n){let r=`[ExtensionStorage.remove] Error removing key(s) (${t}): ${n}`;throw console.error(r),new Error(r)}}async set(t,n){try{let r=JSON.stringify(n);await this.storage.set({[t]:r})}catch(r){let o=`[ExtensionStorage.set] Error setting/stringifying key (${t}): ${r}`;throw console.error(o),new Error(o)}}async setAll(t){try{let n={};for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=JSON.stringify(t[r]));await this.storage.set(n)}catch(n){let o=`[ExtensionStorage.setAll] Error setting/stringifying keys (${Object.keys(t)}): ${n}`;throw console.error(o),new Error(o)}}async update(t,n){if(!navigator.locks){let r=await this.get(t),o=await n(r);o===null?await this.remove(t):await this.set(t,o);return}try{await navigator.locks.request(`storage.${t}`,async r=>{let o=await this.get(t),i=await n(o);i===null?await this.remove(t):await this.set(t,i)})}catch(r){let o=`[ExtensionStorage.update] Error updating key (${t}): ${r}`;throw console.error(o),new Error(o)}}async clear(){try{await this.storage.clear()}catch(t){let n=`[ExtensionStorage.clear] Error clearing storage: ${t}`;throw console.error(n),new Error(n)}}},rt=class{storage=self.localStorage;async get(t){try{let n=this.storage.getItem(t);return n===null||typeof n!="string"?null:JSON.parse(n)}catch(n){return console.error(`[WebLocalStorage.get] Error getting/parsing key (${t}):`,n),null}}async getAll(t){let n={},r=t??Object.keys(this.storage);for(let o of r)try{let i=this.storage.getItem(o);if(t&&i===null)continue;if(i===null||typeof i!="string")n[o]=null;else try{n[o]=JSON.parse(i)}catch(d){console.error(`[WebLocalStorage.getAll] Error parsing key (${o}):`,d),n[o]=null}}catch(i){console.error(`[WebLocalStorage.getAll] Error reading key (${o}) from storage:`,i),t||(n[o]=null)}return n}async remove(t){try{let n=Array.isArray(t)?t:[t];for(let r of n)this.storage.removeItem(r)}catch(n){let r=`[WebLocalStorage.remove] Error removing key(s) (${t}): ${n}`;throw console.error(r),new Error(r)}}async set(t,n){try{let r=JSON.stringify(n);this.storage.setItem(t,r)}catch(r){let o=`[WebLocalStorage.set] Error setting/stringifying key (${t}): ${r}`;throw console.error(o),new Error(o)}}async setAll(t){let n=!1,r=Object.keys(t);for(let o in t)if(Object.prototype.hasOwnProperty.call(t,o))try{await this.set(o,t[o])}catch{n=!0}if(n)throw new Error(`[WebLocalStorage.setAll] One or more errors occurred while setting keys (${r})`)}async update(t,n){if(!navigator.locks){let r=await this.get(t),o=await n(r);o===null?await this.remove(t):await this.set(t,o);return}try{await navigator.locks.request(`storage.${t}`,async r=>{let o=await this.get(t),i=await n(o);i===null?await this.remove(t):await this.set(t,i)})}catch(r){let o=`[WebLocalStorage.update] Error updating key (${t}): ${r}`;throw console.error(o),new Error(o)}}async clear(){try{this.storage.clear()}catch(t){let n=`[WebLocalStorage.clear] Error clearing storage: ${t}`;throw console.error(n),new Error(n)}}},Lt=class{initPromise;storageImpl=null;constructor(){this.initPromise=this._initialize(),this.initPromise.catch(t=>{console.error("LocalStorage initialization failed:",t)})}async _initialize(){if(!this.storageImpl)if(si())try{let n=(await import("./browser-polyfill-QMB4KO7Y.js")).default;if(!n||!n.storage||!n.storage.local)throw new Error("webextension-polyfill loaded but missing storage.local API.");this.storageImpl=new Vt(n)}catch{this.storageImpl=new rt}else this.storageImpl=new rt}async ensureInitialized(){if(await this.initPromise,!this.storageImpl)throw new Error("LocalStorage is not initialized. Initialization may have failed.")}async get(t){return await this.ensureInitialized(),this.storageImpl.get(t)}async getAll(t){return await this.ensureInitialized(),this.storageImpl.getAll(t)}async remove(t){return await this.ensureInitialized(),this.storageImpl.remove(t)}async set(t,n){return await this.ensureInitialized(),this.storageImpl.set(t,n)}async setAll(t){return await this.ensureInitialized(),this.storageImpl.setAll(t)}async update(t,n){return await this.ensureInitialized(),this.storageImpl.update(t,n)}async clear(){return await this.ensureInitialized(),this.storageImpl.clear()}},Qt=new Lt;s();a();s();a();var De=class{namespaceKey;ttlMilliseconds;storage;onError;data={};isLoaded=!1;constructor(t){this.namespaceKey=t.namespaceKey,this.ttlMilliseconds=t.ttlMilliseconds,this.storage=t.storage,this.onError=t.onError,this._load().then(()=>{if(this._cleanupExpired())return this._save()}).catch(n=>{console.error("Failed to load data",n)})}async _load(){if(!this.isLoaded){try{let t=await this.storage.get(this.namespaceKey);t?(this.data=t,(typeof this.data!="object"||this.data===null)&&(this.onError?.(new Error("Stored data is not a valid object."),"load"),this.data={})):this.data={}}catch(t){this.onError?.(t instanceof Error?t:new Error("Failed to parse stored data"),"load"),this.data={}}this.isLoaded=!0}}async _save(){try{await this.storage.set(this.namespaceKey,this.data)}catch(t){this.onError?.(t instanceof Error?t:new Error("Failed to serialize data for storage"),"save")}}_cleanupExpired(){let t=Date.now(),n=!1;for(let r in this.data)Object.prototype.hasOwnProperty.call(this.data,r)&&this.data[r].expiresAt<=t&&(delete this.data[r],n=!0);return n}_updateExpiration(t){return this.data[t]?(this.data[t].expiresAt=Date.now()+this.ttlMilliseconds,!0):!1}async set(t,n){this.isLoaded||await this._load(),this._cleanupExpired(),this.data[t]={value:n,expiresAt:Date.now()+this.ttlMilliseconds},await this._save()}async get(t,n){this.isLoaded||await this._load();let r=this._cleanupExpired(),o=this.data[t];if(!o)return r&&await this._save(),null;let i=this._updateExpiration(t),d=n.safeParse(o.value);return d.success?((r||i)&&await this._save(),d.data):(this.onError?.(new oe(d.error.issues),`get (validation failed for key: ${t})`),delete this.data[t],await this._save(),null)}async remove(t){let n=this._cleanupExpired(),r=!1;Object.prototype.hasOwnProperty.call(this.data,t)&&(delete this.data[t],r=!0),(n||r)&&await this._save()}async clear(){this.data={},await this._save()}};var Tr=new Map;function ai({storage:e,namespaceKey:t,ttlMs:n}){let r=Tr.get(t);if(r)return r;if(!e)throw new Error("Storage is required");let o=new De({storage:e,namespaceKey:t,ttlMilliseconds:n,onError:(i,d)=>{console.error(`[PersistentStore Error - ${d}]:`,i.message),i instanceof oe&&console.error("Zod Issues:",i.issues)}});return Tr.set(t,o),o}var Wt=ai;function ci({atomToStoreOffline:e,namespaceKey:t,ttlMs:n,initialValue:r,schema:o,...i}){let d=b({status:"pending",value:r}),c=b(g=>{if("offlineKey"in i)return g(i.offlineKey);let y=g(e);if("offlineKey"in y&&typeof y.offlineKey=="string")return y.offlineKey;throw new Error("No key provided")}),p=H((g,y)=>{Wt({storage:Qt,namespaceKey:`.offline.${t}`,ttlMs:n}).get(g(c),o).then(T=>{T&&y(d,{status:"offline",value:T})}).catch(T=>{console.error(T)})}),u=H((g,y)=>{g(c),y(d,{status:"pending",value:r})}),m=H((g,y)=>{let T=g(e),S=g(c);T.status==="success"&&T.data&&T.data!==g(d).value&&(y(d,{status:"live",value:T.data}),Wt({storage:Qt,namespaceKey:`.offline.${t}`,ttlMs:n}).set(S,T.data).catch(x=>{F.addBreadcrumb("tokens","Error storing offline data","error",{namespaceKey:t,error:x.toString()})}))});return j(b(g=>{let y=g(e);g(u),g(p),g(m);let T=g(d);return y.data?{status:"live",value:y.data}:{status:"offline",value:T.value}}),g=>g.value)}var ot=ci;s();a();s();a();var Kt=l.object({caip19:l.string(),name:l.string().nullish(),symbol:l.string().nullish(),decimals:l.number(),spamStatus:tt.nullish().transform(e=>e??"NOT_VERIFIED"),logoUri:l.string().nullish()}),br=Kt.extend({totalQuantity:l.number(),totalQuantityString:l.string(),queriedWalletBalances:l.array(Ue),extraMetadata:Re.optional(),price:we}),wr=br.transform(be),Ar=l.object({items:l.array(br),cursor:l.string().nullish().default(null)}).transform(e=>{let{items:t,cursor:n,...r}=e;return{...r,nextCursor:n,tokens:t,updatedAt:Date.now()}}),kr=Kt.extend({timestamp:l.string().nullish(),postQuantityString:l.string(),postQuantity:l.number(),price:we,queriedWalletBalances:l.array(Ue)}),vr=kr.transform(e=>{let{postQuantity:t,postQuantityString:n,...r}=be(e);return{...r,totalQuantity:t,totalQuantityString:n}}),Sr=l.object({cursor:l.string().nullish().default(null),items:l.array(kr)}).transform(e=>({nextCursor:e.cursor,transfers:e.items})),Mu=l.object({totalValueUsdCentsCurrent:l.number(),totalValueUsdStringCurrent:l.string(),totalValueUsdCents24h:l.number(),totalValueUsdString24h:l.string(),totalPercentChange24h:l.number()}),Gt=Kt.extend({createdDate:l.coerce.date().nullish().default(null),extraMetadata:Re.extend({id:l.string().nullish().default(null),description:l.string().nullish().default(null),marketCap:l.coerce.number().optional(),circulatingSupply:l.coerce.number().optional(),totalSupply:l.coerce.number().optional(),liquidity:l.coerce.number().optional(),holders:l.coerce.number().optional(),links:l.array(l.object({type:l.string(),url:l.string()})).optional(),volume24hUSD:l.coerce.number().optional(),volume24hUSDChangePercentage:l.coerce.number().optional(),trades24h:l.coerce.number().optional(),trades24hChangePercentage:l.coerce.number().optional(),uniqueWallets24h:l.coerce.number().optional(),uniqueWallets24hChangePercentage:l.coerce.number().optional(),top10HoldersPercent:l.coerce.number().optional(),mintable:l.boolean().optional(),freezable:l.boolean().optional(),mutableMetadata:l.boolean().optional(),ownershipRenounced:l.boolean().optional(),updateAuthority:l.string().optional(),createdDate:l.string().datetime().nullish().default(null)}).optional(),categories:l.array(_t).optional().default([]),price:we}),Er=Gt.transform(be);s();a();var ui=e=>N.isBitcoinNetworkID(e.decodedCaip19.chainId)&&e.decodedCaip19.resourceType==="nativeToken"?e.queriedWalletBalances.map(r=>{let o=Ke(e.decodedCaip19.chainId,r.address),i=ye.get(e.decodedCaip19.chainId).nativeTokenFungibleBalanceKey(e.decodedCaip19.chainId,o);if(!i)throw new Error("No legacy key found for bitcoin native token");return{...e,legacyKey:i,queriedWalletBalances:[r],totalQuantity:r.quantity,totalQuantityString:r.quantityString,walletAddress:r.address}}):[e],li=e=>t=>t.map(n=>e.parse(n)),Gu=li(gr),di=e=>t=>t.flatMap(n=>{let r=e.parse(n);return ui(r)}),xr=di(wr),pi=e=>t=>t.map(n=>e.parse(n)),Cr=pi(vr);async function mi(e){let t={walletAddresses:e.walletCaip19s.join(","),includePrices:"true"};"cursor"in e&&(t.cursor=e.cursor),"fromMicroseconds"in e?t.fromTimestamp=e.fromMicroseconds.toString():"from"in e&&(t.fromTimestamp=e.from.toString());let n=await q.api().timeout(P({seconds:30})).get("/portfolio/v1/fungibles/updates",{params:t}).then(r=>{if(Y(r))return r.data;throw new Error(r.data?.message||r.data?.error||r.statusText||`Status: ${r.status}`,{cause:r.data?.code??r.data?.name})}).catch(r=>{throw F.addBreadcrumb("tokens","getTokenBalanceUpdates","error",{message:r.message,cause:r.cause,...t}),F.captureError(r,"tokens"),r});try{return Sr.parse(n)}catch(r){throw r instanceof oe&&F.addBreadcrumb("tokens","getTokenBalanceUpdates parse error","error",{message:r.message,...r.issues?{issues:JSON.stringify(r.issues)}:{},result:JSON.stringify(n)}),r}}async function Pr(e){let t=[],n=()=>t.at(-1)?.nextCursor;do{let r=n(),o=await mi(r?{walletCaip19s:e.walletCaip19s,cursor:r}:e);t.push(o)}while(n());return Cr(t.flatMap(r=>r.transfers))}s();a();s();a();function fi(e){let t=Fe(e.decodedCaip19);return t==="SPL"?e.extraMetadata?.compression?.compressed||"queriedWalletBalances"in e&&e.queriedWalletBalances.some(n=>!n.subaccounts?.length)?"CompressedSPL":"SPL":t}var Fr=fi;function qt({newUpdates:e,existingUpdates:t={}}){return e.reduce((n,r)=>n[r.encodedCaip19]?.totalQuantityString===r.totalQuantityString?n:Fr(r)==="CompressedSPL"?{...n,[`${r.encodedCaip19}-compressed`]:r}:r?{...n,[r.encodedCaip19]:r}:n,t)}s();a();function gi(e){let t=e.match(/(.*\d{2}:\d{2}:\d{2})\.(?<fraction>\d+)Z/);if(!t||!t.groups?.fraction)throw new Error("Invalid date format");let n=new Date(e).getTime(),i=t.groups.fraction.padEnd(6,"0").slice(-3);return n*1e3+parseInt(i,10)}var $t=gi;s();a();var yi=b(!1),Ir=yi;s();a();s();a();s();a();var hi=P({minutes:5}),Ne=0;function El(){if(!Ne){Ne=Math.floor(Math.random()*1e6);return}Ne++}async function jt({walletCaip19s:e,fungibleCaip19s:t,cursor:n,cacheBust:r}){let o={walletAddresses:e.join(","),includePrices:"true"};n&&(o.cursor=n),(r||Ne)&&(o.cacheBust=r?.toString()||Ne.toString()),t&&t.length>0&&(o.fungibleAddresses=t.sort().join(","));try{let i=await q.api().timeout(P({seconds:30})).get("/portfolio/v1/fungibles/balances",{params:o}).then(c=>{if(Y(c))return c.data;throw new Error(c.data?.message||c.data?.error||c.statusText||`Status: ${c.status}`,{cause:c.data?.code})}),d=Ar.parse(i);return{...d,tokens:xr(d.tokens)}}catch(i){throw i instanceof Error&&(F.addBreadcrumb("tokens","getTokenBalances","error",{...o,message:i.message,...typeof i.cause=="string"||typeof i.cause=="number"?{cause:i.cause}:{}}),F.captureError(i,"tokens")),i}}function Br({walletCaip19s:e,isEnabled:t=!0,cacheBust:n}){return{staleTime:hi,gcTime:P({days:3}),queryKey:G.infiniteTokenBalances({walletCaip19s:e}),enabled:t&&!!e.length,queryFn:async({pageParam:r})=>jt({walletCaip19s:e,cursor:r,cacheBust:n}),initialPageParam:"",getNextPageParam:r=>r?.nextCursor||void 0}}function Or(e){let{walletCaip19s:t,encodedCaip19:n,queryOptions:r={enabled:!0}}=e;return{staleTime:P({seconds:10}),gcTime:P({days:3}),queryKey:G.tokenBalance({wallets:t,encodedCaip19:n}),enabled:r.enabled&&!!t.length,queryFn:async()=>(await jt({walletCaip19s:t,fungibleCaip19s:[n]})).tokens}}s();a();s();a();var Ti=b(null),st=Ti;var bi=b(e=>{let t=e(st);return t?t.addresses.map(n=>z({chainId:n.networkID,address:n.address,resourceType:"address"})).sort():[]}),Ae=bi;var wi=pr(e=>{let t=e(Ae);return Br({walletCaip19s:t})}),te=wi;var Ai=b(e=>{let{data:t}=e(te),n=t?.pages[0];return!n||!n.tokens.length?0:n.updatedAt}),Ur=Ai;s();a();var ki=j(st,e=>e?.identifier),ue=ki;var vi=1e3,Rr=5e3,Dr=Math.ceil(Rr*2.25);function Mr(e){return P(e)*1e3}function Si(e){if(!e?.length)return null;let t=new Date(Date.now()-Dr).toISOString();return Math.floor(Math.max(...e.map(({timestamp:n})=>$t(n||t))))}function Ei(e){let t=Si(e);return t?t-Mr({seconds:1}):null}var xi=et(e=>{let t=e(Te),n=e(Ur),r=Math.floor(n-P({minutes:10})),o=e(Ae),i=e(Ir),d=r>Date.now()-P({days:10}),c=G.tokenUpdates({walletCaip19s:o,from:r}),p=async()=>{let u=t.getQueryData(c)?.lastTimestamp;if(!u){let T=new Date(r-Dr).toISOString();return{updates:{},lastTimestamp:$t(T)}}let m=await Pr({walletCaip19s:o,fromMicroseconds:u-Mr({seconds:30})}),g=t.getQueryData(c)?.updates??{};return{updates:qt({newUpdates:m,existingUpdates:g}),lastTimestamp:Math.max(Ei(m)??0,u)}};return{meta:{fetchCount:0},enabled:d&&!i&&o.length>0,queryKey:c,refetchInterval:u=>{let m=Number(u.meta?.fetchCount??0);return u.meta&&(u.meta.fetchCount=m+1),Math.min(Math.max(m*250,vi),Rr)},queryFn:p}}),Ci=ot({atomToStoreOffline:xi,offlineKey:b(e=>`${e(ue)??""}:token-balance-updates`),namespaceKey:"fungible-tokens",ttlMs:P({days:10}),initialValue:{updates:{},lastTimestamp:0},schema:l.object({updates:l.record(l.string(),hr),lastTimestamp:l.number()})}),Pi=j(Ci,e=>e?.updates??{},(e,t)=>JSON.stringify(e)===JSON.stringify(t)),at=Pi;s();a();s();a();function ct(e){return t=>{let n=!1,r={...t};for(let[o,i]of Object.entries(e)){let d=i?.price,c=i?.lastUpdatedAt?new Date(i.lastUpdatedAt):null;if(!d||!c)continue;let p=t[o]?.price!==d&&(!t[o]?.lastUpdatedAt||c>t[o].lastUpdatedAt);n=n||p,p&&(r[o]={price:i.price,priceChange24h:i.priceChange24h,lastUpdatedAt:c})}return n?r:t}}s();a();var Fi=b(e=>{let{data:t,status:n}=e(te);return{data:t?.pages.flatMap(r=>r.tokens),status:n}}),Ii=ot({atomToStoreOffline:Fi,offlineKey:b(e=>`${e(ue)??""}:infinite-tokens`),namespaceKey:"fungible-tokens",ttlMs:P({days:10}),initialValue:[],schema:l.array(yr)}),le=Ii;var ut=b({}),Bi=b(e=>e(le).slice(-100).reduce((r,o)=>(o.price&&(r[o.encodedCaip19]=o.price),r),{})),Oi=H((e,t)=>{let n=e(Bi);!n||Object.keys(n).length===0||t(ut,ct(n))}),Ui=b(e=>{let t=e(at);return Object.values(t).reduce((r,o)=>(o.price&&(r[o.encodedCaip19]=o.price),r),{})}),Ri=H((e,t)=>{let n=e(Ui);!n||Object.keys(n).length===0||t(ut,ct(n))}),Di=b(e=>(e(Oi),e(Ri),e(ut)),(e,t,n)=>{t(ut,n)}),de=Di;s();a();s();a();var Mi=j(te,e=>e.hasNextPage),ke=Mi;var _e=b(1/0),lt=b(e=>(e(Ni),e(_i),e(ke)?e(_e):0),(e,t,n)=>{if(n===null){t(_e,1/0);return}let r=Math.min(e(_e),n);r!==e(_e)&&t(_e,r)}),Nr=lt,Ni=H((e,t)=>{let{hasNextPage:n}=e(te),r=e(le),o=e(de);if(r.length>0&&!n){t(lt,0);return}let i=r.slice(-100).filter(d=>d.type==="fungible").map(d=>{let c=o[d.encodedCaip19]??d.price;return c?d.totalQuantity*c.price/10**d.decimals:1/0});t(lt,Math.min(...i))}),_i=H((e,t)=>{e(ue)&&t(lt,1/0)});function Vi(e,t){if(e.type==="native"&&t.type!=="native")return-1;if(e.type!=="native"&&t.type==="native")return 1;if(e.type==="native"&&t.type==="native")return e.name&&t.name?e.name.localeCompare(t.name):0}function Li(e,t){if(!e&&t)return 1;if(e&&!t)return-1}function _r(e,t){if(e&&t)return e.localeCompare(t);if(e&&!t)return-1;if(!e&&t)return 1}function Vr(e,t){if(e!==t)return t-e}function Qi(e){return{totalQuantity:e.totalQuantity,totalQuantityString:e.totalQuantityString}}var Wi=b(e=>{let t=e(le),n=e(at),r=new Set(Object.keys(n));if(t.length===0)return[];let o=t.map(i=>{let d=i.extraMetadata?.compression?.compressed?`${i.encodedCaip19}-compressed`:i.encodedCaip19,c=n[d];return c?(r.delete(d),{...i,...Qi(c)}):i});return r.forEach(i=>{let d=n[i];d&&o.push(d)}),o}),Ki=b(e=>{let t=e(de),n=e(Wi),r=e(Nr),o=n.filter(i=>i.totalQuantity>0||i.type==="native").map(i=>({...i,livePrice:t[i.encodedCaip19]??i.price})).sort((i,d)=>{let c=i.livePrice?.price,p=d.livePrice?.price,u=Li(c,p);if(u)return u;let m=i.totalQuantity/10**i.decimals,g=d.totalQuantity/10**d.decimals;if(!c&&!p){let x=Vi(i,d);if(x)return x;let D=Vr(m,g);if(D)return D;let J=_r(i.name,d.name);return J||0}let y=(c??0)*m,T=(p??0)*g,S=Vr(y,T);return S||(_r(i.name,d.name)??0)});return r?o.filter(i=>{let d=i.livePrice?.price,c=i.totalQuantity/10**i.decimals;return(d??0)*c>=r}):o}),pe=Ki;s();a();function Gi(e){if(e)return typeof e=="string"||typeof e=="number"?new Date(e):e}function qi(e,{key:t,newPriceData:n}){let r=e[t];if(!n||r?.price===n?.price)return e;let o=Gi(n.lastUpdatedAt);return!o||!(!r?.lastUpdatedAt||o>r.lastUpdatedAt)?e:{...e,[t]:{price:n.price,priceChange24h:n.priceChange24h??n.usd_24h_change,lastUpdatedAt:o}}}var dt=qi;var $i=(e,t,n)=>{let r=e.extraMetadata?.compression?.compressed,o=t.extraMetadata?.compression?.compressed;if(r!==o)return n?r?-1:1:r?1:-1},ji=(e,t,n)=>{let r=e.legacyKey===n,o=t.legacyKey===n;if(r!==o)return r?-1:1},zi=({isSplCompressed:e,legacyKey:t},n)=>n.length?n.length===1?n[0]:[...n].sort((o,i)=>{if(e!==void 0&&(o.encodedCaip19.includes("solana:")||i.encodedCaip19.includes("solana:"))){let d=$i(o,i,e);if(d)return d}if(t){let d=ji(o,i,t);if(d)return d}return i.totalQuantity-o.totalQuantity})[0]:null,pt=e=>{let t=V(Ae),n=V(pe),r=(0,Ve.useMemo)(()=>n.filter(c=>c.encodedCaip19===e.encodedCaip19&&(!e.legacyKey||c.legacyKey===e.legacyKey)),[e.encodedCaip19,e.legacyKey]),o=Or({...e,walletCaip19s:t});o.refetchInterval||(o.refetchInterval=P({seconds:3}));let i=W({...o,select:c=>zi(e,c),placeholderData:r}),d=Oe(de);return(0,Ve.useEffect)(()=>{let c=i.data;c&&!i.isPlaceholderData&&c.price&&d(p=>{let u=c.encodedCaip19,m=c.price;return dt(p,{key:u,newPriceData:m})})},[i.data,i.isPlaceholderData,d]),i},mt=({networkID:e,queryOptions:t,addressType:n})=>{let r={chainId:e,slip44:N.getSlip44(e),resourceType:"nativeToken"},o=ye.get(e).nativeTokenFungibleBalanceKey(e,n)??null,i=z(r);return pt({encodedCaip19:i,legacyKey:o,queryOptions:t})},Hi=()=>{let{data:e}=ee(),t=(0,Ve.useMemo)(()=>e?.addresses.find(n=>N.isSolanaNetworkID(n.networkID)),[e]);return mt({networkID:t?.networkID||"solana:101",addressType:t?.addressType})};s();a();s();a();s();a();s();a();function zt(e,t){return{gcTime:ze.Long,staleTime:1/0,enabled:!!t&&!!e,queryKey:G.visibilityOverrides({accountId:t??""}),async queryFn(){return!t||!e?new Map:await Mn(e,t)}}}s();a();var Ji=b(null),Lr=Ji;var Yi=new Map,Qr=et(e=>{let t=e(Lr),n=e(ue);return zt(t,n)}),Wr=j(Qr,e=>e.status),Zi=b(e=>e(Qr).data??Yi),ve=Zi;var Xi=b(e=>{let{isLoading:t}=e(te),n=e(le),r=e(Wr);return t&&n.length===0||r==="pending"}),ft=j(Xi,e=>e);function Kr(){let e=V(pe),t=V(ft),n=V(ke),r=V(ve);return{isLoading:t,hasNextPage:n,fungibleTokens:e,visibilityOverrides:r}}s();a();s();a();var Gr=U(M());var es=({wallets:e,encodedCaip19:t,isSplCompressed:n=!1})=>{let r=$();return(0,Gr.useCallback)(()=>void r.invalidateQueries({queryKey:G.tokenBalance({wallets:e,encodedCaip19:t,isSplCompressed:n})}),[r,e,t,n])},ts=es;s();a();function qr({tokens:e}){return Dn({tokens:e}).catch(t=>{throw F.addBreadcrumb("tokens","getTokenPrices","error",{message:t.message,cause:t.cause,tokens:e.map(z).join(",")}),F.captureError(t,"tokens"),t})}s();a();s();a();var ns=b(e=>{let t=e(ve);return e(pe).filter(r=>_n(t??new Map,{key:r.legacyKey??"",spamStatus:r.spamStatus}))}),$r=ns;function jr(){let e=V($r),t=V(ft),n=V(ke),r=V(ve);return{isLoading:t,hasNextPage:n,fungibleTokens:e,visibilityOverrides:r}}s();a();var Le=U(M());s();a();s();a();function rs(e){let t={message:"Failed to parse token details response"};if(e instanceof oe)try{t.zodIssuesJson=JSON.stringify(e.issues.map(n=>({path:n.path.join("."),message:n.message,code:n.code})))}catch{t.zodIssuesJson="Failed to stringify Zod issues"}else t.errorMessage=e instanceof Error?e.message:String(e);return t}var zr=rs;function Hr(e){return e.resourceType==="nativeToken"?`/fungibles/v1/${e.chainId}/${e.resourceType}/${e.slip44}`:`/fungibles/v1/${e.chainId}/${e.resourceType}/${e.address}`}function os(e){return Hr(We(e))}function is(e){let t=new URLSearchParams,n="encodedCaip19"in e?os(e.encodedCaip19):Hr(e.decodedCaip19);return e.includePrice&&t.append("includePrice","true"),e.includeFungibleDetails&&t.append("includeFungibleDetails","true"),[n,{params:t}]}async function Ht(e){let t=await q.api().timeout(P({seconds:10})).get(...is(e)).then(n=>{if(Y(n))return n.data;throw new Error(n.data?.message||n.data?.error||n.statusText||`Status: ${n.status}`,{cause:n.data?.code})}).catch(n=>{throw F.addBreadcrumb("tokens","getTokenDetails","error",{message:n.message,cause:n.cause,..."encodedCaip19"in e&&{caip19:e.encodedCaip19},..."decodedCaip19"in e&&{caip19:z(e.decodedCaip19)}}),F.captureError(n,"tokens"),n});try{return Gt.parse(t)}catch(n){console.error(n);let r=zr(n);throw"encodedCaip19"in e&&typeof e.encodedCaip19=="string"?r.caip19=e.encodedCaip19:"decodedCaip19"in e&&(r.caip19=z(e.decodedCaip19)),F.addBreadcrumb("tokens","getTokenDetails.ParseError","error",r),n}}function ss({caip19:e,includePrice:t}){let n=(0,Le.useMemo)(()=>typeof e=="string"?e:z(e),[e]),r=V(pe),o=(0,Le.useMemo)(()=>{let c=r.find(p=>p.encodedCaip19===n);return c?{chainName:c.chainName,encodedCaip19:n,decodedCaip19:c.decodedCaip19,type:c.type,categories:[],price:c.price,symbol:c.symbol??"",name:c.name??"",decimals:c.decimals,legacyKey:c.legacyKey??n,spamStatus:c.spamStatus??"NOT_VERIFIED",logoUri:c.logoUri??null,extraMetadata:{description:"",id:"",isMutable:!0,createdDate:null,...c.extraMetadata},createdDate:null}:null},[n,t]),i=W({refetchInterval:P({seconds:t?5:30}),queryKey:G.tokenDetails({caip19:n,includePrice:t}),queryFn:async()=>{let c=await Ht(typeof e=="string"?{encodedCaip19:e,includeFungibleDetails:!0,includePrice:t}:{decodedCaip19:e,includeFungibleDetails:!0,includePrice:t});return Er.parse(c)},...o&&{placeholderData:o}}),d=Oe(de);return(0,Le.useEffect)(()=>{let c=i.data;c&&!i.isPlaceholderData&&t&&c.price&&d(p=>{let u=c.encodedCaip19,m=c.price;return dt(p,{key:u,newPriceData:m})})},[i.data,i.isPlaceholderData,d,t]),i}var Jt=ss;s();a();var Xt=U(M());s();a();var Yt=new O(0),Zt=({chainAddress:e,type:t,balance:n,decimals:r,recipient:o,gasEstimation:i,clampToZero:d=!0})=>{let{data:c,isPending:p}=wt(e);if(!t||!n)return Yt;let u=new O(n).multipliedBy(on(r));if(!ae(t))return u;if(!i)return;let m=new O(0);if(qe(i))m=u.minus(new O(i.value));else if(An(i)){let{gasLimit:g,maxFeePerGas:y,l1Fee:T=new O(0)}=i,S=g.times(y).plus(T);m=u.minus(S)}else if($e(i)){if(!e||p)return;let g=e.addressType,y=c?.safeToSendUtxos??[],T=bn(i.btcPerKilobyte),S=o&&sn.safeParse(o).success?o:"bc1p",D=[{value:y.reduce((ne,me)=>ne.plus(new O(me.value)),new O(0)).toNumber(),address:S}],J=Sn(g,y,D,T.toNumber(),[]);if(J.type==="error")m=new O(J.maxAmount).integerValue(O.ROUND_DOWN);else{let{inputs:ne,fee:me}=J;m=ne.reduce((Se,Ee)=>Se.plus(new O(Ee.value)),new O(0)).minus(me).integerValue(O.ROUND_DOWN)}}else if(wn(i))m=u.minus(i.gasBudget);else return xe(i);return m.isGreaterThan(Yt)?m:d?Yt:m};var as=({networkID:e,addressType:t,gasEstimation:n,transactionValue:r=new O(0),recipient:o})=>{let{data:i,isLoading:d,isError:c}=mt({networkID:e,addressType:t}),p=ye.get(e).nativeFungibleTokenType,u="unknown",m="",g=(0,Xt.useMemo)(()=>{let T=i?.queriedWalletBalances[0]?.address;if(!T)return;let S=Ke(e,T);return{networkID:e,address:T,addressType:S}},[i?.queriedWalletBalances,e]),y=Zt({chainAddress:g,type:p,balance:i?.totalQuantityString?new O(i?.totalQuantityString):void 0,decimals:i?.decimals??0,recipient:o,gasEstimation:n,clampToZero:!1});return!c&&i&&y&&(y.gte(r)?u="sufficient":u="insufficient",m=i?.symbol||""),(0,Xt.useMemo)(()=>({hasSufficientFunds:u,nativeTokenSymbol:m,isLoading:d,isError:c}),[u,m,d,c])};s();a();var Xr=U(M());s();a();var en=U(M());s();a();var Jr=({chainAddresses:e=[]})=>{let t=K.tokensErrorCount(e);return W({queryKey:t,initialData:0})};s();a();var cs=({errors:e})=>e;function Yr({chainAddresses:e,queryOptions:t}){return Wn({select:cs,chainAddresses:e,queryOptions:t})}var Zr=3,us=1,tn=({networkID:e,chainAddresses:t=[]})=>{let{data:n=[]}=Yr({chainAddresses:t}),{data:r=0}=Jr({chainAddresses:t}),o=r>=Zr,{data:i=0}=Vn(),d=i>=Zr,c=n.length===us&&n.some(m=>m.code==="TokensTrimmed"),{t:p}=Z(),u=(0,en.useMemo)(()=>{if(o)return p("partialErrorGeneric");let m=n.filter(y=>e?y.details.chainId===e:!0),g=m.length+(d?1:0);return g?g>1?p("partialErrorGeneric"):d?p("partialErrorTokenPrices"):c?p("partialErrorTokensTrimmed"):e?p("partialErrorTokenDetail"):p("partialErrorBalanceChainName",{chainName:N.getChainName(m[0].details.chainId)}):""},[o,n,d,e,c,p]);return(0,en.useMemo)(()=>({partialErrorMessage:u,shouldShowPartialError:u!==""}),[u])};function ls(e){let{onTappingBuy:t,onTappingReceive:n,onTappingSend:r,onTappingSwap:o,account:i}=e,{shouldShowPartialError:d,partialErrorMessage:c}=tn({chainAddresses:i?.addresses});return{ctaActions:ds({onTappingBuy:t,onTappingReceive:n,onTappingSend:r,onTappingSwap:o}),shouldShowPartialError:d,partialErrorMessage:c}}function ds(e){let{t}=Z();return(0,Xr.useMemo)(()=>{let r=[];return r.push({text:t("commandSend"),type:"send",onClick:e.onTappingSend}),r.push({text:t("commandSwap"),type:"swap",onClick:e.onTappingSwap}),r.push({text:t("commandReceive"),type:"receive",onClick:e.onTappingReceive}),r.push({text:t("commandBuy"),type:"buy",onClick:e.onTappingBuy}),r.sort((o,i)=>(kt.get(o.type)??100)-(kt.get(i.type)??100)),{primary:r,more:[]}},[t,e.onTappingSend,e.onTappingSwap,e.onTappingReceive,e.onTappingBuy])}s();a();var eo=U(M());var ps=({networkID:e,unsignedTransaction:t,pendingActivityRows:n,accountIdentifier:r,accountSigner:o,storage:i,includeCallPayload:d})=>({accountSigner:o,accountIdentifier:r,networkID:e,unsignedTransaction:t,...d&&{callPayload:{from:t.from,to:t.to,data:t.data,value:t.value}},pendingTransactionInput:{ownerAddress:t.from,networkID:e,data:{nonce:"",unsignedTransaction:t,hash:""},type:"swap",display:{summary:n}},storage:i}),ms=async({t:e,fungible:t,unsignedUnwrapTx:n,gasEstimation:r,storage:o,accountMetadata:i,accountSigner:d})=>{if(!n)throw new Error("Unsigned unwrap transaction is required");if(!r)throw new Error("Gas estimation is required");let{chain:c,balance:p}=t.data;if(!N.isEthereumNetworkID(c.id))throw new Error(`Chain is not supported: ${c.id}`);let u=c.id,m={topRight:{text:`+${p} ${c.symbol}`},topLeft:{text:e("transactionsPendingSwapping")},bottomRight:{text:`-${p} ${t.data.symbol}`},bottomLeft:{text:`${t.data.name}`}},g=nn.parse({type:"0x2",chainId:N.getEVMNetworkIDValue(u),gas:`0x${r.gasLimit.toString(16)}`,maxFeePerGas:`0x${r.maxFeePerGas.toString(16)}`,maxPriorityFeePerGas:`0x${r.maxPriorityFeePerGas.toString(16)}`,...n}),y=ps({storage:o,accountSigner:d,pendingActivityRows:m,includeCallPayload:!1,networkID:u,unsignedTransaction:g,accountIdentifier:i.accountIdentifier});return Cn(y)},fs=()=>{let{data:e}=ee();return(0,eo.useMemo)(()=>{let n=e?.type,r=e?.name??"",o=e?.identifier??"";return{accountName:r,accountType:n,accountIdentifier:o}},[e])},gs=e=>{let t=ie(),n=$(),{t:r}=Z(),o=fs(),i=se();return X({async mutationFn({fungible:d,unsignedUnwrapTx:c,gasEstimation:p}){return await ms({t:r,fungible:d,unsignedUnwrapTx:c,gasEstimation:p,accountMetadata:o,storage:t,accountSigner:i})},async onSuccess(){await n.invalidateQueries({queryKey:K.tokens(e)})}})};s();a();s();a();s();a();var to=()=>{let{setRetryArgs:e}=Dt();return t=>{if(t instanceof xn){let{successfulTxIds:n}=t,[r,o]=n;e({type:"BRC20",commitTxId:r,revealTxId:o})}}};function ys(){let e=ie(),{data:t}=ee({select:d=>d.identifier}),n=to(),r=Ln(),o=se();return X({mutationFn:async({multichainTransaction:d,pendingTransactionInput:c,senderAddress:p,gasEstimation:u})=>{if(!t)throw new Error("No account identifier found");let{networkID:m}=d,g=await kn.get(m).onBeforeSend({multichainTransaction:d,gasEstimation:u}),y=await Rn({accountIdentifier:t,accountSigner:o,multichainTransaction:g,networkID:m,pendingTransactionInput:c,senderAddress:p,storage:e,utxoManager:r});return Un(m,y)},onError(d){d instanceof Error&&(F.captureError(d,"fungibles"),d instanceof En&&n(d))}})}s();a();var no=U(M());var hs=(e,t,n)=>{let r=$(),{fungibles:o}=Ie({keys:[e]}),i=o.length===1?o[0]:void 0;(0,no.useEffect)(()=>{if(!i)return;let{type:d,data:c}=i,{balance:p,decimals:u,chain:m}=c,{id:g}=m,y=ae(d)===!0;if(!n||!p||y||p.isEqualTo(t))return;let T=K.transferFungibleLoggingContext(e),S={transactionId:n,decimals:u,chainId:g,isNativeToken:y,previousBalance:p,fungibleKey:e};r.setQueryData(T,S)},[n])};s();a();var oo=U(M());s();a();function ro(e,t,n){return L.PublicKey.findProgramAddressSync([e.toBuffer(),n.toBuffer(),t.toBuffer()],Pn)[0]}var Ts=new Pe("Unable to unwrap SOL. Wrapped SOL Token account does not exist."),bs=new Pe("Unable to unwrap SOL. Token account is not expected mint.");async function ws(e,t){let n=await e.getAccountInfo(t);if(!n)throw Ts;let r=In.decode(n.data);return new L.PublicKey(r.mint)}function As(e){if(e)return typeof e=="string"?new L.PublicKey(e):e}function ks(){let{connection:e}=He(),{data:t}=ee(),{solanaChainAddress:n,accountIdentifier:r}=(0,oo.useMemo)(()=>({solanaChainAddress:t?.addresses.find(fe),accountIdentifier:t?.identifier??""}),[t]),o=ie(),i=se(),{t:d}=Z();return X({mutationFn:async c=>{if(!n)return Promise.reject("solanaChainAddress not loaded");try{let{networkID:p,address:u}=n,m=new L.PublicKey(u),g=As(c?.tokenAccount)??ro(m,bt,Ce);if((await ws(e,g)).toBase58()!==bt.toBase58())throw bs;let T=cr(g,m,m,[],Ce),S=new rn.Transaction().add(T),x={ownerAddress:u,networkID:p,data:{signature:""},type:"unwrapSOL",display:{summary:{topLeft:{text:d("assetDetailUnwrappingSOL")}}}},D=await je({accountIdentifier:r,accountSigner:i,connection:e,feePayer:new L.PublicKey(u),pendingTransactionInput:x,storage:o,transaction:S,useSubmissionService:!1});return{networkID:p,id:D}}catch(p){throw p instanceof Error&&F.captureError(p,"tokens"),p}}})}s();a();var io=P({minutes:1}),vs=(e,t=!0)=>{let n=K.solanaBalance(e);return W({enabled:!!e&&t&&fe(e),gcTime:io,staleTime:io,queryKey:n,async queryFn(){if(!e)throw new Error("No chain address provided");if(fe(e))return vn(e.networkID).getBalance(new L.PublicKey(e.address));throw new Error(`SOL balance not implemented for ${e.networkID}`)}})};s();a();s();a();var so=U(M());var Ss=e=>{let{data:t}=hn();return(0,so.useMemo)(()=>{if(!e||!t)return;let n=e.data.chain.id,r=t.explorers[n]??mn.get(n).defaultExplorer,o,i;if(ae(e.type))i="address",o=e.data.walletAddress;else switch(e.type){case"SuiCoin":{i="token",o=e.data.contractAddress;break}case"ERC20":{i="address",o=e.data.contractAddress;break}case"SPL":case"CompressedSPL":{i="address",o=e.data.mintAddress;break}case"BRC20":return{explorerName:"Unisat",explorerUrl:`https://unisat.io/brc20?q=${e.data.walletAddress}`}}let d=gn({networkID:n,endpoint:i,explorerType:r,param:o});return{explorerName:fn[r],explorerUrl:d}},[e,t])};s();a();var ao=U(M());var Es=e=>{let t=$();return(0,ao.useCallback)(()=>t.invalidateQueries({queryKey:K.tokens(e)}),[t,e])};s();a();var co=U(M()),xs=(e,t)=>(0,co.useMemo)(()=>{if(e)if($e(e)){let n=Tn(e).toNumber().toLocaleString("en-US");return{leftSubtext:void 0,leftSubtextColor:void 0,rightSubtext:t("satsAmount",{sats:n.toString()})}}else return qe(e)&&e.highFees?{leftSubtext:t("notificationTransactionApprovalNetworkFeeHighWarning"),leftSubtextColor:yn.colors.legacy.accentWarning,rightSubtext:""}:void 0},[e,t]);s();a();var Cs=U(M());s();a();var uo=U(M());var Ps=({caip19:e,fungibleCaip19:t,fungibleKeys:n,isSplCompressed:r})=>{let{fungibles:o,isLoadingTokens:i,refetch:d}=Ie({keys:n}),{data:c,refetch:p,isLoading:u}=pt({encodedCaip19:e,legacyKey:n?.[0]??null,isSplCompressed:r}),{data:m,isLoading:g}=Jt({caip19:e,includePrice:!0}),y=Os(o,r),T=(0,uo.useMemo)(()=>{if(!y)return;if(!c)return y;let x=At(c.totalQuantityString,c.decimals);return{...y,data:{...y.data,balance:x,usd:c.price?.price?x.times(c.price.price).toNumber():void 0,usd_24h_change:c.price?.priceChange24h!==void 0?lo(x.times(c.price.price).toNumber(),c.price?.priceChange24h):void 0}}},[y,c]);return{derivedFungible:Fs({fungible:T,fungibleCaip19:t,tokenDetails:m,tokenBalance:c}),isLoading:i||g||u,refetchFungibleBalance:d,refetchTokenBalance:p}};function Fs({fungible:e,fungibleCaip19:t,tokenDetails:n,tokenBalance:r}){if(e)return e;if(!n)return;let o=Kn(n),i="address"in t?Is(t,o):Bs(t,o);if(i){if(r){r.extraMetadata?.compression?.compressed&&(i.type="CompressedSPL");let d=At(r.totalQuantityString,r.decimals);i.data.balance=d,i.data.amount=r.totalQuantityString,i.data.usd=r.price?.price?d.times(r.price.price).toNumber():void 0,i.data.usd_24h_change=r.price?.priceChange24h!==void 0?lo(d.times(r.price.price).toNumber(),r.price?.priceChange24h):void 0,i.data.walletAddress=r.queriedWalletBalances.find(c=>c.quantity>0)?.address??""}return i}F.addBreadcrumb("tokens","deriveFungible","error",{fungibleCaip19:JSON.stringify(t),tokenDetails:JSON.stringify(n),tokenBalance:JSON.stringify(r)}),F.captureError(new Error(`Fungible type could not be derived from ${JSON.stringify(t)}`),"fungibles")}function Is(e,t){let n=Fe(e);if(ae(n))throw new Error("Cannot create fake non-native fungible for native token");let r=t.address??e.address,o={amount:"0",balance:O(0),chain:t.chain,decimals:t.decimals,logoUri:t.logoURI??t.logoUri,name:t.name??"Unknown",symbol:t.symbol??"Unknown",key:r,walletAddress:"",spamStatus:t.spamStatus};switch(n){case"SPL":return{type:n,data:{...o,mintAddress:r,programId:"",splTokenAccountPubkey:""}};case"CompressedSPL":return{type:n,data:{...o,mintAddress:r,programId:""}};case"ERC20":case"SuiCoin":return{type:n,data:{...o,contractAddress:r}};case"BRC20":return{type:n,data:{...o,firstCreatedInscriptionId:r}};case"HypercoreAsset":return;default:xe(n)}}function Bs(e,t){let n=Fe(e),r={amount:"0",balance:O(0),chain:t.chain,decimals:t.decimals,logoUri:t.logoURI??t.logoUri,name:t.name??"Unknown",symbol:t.symbol??"Unknown",key:n,walletAddress:"",spamStatus:t.spamStatus};switch(e.slip44){case"501":return{type:"SolanaNative",data:r};case"0":return{type:"BitcoinNative",data:r};case"60":return{type:"EthereumNative",data:r};case"8453":return{type:"BaseNative",data:r};case"143":return{type:"MonadNative",data:r};case"9001":return{type:"ArbitrumNative",data:r};case"925":return{type:"HypercoreNative",data:r};case"966":return{type:"PolygonNative",data:r};case"784":return{type:"SuiNative",data:r};default:{let o=new Error("Missing native token implementation when creating fake a Fungible");throw xe(e.slip44,o),o}}}var Os=(e,t)=>e?.length?[...e].sort((r,o)=>{if(t!==void 0){let i=r.type==="CompressedSPL",d=o.type==="CompressedSPL";if(i!==d)return t?i?-1:1:i?1:-1}return o.data.balance.minus(r.data.balance).toNumber()})[0]:void 0,lo=(e,t)=>{if(t===-100)return-1*e;let n=e/(1+t/100);return e-n};s();a();s();a();var To=U(M());s();a();s();a();var po="@phantom/wallet-screening",mo=`${po}:wallet-screen-action`,Us=`${po}:wallet-screen-geo`,gt={walletScreenAction(e){return[mo,e]},walletGeo(){return[Us]}};s();a();var fo=new Error("Failed to fetch wallet screen action.");async function go(e){try{let t=await q.api().post("/wallet_screen/v1",e);if(!Y(t))throw fo;let n=t.data;return Gn.parse(n)}catch{throw fo}}var yo=P({days:7}),ho=e=>{let t=e!==void 0&&N.isMainnetNetworkID(e.networkID),n=[];if(e!==void 0){let c=N.isEVMNetworkID(e.networkID)?e.address.toLowerCase():e.address;n=[{chainId:e.networkID,address:c,resourceType:"address"}]}let r={addresses:n},o=$(),i=gt.walletScreenAction(r),d=[i[0]];return W({enabled:t,queryKey:i,gcTime:yo,staleTime:yo,refetchInterval:!1,refetchOnMount:!1,async queryFn(){if(Ds(o,d))return"FAIL_SEVERE";let p=await go(r);return Ms(p)}})},Ds=(e,t)=>{let n=e.getQueriesData({queryKey:t,exact:!1}),r=!1;for(let[o,i]of n){let d=i;if(d&&d==="FAIL_SEVERE"){r=!0;break}}return r},Ms=e=>{let t=e.addressScreenResults;return t.some(n=>n.action==="FAIL_SEVERE")?"FAIL_SEVERE":t.some(n=>n.action==="FAIL_HIGH")?"FAIL_HIGH":t.some(n=>n.action==="NO_ACTION")?"NO_ACTION":"DATA_NOT_FOUND"};var Ns=(e,t)=>{let n=Ge(),{data:r}=ho(e);switch((0,To.useEffect)(()=>{r&&e&&n.capture("walletScreened",{data:{walletScreen:{action:r.toString(),surface:t},chainId:N.getChainID(e.networkID),networkId:e.networkID}})},[r,e,t,n]),r){case"FAIL_SEVERE":case"FAIL_HIGH":throw new $n(`Transaction disabled: ${t}`);case"NO_ACTION":case"DATA_NOT_FOUND":return}};s();a();s();a();s();a();var bo=new Error("Failed to fetch wallet geo.");async function wo(){try{let e=await q.api().get("/wallet_screen/v1/geo");if(!Y(e))throw bo;let t=e.data;return qn.parse(t).country}catch{throw bo}}var Ao=P({hours:1}),_s=()=>{let e=gt.walletGeo();return W({queryKey:e,staleTime:Ao,refetchInterval:Ao,queryFn:wo})};s();a();export{cr as a,b,er as c,qs as d,V as e,Oe as f,$s as g,Te as h,et as i,j,_o as k,Vo as l,rr as m,Dt as n,Ko as o,ys as p,hs as q,Zt as r,ks as s,$o as t,vs as u,Ss as v,ts as w,_t as x,Xc as y,gr as z,eu as A,Mu as B,hi as C,El as D,H as E,ot as F,Fr as G,Ir as H,st as I,Ae as J,te as K,Ur as L,ue as M,xi as N,de as O,ke as P,pe as Q,pt as R,Hi as S,qr as T,Lr as U,ve as V,ft as W,Kr as X,$r as Y,jr as Z,Jt as _,as as $,tn as aa,ls as ba,Es as ca,xs as da,gs as ea,Ps as fa,mo as ga,Ns as ha,_s as ia};
//# sourceMappingURL=chunk-MDYMDZNO.js.map
