import{i as V,j as b,k as x,l as $,m as X}from"./chunk-UWMKBOBS.js";import{B as Q,E as _,F as B,H as R,J as w,K as y,M as K,N as q,O as H,P as W,Q as G,U as J,V as Z,Y as p,b as i,i as C,j as m,y as N}from"./chunk-MDYMDZNO.js";import{A as P,l as j}from"./chunk-G3SJLT24.js";import{T as F,W as L,ec as k,nf as O}from"./chunk-MP5PPKB7.js";import{y as A}from"./chunk-LT72WXA6.js";import{h as l,n as c}from"./chunk-YJSZZTEX.js";l();c();var ae={Tokens:"fungibles",Collectibles:"collectibles"},E=i({tab:ae.Tokens,nonce:0}),ie=m(E,e=>e.tab),se=i(e=>e(ie),(e,o,n)=>{let a=e(E);if(le(a,n)){let r=typeof n=="object"?n.nonce:a.nonce,s=typeof n=="object"?n.defaultTab:n;o(E,{tab:s,nonce:r})}}),z=se;function le(e,o){return typeof o=="object"&&e.nonce===o.nonce?!1:typeof o=="string"?o!==e.tab:o.nonce>e.nonce}l();c();var ce=C(e=>{let o=e(J);return o?O(o):{queryKey:["default-mainnet"],queryFn:()=>({isDeveloperMode:!1})}}),ue=i(e=>!e(ce).data?.isDeveloperMode),S=ue;l();c();l();c();async function D({walletCaip19s:e,includeFungibleCaip19s:o,excludeFungibleCaip19s:n}){let a=await F.api().timeout(A({seconds:10})).get("/portfolio/v1/fungibles/value",{params:{walletAddresses:e.join(","),...o.length>0&&{includeFungibleCaip19s:o.join(",")},...n.length>0&&{excludeFungibleCaip19s:n.join(",")}}}).then(t=>{if(L(t))return t.data;throw new Error(t.data?.message||t.data?.error||t.statusText||`Status: ${t.status}`,{cause:t.data?.code})}).catch(t=>{throw k.addBreadcrumb("tokens","getPortfolioValue","error",{message:t.message,cause:t.cause,walletCaip19s:e.join(","),...o.length>0&&{includeFungibleCaip19s:o.join(",")},...n.length>0&&{excludeFungibleCaip19s:n.join(",")}}),k.captureError(t,"tokens"),t});return Q.parse(a)}var me=1e3,fe=5e3,de=m(i(e=>{let o=e(Z),a=e(G).reduce((t,r)=>{let s=P(void 0,{key:r.legacyKey??"",spamStatus:r.spamStatus??"NOT_VERIFIED"}),u=P(o,{key:r.legacyKey??"",spamStatus:r.spamStatus??"NOT_VERIFIED"});return s===u?t:s?{...t,exclude:[...t.exclude,r.encodedCaip19]}:{...t,include:[...t.include,r.encodedCaip19]}},{include:[],exclude:[]});return{include:a.include.sort().slice(0,50),exclude:a.exclude.sort().slice(0,50)}}),e=>e,(e,o)=>e.include.join(",")===o.include.join(",")&&e.exclude.join(",")===o.exclude.join(",")),pe=C(e=>{let o=e(w),{include:n,exclude:a}=e(de),t=e(R),r=e(S),s=j.portfolioValue({walletCaip19s:o,include:n,exclude:a,isMainnet:r});return{enabled:o.length>0&&!t&&r,queryKey:s,meta:{fetchCount:0},refetchInterval:f=>{let g=Number(f.meta?.fetchCount??0);return f.meta&&(f.meta.fetchCount=g+1),Math.min(Math.max(g*250,me),fe)},queryFn:async()=>D({walletCaip19s:o,includeFungibleCaip19s:n,excludeFungibleCaip19s:a})}}),h=pe;l();c();l();c();function be(e,o){return b(o,e)===0?0:e/b(o,e)*100}var Y=be;var ee=i(e=>{let o=e(p),n=!1,a=o.reduce((t,r)=>{let s=r.livePrice?.price??r.price?.price,u=r.livePrice?.priceChange24h??r.price?.priceChange24h;s&&(n=!0);let f=X(r,s??0),g=$(f,u??0);return{currentValue:V(t.currentValue,f),priceDifference:V(t.priceDifference,g)}},{currentValue:0,priceDifference:0});return n?{currentValue:a.currentValue,priceDifference:a.priceDifference,totalPercentChange24h:Y(a.priceDifference,a.currentValue)}:{currentValue:void 0,priceDifference:void 0,totalPercentChange24h:void 0}}),he=B({atomToStoreOffline:h,offlineKey:i(e=>`${e(K)??""}:portfolio-value`),namespaceKey:"fungible-tokens",ttlMs:A({days:10}),initialValue:{totalValueUsdCentsCurrent:void 0,totalValueUsdStringCurrent:void 0,totalValueUsdCents24h:void 0,totalValueUsdString24h:void 0,totalPercentChange24h:void 0},schema:N}),te=i(e=>{let o=e(he),n=o?.totalPercentChange24h,a=o?.totalValueUsdCents24h,t=o?.totalValueUsdCentsCurrent;return{currentValue:t!==void 0?t/100:void 0,priceDifference:a!==void 0&&t!==void 0?x(b(t,a),100):void 0,totalPercentChange24h:n}}),Mt=i(e=>{let o=e(ee),n=e(te);return{local:o,remote:n}}),Te=i(e=>{let o=e(p),n=e(H),a=o.slice(-15).map(t=>{let r=n[t.encodedCaip19]??t.livePrice??t.price;return r?t.totalQuantity*r.price/10**t.decimals:0}).filter(t=>t>0);return a.length>0?x(a.reduce((t,r)=>V(t,r),0),a.length):void 0}),ge=m(h,e=>e.status),Ae=i(e=>{if(!e(S))return{status:"idle",data:{currentValue:void 0,priceDifference:void 0,totalPercentChange24h:void 0}};let n=e(ee),a=e(ge),t=e(te),r=!e(W)&&e(y).isSuccess,s=e(Te),u=typeof s=="number"&&s<.05;return{status:a,data:r||u?n:t}}),vt=Ae;l();c();var oe=i({start:0,end:0}),T=10,ne=T*.75;function Ce(e){let o=Math.max(0,e-ne);return Math.floor(o/T)*T}function ye(e){let o=e+ne;return Math.ceil(o/T)*T}var I=i(0),M=i(20),Ve=i(e=>{let o=e(p),n=e(I),a=e(M);return o.slice(n,a)}),Se=m(Ve,e=>e,(e,o)=>{let n=e.map(t=>t.encodedCaip19).sort().join(","),a=o.map(t=>t.encodedCaip19).sort().join(",");return n===a}),_t=i(e=>e(Se),(e,o,n)=>{if(e(z)!=="fungibles")return;let t=0,r=0;Array.isArray(n)?(t=Math.min(...n),r=Math.max(...n),o(oe,{start:t,end:r})):(o(oe,n),t=n.start,r=n.end);let s=Ce(t),u=ye(r);s!==e(I)&&o(I,s),u!==e(M)&&o(M,u)});l();c();var v=i(0),re=i(0);function U(e,o){let n=m(e,({status:t,isFetching:r})=>({status:t,isFetching:r}),(t,r)=>JSON.stringify(t)===JSON.stringify(r));return _((t,r)=>{let s=t(n);s.isFetching||(s.status==="error"&&r(o,u=>u+1),s.status==="success"&&r(o,0))})}var ke=U(y,v),Pe=U(q,v),xe=U(h,re),Ee=i(e=>(e(Pe),e(ke),e(xe),{balanceErrorCount:e(v),priceErrorCount:e(re)})),Zt=Ee;export{S as a,h as b,ae as c,z as d,Mt as e,vt as f,Zt as g,_t as h};
//# sourceMappingURL=chunk-PY5WRCJM.js.map
