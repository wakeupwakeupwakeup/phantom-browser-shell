import{a as Qn}from"./chunk-IS4NLP65.js";import{a as Xn}from"./chunk-NQEFLXSV.js";import{a as Yn,b as qn,d as Jn,e as eo,f as to}from"./chunk-CHSHJ44H.js";import{sa as jn,ta as Zn,ua as ft}from"./chunk-AMFBRYZX.js";import{i as Eo}from"./chunk-SERUZOGH.js";import{a as wt}from"./chunk-XQOJIQLP.js";import{a as Ct}from"./chunk-5JX67CVA.js";import{r as zn}from"./chunk-HO7ZJLVP.js";import{f as $n}from"./chunk-6OGAEY46.js";import{Ta as On,sa as Ln}from"./chunk-GWUVAKX4.js";import{o as sn}from"./chunk-64SFTQTZ.js";import{t as ct}from"./chunk-3D6TIEIV.js";import{$ as Un,G as Pn,R as pt,Z as Dn,ca as Mn,da as Vn,ha as Hn,m as Ke,n as f,p as kn,q as In,r as En,u as Rn}from"./chunk-MDYMDZNO.js";import{$a as $e,Aa as wn,Ca as vn,E as lt,G as fn,H as Ge,Ha as _e,J as gn,N as Sn,P as yn,Q as xt,Va as Nn,X as mt,Ya as Bn,Z as bn,ba as An,d as Qe,e as pn,ea as hn,ga as Tn,ja as Fn,ma as ut,oa as xn,va as Cn}from"./chunk-G3SJLT24.js";import{a as Kn,c as _n}from"./chunk-EW3NOMMT.js";import{A as Wn,R as Gn,eb as Ye,m as ee}from"./chunk-AXFDOJRV.js";import{a as rn}from"./chunk-HPOIQOE7.js";import{S as cn,Sb as mn,Ta as Ue,Tb as un,Wa as ln}from"./chunk-FDJQKATD.js";import{X as an,ga as Ee,la as dn,ta as kt}from"./chunk-OGTXJ4NL.js";import{A as Ht,Ec as Yt,Hb as Qt,P as rt,Qc as qt,Vd as We,Vf as at,_c as Jt,ac as it,ae as en,ec as De,ef as Ie,lb as C,md as ve,nb as Xe,sb as st,tb as Ft,vf as tn}from"./chunk-MP5PPKB7.js";import{U as _t,W as $t,X as zt,Z as jt,aa as Zt,b as Fe,ba as Xt,ea as Tt,f as Gt,fa as Pe,y as Kt}from"./chunk-LT72WXA6.js";import{Da as Y,E as Wt,Ia as Z,Ja as K,L as u,Lb as on,Q as J,c as B,db as nn,hb as dt}from"./chunk-NRW4C74H.js";import{f as R,h as i,m as Buffer,n as a}from"./chunk-YJSZZTEX.js";i();a();var ke=R(B());i();a();var Ne=R(B());i();a();var Re=R(B()),no=({goHome:e})=>{let{t}=J();return Re.default.createElement(Z,{height:"100%",paddingY:36,paddingX:"screen",justifyContent:"center",alignItems:"center"},Re.default.createElement(Z,{flex:1,justifyContent:"center",alignItems:"center"},Re.default.createElement(Z,{marginBottom:24},Re.default.createElement(dt,{icon:"X",size:64,shape:"circle",backgroundColor:"accentAlert"})),Re.default.createElement(K,{color:"textPrimary",align:"center",font:"title1Semibold",marginBottom:8},t("sendErrorTitle")),Re.default.createElement(K,{color:"textSecondary",align:"center",font:"body"},t("sendErrorFallback"))),Re.default.createElement(nn,{theme:"secondary",onPress:e},t("homeTab")))};var vt=(0,Ne.createContext)(!1),Rr=({goHome:e,children:t})=>{let n=(0,Ne.useCallback)(()=>{f.getState().resetSendSlice(),e()},[e]);return Ne.default.createElement(rn,{fallback:o=>{if(o instanceof Ke)return Ne.default.createElement(no,{goHome:n});throw o}},Ne.default.createElement(vt.Provider,{value:!0},t))};i();a();var ro=R(B());i();a();i();a();var oo=(e,t)=>{let{getExistingAccount:n,getKnownAddressLabel:o}=Ee();if(!e)return null;let r=n(e),s=o(e,t),l=r?r.name:s;return l||null};var qe=({recipient:e,recipientHandle:t,networkID:n})=>{let o=oo(e,n),{data:r}=An(e,n),s=r?.address&&e;return{recipient:r?.address?r.address:e,recipientHandle:t||o||s||""}};i();a();var It=(e,t)=>{let n=ve(e,4);return t?`${t} (${n})`:n};var gt=()=>{let e=f(r=>r.sendFormValues.recipient),t=f(r=>r.sendFormValues.recipientHandle),n=f(r=>r.encodedCaip19),o=n?st(n).chainId:Xe.Solana.Mainnet;return qe({recipient:e,recipientHandle:t,networkID:o})},Et=()=>{let{recipient:e,recipientHandle:t}=gt();return(0,ro.useMemo)(()=>It(e,t),[e,t])};var ae=()=>{if(!(0,ke.useContext)(vt))throw new Error("useSendFungibleFlow must be used within a SendFungibleFlowErrorBoundary");let t=f(P=>P.fungibleKey),n=f(P=>P.encodedCaip19),o=f(P=>P.splTokenAccount),r=f(P=>!!P.sendFormValues.solana),s=(0,ke.useMemo)(()=>{if(n)return n;if(r&&t)return t==="SolanaNative"?Ft({chainId:C.solana.mainnetID,resourceType:"nativeToken",slip44:"501"}):Ft({chainId:C.solana.mainnetID,resourceType:"address",address:t})},[n,r,t]),{data:l}=pt({legacyKey:t??"",encodedCaip19:s??"",isSplCompressed:!1,queryOptions:{enabled:!!t&&!!s}}),m=(0,ke.useMemo)(()=>{if(l)return Zn(l,{splTokenAccount:o})},[l,o]),[c]=(0,ke.useState)(m),{data:p}=at({address:c?.data.walletAddress,networkID:c?.data.chain.id});if(!c&&!p)throw new Ke("fungible and senderAddress are undefined, send flow is broken");if(!c)throw new Ke("fungible is undefined, send flow is broken");if(!p)throw new Ke("senderAddress is undefined, send flow is broken");let{data:d,type:w}=c,{chain:v,decimals:I,logoUri:D,symbol:U,balance:_,key:g}=d,F=(0,ke.useMemo)(()=>{if(l)return ft(l);if(d.tokenAddress)return d.tokenAddress},[l,d.tokenAddress]),E=v.id,O=U||(F?ve(F,4):u.t("tokenRowUnknownToken")),H=F??"",z=w==="SPL"?c.data.programId:null,N=Et(),k=f(P=>P.sendFormValues),{amountAsset:T}=k,h=Pe(T,I),x=`${$e(h,I)} ${O}`,W=(0,ke.useMemo)(()=>vn(c),[c]),{data:M}=gn({query:W?{data:W}:void 0}),{fromUsd:j,formatLocalizedPrice:ce}=mt(),ge=M?.usd??0,xe=Qe(h.toNumber(),ge),oe=j(xe),V=ce(oe),le=ge?`~${V}`:"-",re=Cn(c);return{senderAddress:p,networkID:E,tokenAddress:H,symbol:O,balance:_,decimals:I,programId:z,formattedRecipient:N,uiAmount:h,usdPriceOfToken:ge,formattedUiAmount:x,formattedCurrencyAmount:le,tokenPrice:V,logoUri:D,type:w,key:g,transferFeePercent:re}};i();a();var St=R(B());i();a();i();a();var No=[mn.toString(),un.toString()],so=async(e,t)=>{let n=ln(t);try{let o=await n.getParsedAccountInfo(new rt.PublicKey(e));if(o&&No.includes(o.value?.owner.toString()??"")&&"mintAuthority"in(o.value?.data).parsed.info)return!0}catch{}return!1};var Bo=1*24*60*1e3,Po=1*60*1e3,io=({address:e,networkID:t})=>Yt({queryKey:["is-mint-account",e],queryFn:async()=>{if(!C.isSolanaNetworkID(t))throw new Error("Attempting to get mint account for non-Solana network");return so(e,t)},enabled:!!e&&C.isSolanaNetworkID(t),gcTime:Bo,staleTime:Po});i();a();var co=R(B());i();a();var ao=890880,Je=()=>{let{senderAddress:e,type:t,networkID:n}=ae(),o=f(c=>c.sendFormValues),r=t==="SolanaNative",s=qe({recipient:o.recipient,recipientHandle:o.recipientHandle,networkID:n}),{data:l}=Rn({...e,address:s.recipient},r);return r&&typeof l<"u"&&l<ao?ao:0};var lo=(e,t,n)=>{let{fungibleKey:o,splTokenAccount:r}=f(I=>({fungibleKey:I.fungibleKey,splTokenAccount:I.splTokenAccount})),{data:[s]}=it(["kill-send-simulation"]),l=Je(),m=(0,co.useMemo)(()=>{if(!(!e||s))return{sendSessionId:"simulate-send",shouldShowFiatValues:!1,fungibleKey:o,splTokenAccount:r,confirmedFungibleAndSender:null,sendFormValues:{recipient:t,recipientHandle:"",amountAsset:new Fe(l===0?1:l),solana:{references:[]}},gasEstimation:void 0}},[s,l,e,o,t,r]),{data:c,isLoading:p}=_e(m),d={type:"transaction",userAccount:e,params:void 0,url:"https://phantom.com",networkID:n};c&&(C.isEVMNetworkID(c.networkID)&&(d.params={transactions:[c.unsignedTransaction]}),C.isSolanaNetworkID(c.networkID)&&(d.params={transactions:c.transaction.map(I=>Ht(I)),method:"signAndSendTransaction"}));let{data:w,isLoading:v}=Ln(d,{disabled:!c||s,disableRefetch:!0});return{data:w,isLoading:!s&&(p||v)}};var Do=(e,t)=>({address:e,addressType:Qt(t,e),networkID:t}),Uo=({senderAddress:e,senderAccounts:t,networkID:n})=>(0,St.useMemo)(()=>e?t.reduce((o,r)=>{let s=r.addresses.filter(l=>l.networkID===n&&l.address!==e);if(n)for(let l of s)o.push({label:r.name,address:l.address,chainID:n});return o},[]):[],[e,t,n]);function Mo(e){if(!e)return"";let{warnings:t=[],error:n=""}=e;return n==="UNKNOWN_ERROR"?t[0]?.message:n==="INSUFFICIENT_FUNDS"?u.t(`sendWarning_${n}`):""}var Vo=({senderAddress:e,recipient:t,networkID:n})=>{let{data:o,isLoading:r}=lo(e??"",t,n);return{simulationWarning:Mo(o),isSimulationLoading:r}},Lo=({recipient:e,networkID:t})=>{let{currentRecipient:n,isStaleRecipient:o,recipientError:r}=Tn(e,t);return!o&&!r&&n.length>0?n:""},Oo=({recipient:e,networkID:t})=>{let{data:n=[],isLoading:o}=wn({chainAddresses:e?[Do(e,t)]:[]});return{recipientHasZeroBalance:(0,St.useMemo)(()=>n.length===1&&n[0].data.amount==="0",[n]),recipientTokensIsLoading:o}},et=({senderAddress:e,senderAccounts:t,networkID:n,recipient:o})=>{let{recentAddresses:r,savedAddresses:s}=Ee(),l=Uo({senderAddress:e,senderAccounts:t,networkID:n}),m=Lo({recipient:o,networkID:n}),{recipientHasZeroBalance:c,recipientTokensIsLoading:p}=Oo({recipient:m,networkID:n}),{data:d,isLoading:w}=io({address:m,networkID:n}),{simulationWarning:v,isSimulationLoading:I}=Vo({senderAddress:e??"",recipient:m,networkID:n}),D=!m||p||w&&C.isSolanaNetworkID(n)||I;return{sendAddressWarning:(0,St.useMemo)(()=>D||!e?null:d?u.t("sendMintAccountWarning"):l.find(g=>g.address===m)?null:v||(r.addresses.find(g=>g.address===o)||s.addresses.find(g=>g.address===o)?null:e===m?u.t("sendSameAddressWarning"):c?u.t("sendRecipientZeroBalanceWarning"):u.t("sendUnknownAddressWarning")),[r,s,o,m,l,e,c,d,v,D]),sendAddressVariant:d?"danger":"warning"}};i();a();var L=R(B());i();a();function mo(e,t){return e.isZero()?new Fe(Ue.get(t).amountForGasEstimation??0):e}var Ho=Kt({seconds:10}),Wo=({onClose:e,onNext:t})=>{let{senderAddress:n,networkID:o,decimals:r,programId:s,type:l,balance:m,usdPriceOfToken:c,symbol:p,logoUri:d,formattedUiAmount:w,formattedCurrencyAmount:v}=ae(),I=Je(),D=Pe(I,r).toNumber(),[U,_]=(0,L.useState)(""),g=(0,L.useMemo)(()=>{try{let y=new Fe(U);if(!y.isNaN())return y}catch{}return new Fe(0)},[U]),F=f(y=>y),E=f(y=>y.sendFormValues),O=f(y=>y.resetSendSlice),{amountAsset:H,amountUsd:z,recipient:N}=E,k=f(y=>y.setSendFormValues),T=f(y=>y.shouldShowFiatValues),h=f(y=>y.setShouldShowFiatValues),x=s===qt,W=E.solana.memo,M=(0,L.useMemo)(()=>{let y=F.sendFormValues.recipient;return{...F,sendFormValues:{...E,recipient:y||n.address,amountAsset:mo(E.amountAsset,o)}}},[E,F,n,o]),{data:j}=_e(M),{data:ce}=Ge({networkID:o,multichainTransaction:j,transactionSpeed:"fastest",queryOptions:{refetchInterval:Ho}}),{currencySymbol:ge,currencyCode:xe,toUsd:oe,fromUsd:V,formatLocalizedPrice:le}=mt(),re=En({chainAddress:n,type:l,balance:m,decimals:r,recipient:N,gasEstimation:ce,clampToZero:!0}),P=Pe(re??0,r),Me=Qe(P.toNumber(),c),X=V(Me,2),Se=T?ge:void 0,q=T?void 0:` ${p}`,Ce=T?xe:p,se=(0,L.useMemo)(()=>{if(g.isZero())return;let y=ut.get(o),G=T?y.minimumSendableCurrencyAmount:D,we=T?X:P,Ze=g.lt(G),ht=g.gt(we);return Ze?u.t("sendFormErrorMinRequiredInterpolated",{minAmount:G,tokenName:Ce}):ht?u.t("sendFormErrorInsufficientBalance"):void 0},[g,T,o,X,P,D,Ce]),Q=(0,L.useCallback)(y=>{let G=Zt(y),we=Xt(G,r);_(we)},[r]),me=(0,L.useCallback)(()=>{let y=Pe(H,r).toString(10),G=V(z??0).toString(10);Q(T?y:G),h(!T)},[T,h,H,z,r,Q,V]),ye=(0,L.useCallback)(()=>{Q(T?X.toString(10):P.toString(10))},[Q,T,P,X]);(0,L.useEffect)(()=>{let y,G,we;T?(we=g.toNumber(),G=oe(we),y=Tt(pn(G,c,r),r)):(y=Tt(g,r),G=Qe(g.toNumber(),c)),k({...f.getState().sendFormValues,amountAsset:y,amountUsd:G})},[k,g,T,c,r,oe]),(0,L.useEffect)(()=>{if(U)return;let y=T?z:Pe(H,r).toNumber();y&&_(y.toString())},[]);let Ve=(0,L.useMemo)(()=>T?c?`${w}`:`??? ${p}`:`${v}`,[T,c,p,w,v]),Le=(0,L.useMemo)(()=>{let y=Se??"",G=q??"";return T?`${le(X)}`:`${y}${$e(P)}${G}`},[T,X,P,Se,q,le]),be=(0,L.useCallback)(y=>{let G=E.solana;G.memo=y,k({...E,solana:G})},[E,k]),Be=(0,L.useMemo)(()=>!se&&H.gt(0),[se,H]),Oe=(0,L.useCallback)(()=>{Be&&t()},[Be,t]),ot=(0,L.useCallback)(()=>{e(),O()},[e,O]),je=(0,L.useMemo)(()=>({edit:u.t("commandEdit"),next:u.t("commandNext"),send:u.t("commandSend"),cancel:u.t("commandCancel"),maxInput:u.t("maxInputMax"),inputAmountPlaceholder:u.t("maxInputAmount"),recipientAddress:u.t("sendRecipientAddress"),memoPlaceholder:u.t("sendMemoOptional"),availableToSend:u.t("availableToSend"),available:u.t("available"),pageTitle:`${u.t("commandSend")} ${p}`}),[p]),Ae=C.isMainnetNetworkID(o);return{networkID:o,handleClose:ot,handleInputChange:Q,handleMemoChange:be,handleNext:Oe,primaryTextPrefix:Se,primaryText:U,primaryTextSuffix:q,toggleDenomination:me,errorText:se,secondaryText:Ve,formattedMaxAmount:Le,primarySymbol:Ce,symbol:p,decimals:r,logoUri:d,canGoNext:Be,i18nStrings:je,handleSetMax:ye,showSecondaryText:Ae,canSendCurrencyAmount:Ae&&!!c,isMemoEnabled:x,memo:W}};i();a();var de=R(B());var Go=({onClose:e,onRecipientNavigation:t,onAmountNavigation:n,networkID:o})=>{let{recipientHandle:r}=f(k=>k.sendFormValues),{data:s,isLoading:l}=On({usernameOrUserProfileId:r}),m=(0,de.useMemo)(()=>{if(s?.addresses)return Object.keys(s.addresses)},[s]),{isLoading:c,hasNextPage:p,fungibleTokens:d,visibilityOverrides:w}=Dn(),v=(0,de.useMemo)(()=>{let k=o?d.filter(h=>h.decodedCaip19.chainId===o):d;return(m?k.filter(h=>m.includes(h.decodedCaip19.chainId)):k).filter(h=>!h.extraMetadata?.compression?.compressed)},[o,d,m]),[I,D]=(0,de.useState)(""),U=$t(I)??"",_=zt(v,U,Qn),g=f(k=>k.resetSendSlice),F=(0,de.useMemo)(()=>({close:u.t("commandClose"),search:u.t("assetListSearch"),unknownToken:u.t("assetDetailUnknownToken"),noTokens:u.t("sendNoTokens")}),[]),E=(0,de.useCallback)(k=>D(k),[D]),O=(0,de.useCallback)(()=>{e(),g()},[e,g]),H=(0,de.useCallback)(k=>{let{key:T,splTokenAccountPubkey:h,networkId:x,encodedCaip19:W}={key:k.legacyKey??k.encodedCaip19,splTokenAccountPubkey:jn(k,{find:"highestQuantity"})?.account,networkId:k.decodedCaip19.chainId,encodedCaip19:k.encodedCaip19},M=f.getState().fungibleKey;M&&M!==T&&f.getState().resetSendSlice(),f.setState({fungibleKey:T,splTokenAccount:h,encodedCaip19:W});let j=f.getState().sendFormValues;if(j.recipientHandle&&!j.recipient){let ce=s?.addresses[x];if(ce){f.setState({sendFormValues:{...j,recipient:ce}}),n();return}}t()},[t,n,s?.addresses]),z=c||l;return{fungibles:(0,de.useMemo)(()=>p?[..._,"loading"]:_,[p,_]),isLoading:z,visibilityOverrides:w,searchQuery:I,handleSearch:E,handleClose:O,handleSelect:H,i18nStrings:F}};i();a();i();a();var Rt=R(B());var Nt=()=>{let e=f(p=>p.analyticsRecipient),t=f(p=>p.fungibleKey),n=f(p=>p.encodedCaip19),{data:o}=pt({legacyKey:t??"",encodedCaip19:n??"",isSplCompressed:!1,queryOptions:{enabled:!!t&&!!n}}),r=n?st(n).chainId:Xe.Solana.Mainnet,{data:s=[]}=Ie(),{data:l}=en(),m=(0,Rt.useMemo)(()=>s.some(p=>p.addresses.some(d=>d.address===e?.address)),[s,e]),{data:c}=at({address:o?.walletAddress,networkID:r});return(0,Rt.useMemo)(()=>({assetType:"token",networkId:r,recipient:e,senderAddress:c?.address??"",senderUsername:l?.username??"",tokenAddress:o?ft(o)??"":"",tokenSymbol:o?.symbol??"",tokenType:o?Pn(o):void 0,selfSend:m}),[r,e,c?.address,l?.username,o,m])};i();a();var Ko=R(B());i();a();var _o=R(B());i();a();var ne=R(B());i();a();var fo=R(B(),1),go=R(B(),1),$o=e=>typeof e=="function",uo=(e,t)=>$o(e)?e(t):e,zo=(()=>{let e=0;return()=>(++e).toString()})();var jo=20,yt=new Map,Zo=1e3,po=e=>{if(yt.has(e))return;let t=setTimeout(()=>{yt.delete(e),bt({type:4,toastId:e})},Zo);yt.set(e,t)},Xo=e=>{let t=yt.get(e);t&&clearTimeout(t)},Pt=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,jo)};case 1:return t.toast.id&&Xo(t.toast.id),{...e,toasts:e.toasts.map(s=>s.id===t.toast.id?{...s,...t.toast}:s)};case 2:let{toast:n}=t;return e.toasts.find(s=>s.id===n.id)?Pt(e,{type:1,toast:n}):Pt(e,{type:0,toast:n});case 3:let{toastId:o}=t;return o?po(o):e.toasts.forEach(s=>{po(s.id)}),{...e,toasts:e.toasts.map(s=>s.id===o||o===void 0?{...s,visible:!1}:s)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(s=>s.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let r=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(s=>({...s,pauseDuration:s.pauseDuration+r}))}}},Qo=[],Bt={toasts:[],pausedAt:void 0},bt=e=>{Bt=Pt(Bt,e),Qo.forEach(t=>{t(Bt)})};var Yo=(e,t="blank",n)=>({createdAt:Date.now(),visible:!0,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:n?.id||zo()}),tt=e=>(t,n)=>{let o=Yo(t,e,n);return bt({type:2,toast:o}),o.id},te=(e,t)=>tt("blank")(e,t);te.error=tt("error");te.success=tt("success");te.loading=tt("loading");te.custom=tt("custom");te.dismiss=e=>{bt({type:3,toastId:e})};te.remove=e=>bt({type:4,toastId:e});te.promise=(e,t,n)=>{let o=te.loading(t.loading,{...n,...n?.loading});return e.then(r=>(te.success(uo(t.success,r),{id:o,...n,...n?.success}),r)).catch(r=>{te.error(uo(t.error,r),{id:o,...n,...n?.error})}),e};i();a();var So=R(B()),yo=({networkID:e,transactionUnitAmount:t,onTransactionSpeedChange:n})=>{let{status:o,data:r}=lt({networkID:e}),{transactionSpeed:s}=f(m=>m.sendFormValues),l=(0,So.useMemo)(()=>{if(o!=="error"&&r&&s)return()=>n({transactionSpeed:s,transactionUnitAmount:t})},[n,s,t,r,o]);return{transactionSpeed:s,openTransactionSettings:l}};var er=({networkID:e,formattedRecipient:t,networkName:n,networkFee:o,networkFeeErrorMsg:r,networkFeeRow:s,displayFeeTooltip:l,transferFeePercent:m,solanaMetadata:c,ValueLoader:p,openTransactionSettings:d,onNetworkFeeDescriptionPress:w,onTransferFeePress:v})=>(0,ne.useMemo)(()=>[C.isSolanaNetworkID(e)&&c.label?{label:u.t("sendConfirmationLabel"),value:c.label}:void 0,C.isSolanaNetworkID(e)&&c.message?{label:u.t("sendConfirmationMessage"),value:c.message}:void 0,{label:u.t("transactionsTo"),value:t},{label:u.t("sendFungibleSummaryNetwork"),value:n},{label:u.t("sendFungibleSummaryNetworkFee"),value:o.length>0?o:r?null:p,color:r?Y.colors.legacy.accentAlert:Y.colors.legacy.textPrimary,leftSubtext:r||void 0,leftSubtextColor:Y.colors.legacy.accentAlert,rightSubtext:s?.rightSubtext,tooltipContent:l?u.t("networkFeesTooltipDescription",{chainName:n})||"":void 0,onClick:l?d:void 0,onPress:l?d:void 0,handleTooltip:l?w:void 0},m?{label:u.t("sendFungibleTransferFee"),value:`${m}%`,tooltipContent:u.t("sendFungibleTransferFeeToolTip")||"",handleTooltip:v}:void 0,c.memo?{label:u.t("sendMemo"),value:c.memo.replace(/(\r\n|\n|\r)/gm," ")}:void 0].filter(Gt),[l,o,r,s?.rightSubtext,e,n,w,v,d,t,c.label,c.memo,c.message,m,p]),tr=({hasSufficientFunds:e,isTransactionUnitError:t,isTransactionCreationError:n,hasGasEstimationFailed:o,nativeTokenSymbol:r})=>t?u.t("transactionGasLimitError"):o?u.t("transactionGasEstimationError"):e==="insufficient"?u.t("transactionNotEnoughNative",{nativeTokenSymbol:r}):n?u.t("transactionCreationError"):"",nr=({onNext:e,onClose:t,ValueLoader:n,onTransactionSpeedChange:o,onNetworkFeeDescriptionPress:r,onTransferFeePress:s,onSubmissionCheckFail:l,copyToClipboard:m})=>{let c=We(),{senderAddress:p,networkID:d,symbol:w,formattedRecipient:v,uiAmount:I,key:D,type:U,transferFeePercent:_}=ae(),g=f(),F=f(ie=>ie.sendFormValues),E=f(ie=>ie.setSendFormValues),{amountAsset:O,solana:H}=F,z=C.getNetworkName(d);Hn(p,"SEND_FUNGIBLE");let{data:N,isError:k}=_e(g),{data:T,isError:h}=fn(N),x=(0,ne.useCallback)(({transactionSpeed:ie,transactionUnitAmount:ue})=>{o({transactionSpeed:ie,transactionUnitAmount:ue,sendFormValues:F,setSendFormValues:E,networkID:d})},[E,F,d,o]),{transactionSpeed:W,openTransactionSettings:M}=yo({networkID:d,transactionUnitAmount:T,onTransactionSpeedChange:x}),{data:j,isFetched:ce,isSuccess:ge}=Ge({networkID:d,multichainTransaction:N,transactionSpeed:W,queryOptions:{refetchInterval:!1}}),{data:xe}=Sn(d,j),oe=bn(p),V=xn(U)?O:new Fe(0),{hasSufficientFunds:le,isLoading:re,nativeTokenSymbol:P}=Un({networkID:d,addressType:p?.addressType,gasEstimation:j,transactionValue:V,recipient:F.recipient}),Me=hn({networkID:d,gasEstimation:j,gasEstimationPrice:xe}),X=Vn(j,u.t),{data:Se}=lt({networkID:d}),q=(0,ne.useMemo)(()=>Ue.get(d).supportsNetworkSettings&&Object.keys(Se??{}).length>1,[Se,d]);(0,ne.useEffect)(()=>{c.capture("sendAssetSummary",{data:{type:"fungible",symbol:w,networkId:d,chainId:C.getChainID(d)}})},[d,w,c]);let{data:Ce=[]}=Ie(),{sendAddressVariant:se}=et({senderAddress:p?.address,senderAccounts:Ce,networkID:d,recipient:F.recipient}),Q=ce&&!ge,me=!!j&&!re&&le!=="insufficient"&&!!Me&&se!=="danger",ye=tr({hasSufficientFunds:le,isTransactionUnitError:h,isTransactionCreationError:k,hasGasEstimationFailed:Q,nativeTokenSymbol:P}),Ve=(0,ne.useCallback)(()=>N?oe?(c.capture("showFungibleTxSubmissionFailureModal"),l(oe),!1):(E({...F,multichainTransaction:N}),!0):!1,[N,oe,E,F,c,l]),Le=_t((0,ne.useCallback)(()=>{if(!Ve())return;let ue={chainID:d,amount:I.toString(),symbol:w,address:D};De.addBreadcrumb("fungibles","approved","info",ue),e()},[Ve,w,I,d,e,D]),1e3),be=er({networkID:d,formattedRecipient:v,networkName:z,networkFee:Me,networkFeeErrorMsg:ye,networkFeeRow:X,transferFeePercent:_,solanaMetadata:H,displayFeeTooltip:q,ValueLoader:n,openTransactionSettings:M,onNetworkFeeDescriptionPress:r,onTransferFeePress:s}),{data:Be}=dn(),Oe=(0,ne.useMemo)(()=>{let ie=N&&cn(N)?N.transaction.map(ue=>{let y=Buffer.from(ue.serialize({verifySignatures:!1,requireAllSignatures:!1})).toString("base64");return{label:u.t("notificationCopyTransactionText"),value:y.slice(0,8),onClick:()=>{m(y),te.success(u.t("notificationTransactionCopied"))}}}):[];return[...be,...ie]},[be,N,m]),ot=(0,ne.useCallback)(()=>{t(),g.resetSendSlice()},[t,g]),je=Xn(u.language,C.isSolanaNetworkID(d)),Ae=(0,ne.useMemo)(()=>({title:u.t("sendConfirmationPrimaryText"),send:u.t("commandSend"),cancel:u.t("commandCancel")}),[]);return{senderAddress:p?.address,networkID:d,handleNext:Le,handleClose:ot,canSend:me,txSubmissionCheckFailureModal:oe,summaryRows:Be&&Wt?Oe:be,i18nStrings:Ae,networkHealth:je}};i();a();var S=R(B()),Ao=R(Eo());i();a();var bo=jt(We,e=>new Dt(e)),Dt=class{#e;constructor(t){this.#e=t}onSendFlowStart({assetType:t,context:n}){this.#e.capture("sendFlowStart",{data:{assetType:t,context:n}})}onSendAssetAttempt(t){this.#e.capture("sendAssetAttempt",{data:{chainId:C.getChainID(t.networkId),...t}})}onSendAssetSuccess(t){this.#e.capture("sendAssetSuccess",{data:{chainId:C.getChainID(t.networkId),...t}})}onSendAssetFailure(t){this.#e.capture("sendAssetFailure",{data:{chainId:C.getChainID(t.networkId),...t}})}};i();a();i();a();var nt=R(B()),or=[/Unknown instruction error/i,/Unknown error/i];function Ut({programId:e,customErrorCode:t,customErrorReason:n,errorReason:o}){let{t:r}=J(),s=We(),l=n||o,m=r(l);return(0,nt.useEffect)(()=>{s.capture("transactionErrorDetails",{data:{programId:e,customErrorCode:t,customErrorReason:n,errorReason:o,hasTranslatedErrorMessage:l!==m}})},[]),nt.default.createElement(Z,null,nt.default.createElement(K,{align:"center",color:"textSecondary"},m,t&&or.some(c=>c.test(l))?` (${r("transactionsError")}: ${t})`:""))}var rr=({sendSequenceAnalytics:e,onTransactionLinkPress:t,onClose:n,onCancel:o,onBack:r,mobileSignWithLedger:s,ledgerSupported:l})=>{let{t:m}=J(),{data:[c]}=it(["kill-base-history"]),{senderAddress:p,networkID:d,symbol:w,formattedRecipient:v,uiAmount:I,logoUri:D,tokenPrice:U,key:_}=ae(),{data:g,status:F}=tn(),E=(0,S.useMemo)(()=>g?.addresses??[],[g]),O=bo(),H=Nt(),z=f(),N=(0,S.useMemo)(()=>kt(d),[d]),{transactionSpeed:k,recipient:T}=z.sendFormValues,h=Nn(d,k,p,w,D??"",v,I.toNumber(),U,m),[x,W]=(0,S.useState)(!1),[M,j]=(0,S.useState)(null),[ce,ge]=(0,S.useState)(null),{addRecentAddress:xe}=Ee(),oe=g?.type==="ledger",[V,le]=(0,S.useState)(void 0),re=yn("send:fungible",d,!!s);In(_,I,V?V.id:"");let P=Mn(E),Me=(0,S.useCallback)($=>{re($.id,"confirmed"),O.onSendAssetSuccess({...H,txId:$.id}),P()},[O,re,P,H]),{isSuccess:X,isError:Se,error:q}=Fn(Me,V??void 0),Ce=!!V,se=ut.get(d).sendSuccessCondition,Q=(0,S.useMemo)(()=>{switch(se){case"SUBMISSION":return x?"ERROR":Ce?"SUCCESS":"LOADING";case"CONFIRMATION":return x||Se?"ERROR":X?"SUCCESS":"LOADING"}},[Se,X,x,Ce,se]),{isError:me,isSuccess:ye}=(0,S.useMemo)(()=>({isError:Q==="ERROR",isSuccess:Q==="SUCCESS"}),[Q]),Ve=(0,S.useMemo)(()=>{let $=Ue.get(d).transactionSpeedDescription(k??"standard");return $?m($):""},[d,k,m]),Le=se==="CONFIRMATION"?"sendStatusConfirmedSuccessTitle":"sendStatusSubmittedSuccessTitle",be=(0,S.useMemo)(()=>{switch(Q){case"LOADING":return m("sendStatusLoadingTitle");case"ERROR":return m("sendStatusErrorTitle");case"SUCCESS":return m(Le)}},[Q,Le,m]),Be=(0,S.useMemo)(()=>({titleText:be,retryText:m("commandRetry"),cancelText:m("commandCancel"),closeText:m("commandClose"),viewTransactionText:m("sendStatusViewTransaction")}),[be,m]);(0,S.useEffect)(()=>{X?(De.addBreadcrumb("fungibles","transactionStatus","info",{...N,status:"confirmed"}),V?.id&&e&&e.transactionStatus(V.id,{...N,status:{type:"confirmed"}})):me&&(De.addBreadcrumb("fungibles","transactionStatus","error",{...N,status:"error"}),V?.id&&e&&e.transactionStatus(V.id,{...N,status:{type:"error"}}))},[X,me,V,N,e]);let{mutateAsync:Oe}=kn(),je=me?S.default.createElement(S.default.Fragment,null,($=>{switch($){case"InsufficientFunds":return S.default.createElement(K,{color:"textSecondary",align:"center"},m("sendStatusErrorMessageInsufficientBalance"));case"UnknownError":default:return S.default.createElement(S.default.Fragment,null,S.default.createElement(K,{font:"bodySemibold",color:"textSecondary",align:"center"},S.default.createElement(ct,{i18nKey:"sendFungibleErrorMessageInterpolated",values:{uiAmount:I.toString(),assetSymbol:w,uiRecipient:v},components:{2:S.default.createElement(K,{font:"bodySemibold",color:"textPrimary"})}})),M?S.default.createElement(Z,{marginTop:16,justifyContent:"center"},S.default.createElement(K,{font:"body",color:"textSecondary"},m("sendFungibleSolanaErrorCode",{code:M}))):null)}})(ce??"InsufficientFunds"),q&&"data"in q?S.default.createElement(Z,{marginY:16,justifyContent:"center",color:"textSecondary"},S.default.createElement(Ut,{errorReason:q.data.errorReason,programId:q.data.programId,customErrorReason:q.data.customErrorReason,customErrorCode:q.data.customErrorCode})):null):ye&&se==="CONFIRMATION"?S.default.createElement(K,{font:"bodySemibold",color:"textSecondary",align:"center"},S.default.createElement(ct,{i18nKey:"sendFungibleConfirmedSuccessMessageInterpolated",values:{uiAmount:I.toString(),assetSymbol:w,uiRecipient:v},components:{2:S.default.createElement(K,{font:"bodySemibold",color:"textPrimary"})}})):ye&&se==="SUBMISSION"?S.default.createElement(K,{font:"bodySemibold",align:"center"},m("sendStatusEstimatedTransactionTime",{time:Ve})):S.default.createElement(K,{font:"bodySemibold",color:"textSecondary",align:"center"},S.default.createElement(ct,{i18nKey:"sendFungibleLoadingMessageInterpolated",values:{uiAmount:I.toString(),assetSymbol:w,uiRecipient:v},components:{2:S.default.createElement(K,{font:"bodySemibold",color:"textPrimary"})}})),Ae=z.sendFormValues.multichainTransaction,{data:ie}=Ge({networkID:d,multichainTransaction:Ae,transactionSpeed:k,queryOptions:{refetchInterval:!1}}),ue=ie,y=(0,S.useCallback)(async()=>{try{if(!Ae)throw new Error("multichainTransaction is undefined on send status");if(!ue)throw new Error("gasEstimation is undefined on send status");xe({address:T,chainID:d,timestamp:Date.now()});let $=Date.now();O.onSendAssetAttempt(H);let pe=await Oe({multichainTransaction:Ae,pendingTransactionInput:h,senderAddress:p,gasEstimation:ue}),He=pe.id;re(He,"initiated",$),re(He,"received");let he=kt(d),Te;he.chainType==="solana"&&e?(Te="signAndSendTransaction",e.submittedTransaction(pe.id,{...he,method:Te})):he.chainType==="eip155"&&e?(Te="eth_sendRawTransaction",e.submittedTransaction(pe.id,{...he,method:Te})):he.chainType==="sui"&&e?(Te="signAndExecuteTransaction",e.submittedTransaction(pe.id,{...he,method:Te})):he.chainName==="bitcoin"&&e&&(Te="sendrawtransaction",e.submittedTransaction(pe.id,{...he,method:Te})),De.addBreadcrumb("fungibles","submittedTransaction","info",{...he,txReceipt:pe.id,method:Te??"UNKNOWN"}),le(pe)}catch($){let pe=Bn($,N.chainType==="solana"?"solana":void 0);if(ge(pe),pe==="UnknownError"&&$ instanceof Error&&N.chainType==="solana"){let[He]=$.message.match(/0x\d+/)||[];typeof He=="string"&&He&&j(He)}W(!0),O.onSendAssetFailure(H),De.captureError($,"fungibles")}},[Ae,T,ue,xe,N,Oe,h,re,d,O,e,p,H,W]),G=f($=>$.retryArgs),we=(0,S.useCallback)(()=>{G?(le(void 0),W(!1),y()):r()},[y,r,G]),{data:Ze}=an(V),ht=(0,S.useCallback)(()=>{Ze&&t(Ze)},[t,Ze]),Ot=(0,S.useCallback)(()=>{o()},[o]),Co=(0,S.useCallback)(()=>{let{sendSuccessRedirect:$}=Ue.get(d);n($(c))},[n,c,d]),wo=sn(d),vo=F==="pending",Io=(0,S.useCallback)(()=>{l&&!ye&&!me&&z.resetSendSlice()},[ye,me,z,l]);return(0,Ao.default)(Io),{handleClose:Co,handleCancel:Ot,handleRetry:we,handleTransactionLinkPress:ht,isSuccess:ye,isError:me,MessageElement:je,title:be,txReceipt:V,handleTokenTransfer:y,i18nStrings:Be,isLoadingSelectedAccountStatus:vo,isLedger:oe,ledgerApp:wo}};i();a();var b=R(B());i();a();var fe=R(B());var sr=ee(qn)`
  width: 100%;
  border-style: none;
  padding: 0;
`,ho=ee(_n).attrs({width:"28px",borderRadius:"50px"})`
  height: 28px;
`,To=fe.default.memo(({isExpanded:e,addressBookRecipient:t,clearRecipient:n})=>{let{t:o}=J(),[r,s]=(0,fe.useState)(!1),l={onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1)},m=r&&!t&&!e;return fe.default.createElement(zn,{color:Y.colors.legacy.bgWallet,label:o("sendAddressBookButtonLabel"),ariaLabel:o("sendAddressBookButtonLabel"),alignment:"bottomRight",isVisible:m,triggerParams:l},t?fe.default.createElement(ho,{theme:"primary",paddingY:9,onClick:n},fe.default.createElement(Wn,{fill:Y.colors.legacy.bgWallet,width:10})):fe.default.createElement(sr,null,fe.default.createElement(ho,{paddingY:6,theme:"primary"},fe.default.createElement(Gn,{fill:Y.colors.legacy.bgWallet}))))});i();a();var Mt=R(B());var Fo=Mt.default.memo(({symbol:e,chainName:t,recipient:n,recipientError:o,handleRecipientChange:r,onBlur:s})=>{let{t:l}=J();return Mt.default.createElement($n,{type:"text",name:"recipient",value:n,autoComplete:"off",spellCheck:"false",placeholder:l("sendRecipientTextAreaPlaceholder2",{symbol:t||e}),warning:!!o,onChange:r,onBlur:s,paddingRight:"80px"})});var ko=ee(Ye).attrs({size:16,weight:500,color:Y.colors.legacy.textSecondary})`
  font-style: italic;
`,ir=ee(Yn)`
  width: 100%;
  position: relative;
`,ar=ee(Ct).attrs({align:"center"})`
  position: relative;
  border-radius: 6px;
  border: 1px solid ${Y.colors.legacy.borderSecondary};
  padding: 14px;
  background: ${Y.colors.legacy.bgArea};
  height: 50px;
  margin-bottom: 2px;
`,dr=ee(Jn)`
  z-index: 2;
  width: 100%;
`,Vt=ee(to)`
  padding: 8px 12px;
  min-height: 41px;
`,cr=ee(Ct).attrs({justify:"center"})`
  height: 85px;
`,xo=ee(Ye).attrs({size:16,color:Y.colors.legacy.textSecondary})``,lr=ee.div`
  position: absolute;
  right: 12px;
  top: calc(50% - 28px / 2);
  width: auto;
  display: flex;
  gap: 12px;
  align-items: center;
`,mr="__none",ur=50,At=10,pr=e=>{let{addressBookRecipient:t,networkID:n,senderAddress:o,symbol:r,sendFormValues:s,sendFormErrors:l,recipientError:m,handleAddressSelection:c,setSendFormValues:p,setSendFormErrors:d,isLoading:w}=e,{t:v}=J(),I=(0,b.useMemo)(()=>({sendAddressBookRecentlyUsed:v("sendAddressBookRecentlyUsed"),sendAddressBookNoAddressesSaved:v("sendAddressBookNoAddressesSaved")}),[v]),{data:D=[]}=Ie(),U=(0,b.useMemo)(()=>o?D.reduce((h,x)=>{let W=x.addresses.filter(M=>M.networkID===n&&M.address!==o);if(n)for(let M of W)h.push({label:x.name,address:M.address,chainID:n});return h},[]):[],[o,D,n]),{recentAddresses:_,savedAddresses:g}=Ee(),F=(0,b.useMemo)(()=>g.addresses.reduce((h,x)=>(n&&xt(C.getAddressTypes(x.chainID),C.getAddressTypes(n))&&h.push({...x}),h),[]),[g,n]),E=(0,b.useMemo)(()=>_.addresses.reduce((h,x)=>(n&&xt(C.getAddressTypes(x.chainID),C.getAddressTypes(n))&&h.push(x.address),h),[]),[_,n]),O=U.length===0&&F.length===0&&E.length===0,H=(0,b.useMemo)(()=>{for(let{address:h,label:x}of U)if(h===t)return x;for(let{address:h,label:x}of F)if(h===t)return x},[t,U,F]),{recipient:z}=s,N=(0,b.useCallback)(h=>{let x=h.currentTarget,W=self.getComputedStyle(x),M=parseInt(W.getPropertyValue("border-top-width"),At)+parseInt(W.getPropertyValue("padding-top"),At)+x.scrollHeight+parseInt(W.getPropertyValue("padding-bottom"),At)+parseInt(W.getPropertyValue("border-bottom-width"),At);M=x.value?Math.min(68,M-28):ur,x.style.height=`${M}px`,p({...s,recipient:x.value}),d({...l,recipientError:void 0})},[s,l,d,p]),k=(0,b.useCallback)(()=>{p({...s,recipient:"",addressBookRecipient:void 0})},[s,p]),T=(0,b.useMemo)(()=>{if(n)return C.getNetworkName(n)},[n]);return{i18nStrings:I,recipient:z,addressBookRecipient:t,addresses:U,savedAddresses:F,recentAddresses:E,isEmpty:O,selectedName:H,recipientError:m,symbol:r,chainName:T,handleAddressSelection:c,handleRecipientChange:N,clearRecipient:k,isLoading:w}},kc=b.default.memo(e=>{let t=pr(e);return b.default.createElement(fr,{...t})}),fr=b.default.memo(e=>{let{i18nStrings:t,recipient:n,addressBookRecipient:o,addresses:r,savedAddresses:s,recentAddresses:l,isEmpty:m,selectedName:c,recipientError:p,symbol:d,chainName:w,handleAddressSelection:v,handleRecipientChange:I,clearRecipient:D,isLoading:U=!1}=e;return b.default.createElement(ir,{onChange:v,value:o??mr},({isExpanded:_})=>b.default.createElement(b.default.Fragment,null,o?b.default.createElement(ar,null,c?b.default.createElement(Ye,{size:16,weight:500},c):b.default.createElement(ko,null,t.sendAddressBookRecentlyUsed),b.default.createElement(Ye,{opacity:.5,size:16,weight:400,margin:"0 0 0 6px"},"(",o.includes(".")?o:ve(o,4),")")):b.default.createElement(Fo,{symbol:d??"",chainName:w,recipient:n,recipientError:p,handleRecipientChange:I}),b.default.createElement(lr,null,U?b.default.createElement(Kn,{diameter:20}):null,b.default.createElement(To,{isExpanded:_,addressBookRecipient:o,clearRecipient:D})),b.default.createElement(dr,{portal:!1},b.default.createElement(eo,{maxHeight:"150px"},r.map(({address:g,label:F,chainID:E},O)=>b.default.createElement(Vt,{key:`${g}-${O}`,value:g},b.default.createElement(wt,{name:F,publicKey:g,publicKeyLabel:Jt(E,g)}))),s.map(({address:g,label:F},E)=>b.default.createElement(Vt,{key:`${g}-${E}`,value:g},b.default.createElement(wt,{name:F,publicKey:g}))),l.map((g,F)=>b.default.createElement(Vt,{key:`${g}-${F}`,value:g},b.default.createElement(ko,null,t.sendAddressBookRecentlyUsed),b.default.createElement(xo,{opacity:.5},ve(g,4)))),m&&b.default.createElement(cr,null,b.default.createElement(xo,null,t.sendAddressBookNoAddressesSaved))))))});i();a();var ze=R(B());var gr=()=>{let{uiAmount:e,symbol:t,formattedCurrencyAmount:n}=ae(),o=$e(e);return ze.default.createElement(Z,{direction:"column",alignItems:"center",marginTop:8,marginBottom:32},ze.default.createElement(Z,{marginBottom:16},ze.default.createElement(dt,{icon:"Send2",size:64,color:"accentPrimary",backgroundColor:"bgTabBar",shape:"circle"})),ze.default.createElement(K,{font:"heading1Semibold",align:"center"},o," ",t),n?ze.default.createElement(K,{color:"textSecondary",font:"title2",align:"center"},n):null)};i();a();var Lt=R(B());var Sr=({networkId:e,senderAddress:t})=>{let{data:n=[]}=Ie(),{recipient:o}=gt(),{sendAddressWarning:r,sendAddressVariant:s}=et({senderAddress:t,senderAccounts:n,networkID:e,recipient:o});return r?Lt.default.createElement(Z,{marginBottom:12},Lt.default.createElement(on,{level:s==="danger"?"1-critical-alert":"2-alert"},r)):null};i();a();i();a();var Ar=R(B());i();a();var yr=R(B());i();a();var hr=R(B());i();a();export{Rr as a,ae as b,et as c,nr as d,Wo as e,Go as f,Ut as g,rr as h,kc as i,gr as j,Sr as k};
//# sourceMappingURL=chunk-LTTG4ZRE.js.map
