import{o as ft,p as vt,s as wt}from"./chunk-HO7ZJLVP.js";import{a as yt,b as m}from"./chunk-MWGJZC2B.js";import{b as At}from"./chunk-IEC36PYL.js";import{j as C}from"./chunk-ZS5DCR5N.js";import"./chunk-YQDK2KIS.js";import"./chunk-CFJPS3RY.js";import"./chunk-6OURT4HP.js";import{N as ut,O as dt,U as kt,Y as mt,Z as pt,w as L}from"./chunk-3D6TIEIV.js";import{S as lt}from"./chunk-MDYMDZNO.js";import{J as ct,Pa as st}from"./chunk-G3SJLT24.js";import{a as St}from"./chunk-I4O7QVCI.js";import"./chunk-BDQDDHRI.js";import"./chunk-PRCCLR5N.js";import{a as gt,c as g}from"./chunk-EW3NOMMT.js";import{eb as r,m as s}from"./chunk-AXFDOJRV.js";import"./chunk-HPOIQOE7.js";import"./chunk-RL5NICHE.js";import"./chunk-DZSKJQUR.js";import"./chunk-IEY2ZFRQ.js";import"./chunk-BCKEKIIT.js";import"./chunk-GYYECUZK.js";import{Xa as rt,Ya as it}from"./chunk-FDJQKATD.js";import{V as at,W as nt}from"./chunk-OGTXJ4NL.js";import{Ib as R,lb as Z,md as z,vf as tt}from"./chunk-MP5PPKB7.js";import"./chunk-LV3AOIIH.js";import{C as V,b as X}from"./chunk-LT72WXA6.js";import{Da as i,Ia as et,Ja as ot,Q as y,c as J}from"./chunk-NRW4C74H.js";import"./chunk-2POO4JJE.js";import"./chunk-PQWATTJB.js";import"./chunk-OLIHMAK6.js";import{f as G,h as w,n as x}from"./chunk-YJSZZTEX.js";w();x();var t=G(J());w();x();var u=G(J());var Nt=s.div`
  display: grid;
  grid-template-columns: 100%;
  grid-template-rows: 47px auto;
  align-items: center;
  justify-content: flex-start;
  background: ${i.colors.legacy.bgRow};
  width: 328px;
  border-radius: 6px;
  margin-top: 24px;
`,Mt=s.div`
  display: grid;
  gap: 10px;
  grid-template-columns: 33px 1fr auto;
  align-items: center;
  padding: 9px 14px;
  border-bottom: 1px solid ${i.colors.legacy.bgWallet};
`,Et=s(yt)``,Ht=s.section`
  padding: 14px;
`,Ft=s.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  height: 30px;
  align-items: center;
`,Kt=s(r)`
  color: ${a=>a.activationState==="active"?i.colors.legacy.accentSuccess:a.activationState==="inactive"?i.colors.legacy.accentAlert:a.activationState==="activating"?i.colors.brand.yellowMoon:a.activationState==="deactivating"?i.colors.brand.yellowMoon:i.colors.legacy.textSecondary};
`,Ot=s(wt).attrs(()=>({tooltipAlignment:"bottomCenter",iconSize:12,lineHeight:17,fontWeight:400,fontSize:14,noWrap:!0}))``,N=a=>{let{t:o}=y(),{data:d}=kt(a.validatorKeybaseUsername),k=a.validatorName??a.validatorKeybaseUsername??a.voteAccountPubkey??a.stakeAccountPubkey;return u.default.createElement(Nt,null,u.default.createElement(Mt,null,u.default.createElement(Et,{width:28,iconUrl:a.validatorIconUrl??d}),u.default.createElement(r,{textAlign:"left",weight:600,size:16,noWrap:!0},k),u.default.createElement(Kt,{activationState:a.status,textAlign:"right",weight:400,size:14,noWrap:!0,textTransform:"capitalize"},a.status??"")),u.default.createElement(Ht,null,Object.entries(a.data).map(([c,n])=>u.default.createElement(Ft,{key:c,onClick:n.onClick},u.default.createElement(Ot,{info:n.tooltip?u.default.createElement(vt,null,u.default.createElement(ft,null,n.tooltip)):null},c==="Stake Account"?o("stakeAccountCardStakeAccount"):"",c==="Balance"?o("stakeAccountCardBalance"):"",c==="Rent Reserve"?o("stakeAccountCardRentReserve"):"",c==="Active Stake"?o("stakeAccountCardActiveStake"):"",c==="Lockup"?o("stakeAccountCardLockup"):"",c==="Rewards"?o("stakeAccountCardRewards"):""),n.node))))};var h=s.div`
  position: relative;
  display: grid;
  grid-template-rows: 42px auto 47px;
  height: 100%;
`,b=s.div`
  display: flex;
  flex-direction: column;
  align-items: center;
`,xt=s.a.attrs({target:"_blank",rel:"noopener noreferrer"})`
  color: ${i.colors.legacy.accentPrimary};
  text-decoration: none;
  cursor: pointer;
`,M=s.section`
  display: flex;
  gap: 15px;
`,_t=s.div`
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: flex-end;
`,jt=5e3,Qt=a=>{let{t:o}=y(),{showStakeAccountDeactivateStakeStatusModal:d,showStakeAccountDelegateStakeStatusModal:k,showStakeAccountWithdrawStakeStatusModal:c,closeAllModals:n}=At(),{data:f}=tt(),v=(0,t.useMemo)(()=>f?.addresses.find(S=>Z.isSolanaNetworkID(S.networkID)),[f]),{solanaPublicKey:ht,connection:P,networkID:E}=(0,t.useMemo)(()=>{let S=v?.address??"",Y=v?.networkID,zt=rt(it(Y));return{solanaPublicKey:S,connection:zt,networkID:Y}},[v]),bt=R("solana"),{data:Pt}=ct({query:{data:bt}}),{data:H}=lt(),T=Pt?.usd,A=mt(P,ht),e=A.data?.find(S=>S.pubkey===a.stakeAccountPubkey),D=e?.info.meta.authorized.staker,Tt=e?.lamports??0,F=parseFloat(e?.info.meta.rentExemptReserve??"0"),Dt=!!e?.inflationReward,{data:Wt=F}=st(v),W=!!(H&&new X(H.totalQuantityString).gt(Wt+jt)),l=pt(P,e?.pubkey).data,Bt=l?.active??0,Ut=l?.inactive??0,B=Tt-F-Bt,K=e?.info.stake?.delegation.voter,It=$t(P),p=K?It.get(K):void 0,O=new Date((e?.info.meta.lockup?.unixTimestamp??0)*1e3),U=dt(e),_=(l?.state==="active"||l?.state==="activating")&&W,j=l?.state==="inactive"&&!U&&W,{data:Vt}=at(E),{data:Q}=nt(E,e?.pubkey??""),I=[{key:"viewOnExplorer",label:o("stakeAccountViewViewOnExplorer",{explorer:Vt}),onClick:()=>{Q&&self.open(Q,"_blank")}}];e&&(p&&(l?.state==="inactive"||l?.state==="deactivating")&&I.push({key:"restake",label:o("stakeAccountViewRestake"),onClick:()=>{k({stakeAccountPubkey:e.pubkey,voteAccountPubkey:p?.voteAccountPubkey,lamports:l.inactive,onClose:n})}}),B>0&&B>Ut&&I.push({key:"withdrawUnstakedSOL",label:o("stakeAccountViewWithdrawUnstakedSOL"),onClick:()=>{c({stakeAccountPubkey:e.pubkey,amount:B,usdPerSol:T,onClose:n})}}));let $=(0,t.useCallback)(()=>{!e||!D||d({stakeAccountPubkey:e.pubkey,stakeAuthorityPubkey:D,onClose:n})},[e,D,d,n]),q=(0,t.useCallback)(()=>{e&&c({stakeAccountPubkey:e.pubkey,amount:e.lamports,usdPerSol:T,onClose:n})},[e,c,T,n]);return A.isPending?t.default.createElement(h,null,t.default.createElement(gt,null)):A.isError?t.default.createElement(h,null,t.default.createElement(C,null,o("stakeAccountViewPrimaryText")),t.default.createElement(b,null,t.default.createElement(r,{size:16,color:i.colors.legacy.textSecondary,lineHeight:20},A.error?.message??o("stakeAccountViewError"))),t.default.createElement(M,null,t.default.createElement(g,{onClick:n},o("commandClose")))):A.isSuccess&&e?t.default.createElement(h,null,t.default.createElement(C,{items:I},o("stakeAccountViewPrimaryText")),p?t.default.createElement(t.default.Fragment,null,t.default.createElement(b,null,t.default.createElement(r,{size:16,color:i.colors.legacy.textSecondary,lineHeight:20},t.default.createElement(St,{i18nKey:"stakeAccountViewSOLCurrentlyStakedInterpolated"},"Your SOL is currently staked with a validator. You\u2019ll need to unstake to ",t.default.createElement("br",null),"access these funds. ",t.default.createElement(xt,{href:L},"Learn more"))),t.default.createElement(N,{stakeAccountPubkey:e.pubkey,voteAccountPubkey:p?.voteAccountPubkey,validatorName:p?.info?.name,validatorKeybaseUsername:p?.info?.keybaseUsername,validatorIconUrl:p?.info?.iconUrl,status:l?.state,data:{"Stake Account":{node:t.default.createElement(r,{textAlign:"right",weight:500,size:14,noWrap:!0},z(e.pubkey))},Balance:{node:t.default.createElement(r,{textAlign:"right",weight:500,size:14,noWrap:!0},t.default.createElement(m,null,e.lamports))},"Rent Reserve":{node:t.default.createElement(r,{textAlign:"right",weight:500,size:14,noWrap:!0},t.default.createElement(m,null,e.info.meta.rentExemptReserve))},"Active Stake":{node:t.default.createElement(r,{textAlign:"right",weight:500,size:14,noWrap:!0},t.default.createElement(m,null,l?.active))},Lockup:{node:t.default.createElement(r,{textAlign:"right",weight:500,size:14,noWrap:!0},U?V(O):"\u2013")},Rewards:Dt?{node:t.default.createElement(_t,null,t.default.createElement(r,{color:i.colors.legacy.accentSuccess,textAlign:"right",weight:500,size:14,noWrap:!0},"+",t.default.createElement(m,null,e?.inflationReward))),tooltip:o("stakeAccountCardRewardsTooltip")}:{node:t.default.createElement(r,{color:i.colors.legacy.textSecondary,textAlign:"right",weight:500,size:14,noWrap:!0},"\u2013")}}}),W?null:t.default.createElement(et,{marginY:"base"},t.default.createElement(ot,{color:"accentAlert",children:o("stakeAccountInsufficientFunds")}))),t.default.createElement(Ct,{canUnstake:_,canWithdrawStake:j,onClose:n,onUnstake:$,onWithdrawStake:q})):t.default.createElement(t.default.Fragment,null,t.default.createElement(b,null,t.default.createElement(r,{size:16,color:i.colors.legacy.textSecondary,lineHeight:20},o("stakeAccountViewStakeInactive.part1")," ",t.default.createElement(xt,{href:L},o("stakeAccountViewStakeInactive.part2"))),t.default.createElement(N,{stakeAccountPubkey:e.pubkey,status:l?.state,data:{"Stake Account":{node:t.default.createElement(r,{textAlign:"right",weight:500,size:14,noWrap:!0},z(e.pubkey))},Balance:{node:t.default.createElement(r,{textAlign:"right",weight:500,size:14,noWrap:!0},t.default.createElement(m,null,e.lamports))},"Rent Reserve":{node:t.default.createElement(r,{textAlign:"right",weight:500,size:14,noWrap:!0},t.default.createElement(m,null,e.info.meta.rentExemptReserve))},"Active Stake":{node:t.default.createElement(r,{textAlign:"right",weight:500,size:14,noWrap:!0},t.default.createElement(m,null,l?.active))},Lockup:{node:t.default.createElement(r,{textAlign:"right",weight:500,size:14,noWrap:!0},U?V(O):"\u2013")}}})),t.default.createElement(Ct,{canUnstake:_,canWithdrawStake:j,onClose:n,onUnstake:$,onWithdrawStake:q}))):t.default.createElement(h,null,t.default.createElement(C,null,o("stakeAccountViewPrimaryText")),t.default.createElement(b,null,t.default.createElement(r,{size:16,color:i.colors.legacy.textSecondary,lineHeight:20},o("stakeAccountViewStakeNotFound"))),t.default.createElement(M,null,t.default.createElement(g,{onClick:n},o("commandClose"))))},De=Qt,Ct=a=>{let{t:o}=y(),{canUnstake:d,canWithdrawStake:k,onClose:c,onUnstake:n,onWithdrawStake:f}=a;return t.default.createElement(M,null,t.default.createElement(g,{onClick:c},o("commandClose")),d?t.default.createElement(g,{theme:"primary",onClick:n},o("stakeAccountViewActionButtonUnstake")):null,k?t.default.createElement(g,{theme:"primary",onClick:f},o("stakeAccountViewWithdrawStake")):null)},$t=a=>{let o=ut(a),d=o.results??[],k=(0,t.useRef)(d);return k.current=d,(0,t.useMemo)(()=>new Map(k.current.map(n=>[n.voteAccountPubkey,n])),[o.dataUpdatedAt,k])};export{Qt as StakeAccountDetailPage,De as default};
//# sourceMappingURL=StakeAccountDetailPage-QUPDIHZ6.js.map
