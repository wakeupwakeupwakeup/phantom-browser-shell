import{a as Xe,b as qe,c as Ke,d as je}from"./chunk-2POO4JJE.js";import{$a as Ye,Ea as Oe,Fa as Pe,G as P,Ga as Fe,H as k,Ja as Y,Ka as $,La as Be,Ma as X,Na as F,Oa as g,Pa as q,Qa as He,R as Le,Ra as A,S as I,Sa as re,Ta as x,Ua as Ue,V as _e,Va as Ge,Wa as V,Xa as K,Ya as We,Za as j,_a as J,ab as $e,ba as W,g as Ie,h as M,ia as Ae,ja as ze,la as De,na as ke,o as we,q as Me,r as Re,t as C,u as b,v as be,va as Ve,y as Ce}from"./chunk-PQWATTJB.js";import{h as u,n as l}from"./chunk-YJSZZTEX.js";u();l();u();l();u();l();u();l();u();l();u();l();u();l();var oe=new WeakMap;function T(e){return oe.has(e)}function ne(e){let t=e;for(;t;){if(!T(t)&&!$(t))return!1;t=F(t)}return!0}function N(e){return oe.get(e)}function Je(e,t){oe.set(e,t)}function z(e,t){let r=e.tagName,n=e.value;if(V(e,t)){let o=e.type;return r==="INPUT"&&(o==="button"||o==="submit"||o==="reset")?n:!n||r==="OPTION"?void 0:A}if(r==="OPTION"||r==="SELECT")return e.value;if(!(r!=="INPUT"&&r!=="TEXTAREA"))return n}var pt=/url\((?:(')([^']*)'|(")([^"]*)"|([^)]*))\)/gm,ft=/^[A-Za-z]+:|^\/\//,mt=/^data:.*,/i;function Ze(e,t){return e.replace(pt,(r,n,o,i,c,s)=>{let a=o||c||s;if(!t||!a||ft.test(a)||mt.test(a))return r;let f=n||i||"";return`url(${f}${ht(a,t)}${f})`})}function ht(e,t){try{return Ce(e,t).href}catch{return e}}var St=/[^a-z1-6-_]/;function Z(e){let t=e.toLowerCase().trim();return St.test(t)?"div":t}function ie(e,t){return`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='${e}' height='${t}' style='background-color:silver'%3E%3C/svg%3E`}u();l();u();l();u();l();u();l();var v={FullSnapshot:2,IncrementalSnapshot:3,Meta:4,Focus:6,ViewEnd:7,VisualViewport:8,FrustrationRecord:9},L={Document:0,DocumentType:1,Element:2,Text:3,CDATA:4,DocumentFragment:11},E={Mutation:0,MouseMove:1,MouseInteraction:2,Scroll:3,ViewportResize:4,Input:5,TouchMove:6,MediaInteraction:7,StyleSheetRule:8},w={MouseUp:0,MouseDown:1,Click:2,ContextMenu:3,DblClick:4,Focus:5,Blur:6,TouchStart:7,TouchEnd:9},se={Play:0,Pause:1};u();l();function ae(e){if(!(e===void 0||e.length===0))return e.map(t=>{let r=t.cssRules||t.rules;return{cssRules:Array.from(r,i=>i.cssText),disabled:t.disabled||void 0,media:t.media.length>0?Array.from(t.media):void 0}})}u();l();u();l();function B(e,t,r,n){if(t===g.HIDDEN)return null;let o=e.getAttribute(r);if(t===g.MASK&&r!==q&&!We.includes(r)&&r!==n.actionNameAttribute){let i=e.tagName;switch(r){case"title":case"alt":case"placeholder":return A}if(i==="IMG"&&(r==="src"||r==="srcset")){let c=e;if(c.naturalWidth>0)return ie(c.naturalWidth,c.naturalHeight);let{width:s,height:a}=e.getBoundingClientRect();return s>0||a>0?ie(s,a):re}if(i==="SOURCE"&&(r==="src"||r==="srcset"))return re;if(i==="A"&&r==="href")return A;if(o&&r.startsWith("data-"))return A;if(i==="IFRAME"&&r==="srcdoc")return A}return!o||typeof o!="string"?o:Pe(o)?Fe(o):o}function Qe(e,t,r){if(t===g.HIDDEN)return{};let n={},o=Z(e.tagName),i=e.ownerDocument;for(let d=0;d<e.attributes.length;d+=1){let m=e.attributes.item(d).name,S=B(e,t,m,r.configuration);S!==null&&(n[m]=S)}if(e.value&&(o==="textarea"||o==="select"||o==="option"||o==="input")){let d=z(e,t);d!==void 0&&(n.value=d)}if(o==="option"&&t===g.ALLOW){let d=e;d.selected&&(n.selected=d.selected)}if(o==="link"){let d=Array.from(i.styleSheets).find(m=>m.href===e.href),p=ce(d);p&&d&&(n._cssText=p)}if(o==="style"&&e.sheet){let d=ce(e.sheet);d&&(n._cssText=d)}let c=e;if(o==="input"&&(c.type==="radio"||c.type==="checkbox")&&(t===g.ALLOW?n.checked=!!c.checked:V(c,t)&&delete n.checked),o==="audio"||o==="video"){let d=e;n.rr_mediaState=d.paused?"paused":"played"}let s,a,f=r.serializationContext;switch(f.status){case 0:s=Math.round(e.scrollTop),a=Math.round(e.scrollLeft),(s||a)&&f.elementsScrollPositions.set(e,{scrollTop:s,scrollLeft:a});break;case 1:f.elementsScrollPositions.has(e)&&({scrollTop:s,scrollLeft:a}=f.elementsScrollPositions.get(e));break}return a&&(n.rr_scrollLeft=a),s&&(n.rr_scrollTop=s),n}function ce(e){if(!e)return null;let t;try{t=e.rules||e.cssRules}catch{}if(!t)return null;let r=Array.from(t,be()?gt:et).join("");return Ze(r,e.href)}function gt(e){if(Et(e)&&e.selectorText.includes(":")){let t=/(\[[\w-]+[^\\])(:[^\]]+\])/g;return e.cssText.replace(t,"$1\\$2")}return et(e)}function et(e){return Nt(e)&&ce(e.styleSheet)||e.cssText}function Nt(e){return"styleSheet"in e}function Et(e){return"selectorText"in e}function D(e,t){let r=vt(e,t);if(!r)return null;let n=N(e)||Tt(),o=r;return o.id=n,Je(e,n),t.serializedNodeIds&&t.serializedNodeIds.add(n),o}var yt=1;function Tt(){return yt++}function ue(e,t){let r=[];return X(e,n=>{let o=D(n,t);o&&r.push(o)}),r}function vt(e,t){switch(e.nodeType){case e.DOCUMENT_NODE:return xt(e,t);case e.DOCUMENT_FRAGMENT_NODE:return It(e,t);case e.DOCUMENT_TYPE_NODE:return wt(e);case e.ELEMENT_NODE:return Mt(e,t);case e.TEXT_NODE:return bt(e,t);case e.CDATA_SECTION_NODE:return Ct()}}function xt(e,t){return{type:L.Document,childNodes:ue(e,t),adoptedStyleSheets:ae(e.adoptedStyleSheets)}}function It(e,t){let r=$(e);return r&&t.serializationContext.shadowRootsController.addShadowRoot(e),{type:L.DocumentFragment,childNodes:ue(e,t),isShadowRoot:r,adoptedStyleSheets:r?ae(e.adoptedStyleSheets):void 0}}function wt(e){return{type:L.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId}}function Mt(e,t){let r=Z(e.tagName),n=Rt(e)||void 0,o=Ue(Ge(e),t.parentNodePrivacyLevel);if(o===g.HIDDEN){let{width:s,height:a}=e.getBoundingClientRect();return{type:L.Element,tagName:r,attributes:{rr_width:`${s}px`,rr_height:`${a}px`,[q]:He},childNodes:[],isSVG:n}}if(o===g.IGNORE)return;let i=Qe(e,o,t),c=[];if(Be(e)&&r!=="style"){let s;t.parentNodePrivacyLevel===o&&t.ignoreWhiteSpace===(r==="head")?s=t:s={...t,parentNodePrivacyLevel:o,ignoreWhiteSpace:r==="head"},c=ue(e,s)}return{type:L.Element,tagName:r,attributes:i,childNodes:c,isSVG:n}}function Rt(e){return e.tagName==="svg"||e instanceof SVGElement}function bt(e,t){let r=K(e,t.ignoreWhiteSpace||!1,t.parentNodePrivacyLevel);if(r!==void 0)return{type:L.Text,textContent:r}}function Ct(){return{type:L.CDATA,textContent:""}}function Q(e,t,r){return D(e,{serializationContext:r,parentNodePrivacyLevel:t.defaultPrivacyLevel,configuration:t})}u();l();function le(e){return!!e.changedTouches}function R(e){return e.composed===!0&&Y(e.target)?e.composedPath()[0]:e.target}u();l();function Lt(e){return Math.abs(e.pageTop-e.offsetTop-self.scrollY)>25||Math.abs(e.pageLeft-e.offsetLeft-self.scrollX)>25}var tt=(e,t)=>{let r=self.visualViewport,n={layoutViewportX:e,layoutViewportY:t,visualViewportX:e,visualViewportY:t};if(r)Lt(r)?(n.layoutViewportX=Math.round(e+r.offsetLeft),n.layoutViewportY=Math.round(t+r.offsetTop)):(n.visualViewportX=Math.round(e-r.offsetLeft),n.visualViewportY=Math.round(t-r.offsetTop));else return n;return n},ee=e=>({scale:e.scale,offsetLeft:e.offsetLeft,offsetTop:e.offsetTop,pageLeft:e.pageLeft,pageTop:e.pageTop,height:e.height,width:e.width});u();l();function y(e,t){return{data:{source:e,...t},type:v.IncrementalSnapshot,timestamp:M()}}var _t=50;function de(e,t){let{throttled:r,cancel:n}=C(i=>{let c=R(i);if(T(c)){let s=pe(i);if(!s)return;let a={id:N(c),timeOffset:0,x:s.x,y:s.y};t(y(le(i)?E.TouchMove:E.MouseMove,{positions:[a]}))}},_t,{trailing:!1}),{stop:o}=I(e,document,["mousemove","touchmove"],r,{capture:!0,passive:!0});return{stop:()=>{o(),n()}}}function pe(e){let{clientX:t,clientY:r}=le(e)?e.changedTouches[0]:e;if(self.visualViewport){let{visualViewportX:n,visualViewportY:o}=tt(t,r);t=n,r=o}if(!Number.isFinite(t)||!Number.isFinite(r)){e.isTrusted&&W("mouse/touch event without x/y");return}return{x:t,y:r}}u();l();var rt={pointerup:w.MouseUp,mousedown:w.MouseDown,click:w.Click,contextmenu:w.ContextMenu,dblclick:w.DblClick,focus:w.Focus,blur:w.Blur,touchstart:w.TouchStart,touchend:w.TouchEnd};function fe(e,t,r){let n=o=>{let i=R(o);if(x(i,e.defaultPrivacyLevel)===g.HIDDEN||!T(i))return;let c=N(i),s=rt[o.type],a;if(s!==w.Blur&&s!==w.Focus){let d=pe(o);if(!d)return;a={id:c,type:s,x:d.x,y:d.y}}else a={id:c,type:s};let f={id:r.getIdForEvent(o),...y(E.MouseInteraction,a)};t(f)};return I(e,document,Object.keys(rt),n,{capture:!0,passive:!0})}u();l();var At=100;function H(e,t,r,n=document){let{throttled:o,cancel:i}=C(s=>{let a=R(s);if(!a||x(a,e.defaultPrivacyLevel)===g.HIDDEN||!T(a))return;let f=N(a),d=a===document?{scrollTop:J(),scrollLeft:j()}:{scrollTop:Math.round(a.scrollTop),scrollLeft:Math.round(a.scrollLeft)};r.set(a,d),t(y(E.Scroll,{id:f,x:d.scrollLeft,y:d.scrollTop}))},At),{stop:c}=Le(e,n,"scroll",o,{capture:!0,passive:!0});return{stop:()=>{c(),i()}}}u();l();var zt=200;function me(e,t){let r=Ye(e).subscribe(n=>{t(y(E.ViewportResize,n))});return{stop:()=>{r.unsubscribe()}}}function he(e,t){let r=self.visualViewport;if(!r)return{stop:b};let{throttled:n,cancel:o}=C(()=>{t({data:ee(r),type:v.VisualViewport,timestamp:M()})},zt,{trailing:!1}),{stop:i}=I(e,r,["resize","scroll"],n,{capture:!0,passive:!0});return{stop:()=>{i(),o()}}}u();l();function Se(e,t){return I(e,document,["play","pause"],r=>{let n=R(r);!n||x(n,e.defaultPrivacyLevel)===g.HIDDEN||!T(n)||t(y(E.MediaInteraction,{id:N(n),type:r.type==="play"?se.Play:se.Pause}))},{capture:!0,passive:!0})}u();l();function ge(e){function t(o,i){o&&T(o.ownerNode)&&i(N(o.ownerNode))}let r=[P(CSSStyleSheet.prototype,"insertRule",({target:o,parameters:[i,c]})=>{t(o,s=>e(y(E.StyleSheetRule,{id:s,adds:[{rule:i,index:c}]})))}),P(CSSStyleSheet.prototype,"deleteRule",({target:o,parameters:[i]})=>{t(o,c=>e(y(E.StyleSheetRule,{id:c,removes:[{index:i}]})))})];typeof CSSGroupingRule<"u"?n(CSSGroupingRule):(n(CSSMediaRule),n(CSSSupportsRule));function n(o){r.push(P(o.prototype,"insertRule",({target:i,parameters:[c,s]})=>{t(i.parentStyleSheet,a=>{let f=ot(i);f&&(f.push(s||0),e(y(E.StyleSheetRule,{id:a,adds:[{rule:c,index:f}]})))})}),P(o.prototype,"deleteRule",({target:i,parameters:[c]})=>{t(i.parentStyleSheet,s=>{let a=ot(i);a&&(a.push(c),e(y(E.StyleSheetRule,{id:s,removes:[{index:a}]})))})}))}return{stop:()=>{r.forEach(o=>o.stop())}}}function ot(e){let t=[],r=e;for(;r.parentRule;){let c=Array.from(r.parentRule.cssRules).indexOf(r);t.unshift(c),r=r.parentRule}if(!r.parentStyleSheet)return;let o=Array.from(r.parentStyleSheet.cssRules).indexOf(r);return t.unshift(o),t}u();l();function Ne(e,t){return I(e,self,["focus","blur"],()=>{t({data:{has_focus:document.hasFocus()},type:v.Focus,timestamp:M()})})}u();l();function Ee(e,t,r){let n=e.subscribe(12,o=>{var i,c;o.rawRumEvent.type==="action"&&o.rawRumEvent.action.type==="click"&&(!((c=(i=o.rawRumEvent.action.frustration)===null||i===void 0?void 0:i.type)===null||c===void 0)&&c.length)&&"events"in o.domainContext&&o.domainContext.events&&o.domainContext.events.length&&t({timestamp:o.rawRumEvent.date,type:v.FrustrationRecord,data:{frustrationTypes:o.rawRumEvent.action.frustration.type,recordIds:o.domainContext.events.map(s=>r.getIdForEvent(s))}})});return{stop:()=>{n.unsubscribe()}}}u();l();function ye(e,t){let r=e.subscribe(5,()=>{t({timestamp:M(),type:v.ViewEnd})});return{stop:()=>{r.unsubscribe()}}}u();l();function U(e,t,r=document){let n=e.defaultPrivacyLevel,o=new WeakMap,i=r!==document,{stop:c}=I(e,r,i?["change"]:["input","change"],d=>{let p=R(d);(p instanceof HTMLInputElement||p instanceof HTMLTextAreaElement||p instanceof HTMLSelectElement)&&a(p)},{capture:!0,passive:!0}),s;if(i)s=b;else{let d=[k(HTMLInputElement.prototype,"value",a),k(HTMLInputElement.prototype,"checked",a),k(HTMLSelectElement.prototype,"value",a),k(HTMLTextAreaElement.prototype,"value",a),k(HTMLSelectElement.prototype,"selectedIndex",a)];s=()=>{d.forEach(p=>p.stop())}}return{stop:()=>{s(),c()}};function a(d){let p=x(d,n);if(p===g.HIDDEN)return;let m=d.type,S;if(m==="radio"||m==="checkbox"){if(V(d,p))return;S={isChecked:d.checked}}else{let _=z(d,p);if(_===void 0)return;S={text:_}}f(d,S);let O=d.name;m==="radio"&&O&&d.checked&&document.querySelectorAll(`input[type="radio"][name="${CSS.escape(O)}"]`).forEach(_=>{_!==d&&f(_,{isChecked:!1})})}function f(d,p){if(!T(d))return;let m=o.get(d);(!m||m.text!==p.text||m.isChecked!==p.isChecked)&&(o.set(d,p),t(y(E.Input,{id:N(d),...p})))}}u();l();u();l();var Dt=100,kt=16;function nt(e){let t=b,r=[];function n(){t(),e(r),r=[]}let{throttled:o,cancel:i}=C(n,kt,{leading:!1});return{addMutations:c=>{r.length===0&&(t=Ve(o,{timeout:Dt})),r.push(...c)},flush:n,stop:()=>{t(),i()}}}function G(e,t,r,n){let o=Oe();if(!o)return{stop:b,flush:b};let i=nt(s=>{Vt(s.concat(c.takeRecords()),e,t,r)}),c=new o(we(i.addMutations));return c.observe(n,{attributeOldValue:!0,attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),{stop:()=>{c.disconnect(),i.stop()},flush:()=>{i.flush()}}}function Vt(e,t,r,n){let o=new Map;e.filter(p=>p.type==="childList").forEach(p=>{p.removedNodes.forEach(m=>{it(m,n.removeShadowRoot)})});let i=e.filter(p=>p.target.isConnected&&ne(p.target)&&x(p.target,r.defaultPrivacyLevel,o)!==g.HIDDEN),{adds:c,removes:s,hasBeenSerialized:a}=Ot(i.filter(p=>p.type==="childList"),r,n,o),f=Pt(i.filter(p=>p.type==="characterData"&&!a(p.target)),r,o),d=Ft(i.filter(p=>p.type==="attributes"&&!a(p.target)),r,o);!f.length&&!d.length&&!s.length&&!c.length||t(y(E.Mutation,{adds:c,removes:s,texts:f,attributes:d}))}function Ot(e,t,r,n){let o=new Set,i=new Map;for(let m of e)m.addedNodes.forEach(S=>{o.add(S)}),m.removedNodes.forEach(S=>{o.has(S)||i.set(S,m.target),o.delete(S)});let c=Array.from(o);Bt(c);let s=new Set,a=[];for(let m of c){if(d(m))continue;let S=x(m.parentNode,t.defaultPrivacyLevel,n);if(S===g.HIDDEN||S===g.IGNORE)continue;let O=D(m,{serializedNodeIds:s,parentNodePrivacyLevel:S,serializationContext:{status:2,shadowRootsController:r},configuration:t});if(!O)continue;let _=F(m);a.push({nextId:p(m),parentId:N(_),node:O})}let f=[];return i.forEach((m,S)=>{T(S)&&f.push({parentId:N(m),id:N(S)})}),{adds:a,removes:f,hasBeenSerialized:d};function d(m){return T(m)&&s.has(N(m))}function p(m){let S=m.nextSibling;for(;S;){if(T(S))return N(S);S=S.nextSibling}return null}}function Pt(e,t,r){var n;let o=[],i=new Set,c=e.filter(s=>i.has(s.target)?!1:(i.add(s.target),!0));for(let s of c){if(s.target.textContent===s.oldValue)continue;let f=x(F(s.target),t.defaultPrivacyLevel,r);f===g.HIDDEN||f===g.IGNORE||o.push({id:N(s.target),value:(n=K(s.target,!1,f))!==null&&n!==void 0?n:null})}return o}function Ft(e,t,r){let n=[],o=new Map,i=e.filter(s=>{let a=o.get(s.target);return a&&a.has(s.attributeName)?!1:(a?a.add(s.attributeName):o.set(s.target,new Set([s.attributeName])),!0)}),c=new Map;for(let s of i){if(s.target.getAttribute(s.attributeName)===s.oldValue)continue;let f=x(s.target,t.defaultPrivacyLevel,r),d=B(s.target,f,s.attributeName,t),p;if(s.attributeName==="value"){let S=z(s.target,f);if(S===void 0)continue;p=S}else typeof d=="string"?p=d:p=null;let m=c.get(s.target);m||(m={id:N(s.target),attributes:{}},n.push(m),c.set(s.target,m)),m.attributes[s.attributeName]=p}return n}function Bt(e){e.sort((t,r)=>{let n=t.compareDocumentPosition(r);return n&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:n&Node.DOCUMENT_POSITION_CONTAINS||n&Node.DOCUMENT_POSITION_FOLLOWING?1:n&Node.DOCUMENT_POSITION_PRECEDING?-1:0})}function it(e,t){Y(e)&&t(e.shadowRoot),X(e,r=>it(r,t))}u();l();function Te(){let e=new WeakMap;return{set(t,r){t===document&&!document.scrollingElement||e.set(t===document?document.scrollingElement:t,r)},get(t){return e.get(t)},has(t){return e.has(t)}}}u();l();var st=(e,t,r)=>{let n=new Map,o={addShadowRoot:i=>{if(n.has(i))return;let c=G(t,e,o,i),s=U(e,t,i),a=H(e,t,r,i);n.set(i,{flush:()=>c.flush(),stop:()=>{c.stop(),s.stop(),a.stop()}})},removeShadowRoot:i=>{let c=n.get(i);c&&(c.stop(),n.delete(i))},stop:()=>{n.forEach(({stop:i})=>i())},flush:()=>{n.forEach(({flush:i})=>i())}};return o};u();l();function at(e,t,r,n,o,i){let c=(a=M(),f={status:0,elementsScrollPositions:e,shadowRootsController:t})=>{let{width:d,height:p}=$e(),m=[{data:{height:p,href:self.location.href,width:d},type:v.Meta,timestamp:a},{data:{has_focus:document.hasFocus()},type:v.Focus,timestamp:a},{data:{node:Q(document,n,f),initialOffset:{left:j(),top:J()}},type:v.FullSnapshot,timestamp:a}];return self.visualViewport&&m.push({data:ee(self.visualViewport),type:v.VisualViewport,timestamp:a}),m};i(c());let{unsubscribe:s}=r.subscribe(2,a=>{o(),i(c(a.startClocks.timeStamp,{shadowRootsController:t,status:1,elementsScrollPositions:e}))});return{stop:s}}u();l();function ct(){let e=new WeakMap,t=1;return{getIdForEvent(r){return e.has(r)||e.set(r,t++),e.get(r)}}}function ve(e){let{emit:t,configuration:r,lifeCycle:n}=e;if(!t)throw new Error("emit function is required");let o=m=>{t(m),_e("record",{record:m});let S=e.viewHistory.findView();Ke(S.id)},i=Te(),c=st(r,o,i),{stop:s}=at(i,c,n,r,a,m=>m.forEach(S=>o(S)));function a(){c.flush(),d.flush()}let f=ct(),d=G(o,r,c,document),p=[d,de(r,o),fe(r,o,f),H(r,o,i,document),me(r,o),U(r,o),Se(r,o),ge(o),Ne(r,o),he(r,o),Ee(n,o,f),ye(n,m=>{a(),o(m)})];return{stop:()=>{c.stop(),p.forEach(m=>m.stop()),s()},flushMutations:a,shadowRootsController:c}}u();l();u();l();u();l();function ut(e,t,r){let n=new FormData;n.append("segment",new Blob([e],{type:"application/octet-stream"}),`${t.session.id}-${t.start}`);let o={raw_segment_size:r,compressed_segment_size:e.byteLength,...t},i=JSON.stringify(o);return n.append("event",new Blob([i],{type:"application/json"})),{data:n,bytesCount:e.byteLength}}u();l();function lt({context:e,creationReason:t,encoder:r}){let n=0,o=e.view.id,i={start:1/0,end:-1/0,creation_reason:t,records_count:0,has_full_snapshot:!1,index_in_view:Xe(o),source:"browser",...e};qe(o);function c(a,f){i.start=Math.min(i.start,a.timestamp),i.end=Math.max(i.end,a.timestamp),i.records_count+=1,i.has_full_snapshot||(i.has_full_snapshot=a.type===v.FullSnapshot);let d=r.isEmpty?'{"records":[':",";r.write(d+JSON.stringify(a),p=>{n+=p,f(n)})}function s(a){if(r.isEmpty)throw new Error("Empty segment flushed");r.write(`],${JSON.stringify(i).slice(1)}
`),r.finish(f=>{je(i.view.id,f.rawBytesCount),a(i,f)})}return{addRecord:c,flush:s}}var Ut=5*Ie,te=6e4;function xe(e,t,r,n,o,i){return Gt(e,()=>Wt(t.applicationId,r,n),o,i)}function Gt(e,t,r,n){let o={status:0,nextSegmentCreationReason:"init"},{unsubscribe:i}=e.subscribe(2,()=>{s("view_change")}),{unsubscribe:c}=e.subscribe(11,a=>{s(a.reason)});function s(a){o.status===1&&(o.segment.flush((f,d)=>{let p=ut(d.output,f,d.rawBytesCount);ke(a)?r.sendOnExit(p):r.send(p)}),Re(o.expirationTimeoutId)),a!=="stop"?o={status:0,nextSegmentCreationReason:a}:o={status:2}}return{addRecord:a=>{if(o.status!==2){if(o.status===0){let f=t();if(!f)return;o={status:1,segment:lt({encoder:n,context:f,creationReason:o.nextSegmentCreationReason}),expirationTimeoutId:Me(()=>{s("segment_duration_limit")},Ut)}}o.segment.addRecord(a,f=>{f>te&&s("segment_bytes_limit")})}},stop:()=>{s("stop"),i(),c()}}}function Wt(e,t,r){let n=t.findTrackedSession(),o=r.findView();if(!(!n||!o))return{application:{id:e},session:{id:n.id},view:{id:o.id}}}u();l();function dt(e){let t=ze();return{addRecord:r=>{let n=e.findView();t.send("record",r,n.id)}}}function Ji(e,t,r,n,o,i){let c=[],s=p=>{e.notify(14,{error:p}),W("Error reported to customer",{"error.message":p.message})},a=i||Ae(t.sessionReplayEndpointBuilder,te,s),f;if(De())({addRecord:f}=dt(n));else{let p=xe(e,t,r,n,a,o);f=p.addRecord,c.push(p.stop)}let{stop:d}=ve({emit:f,configuration:t,lifeCycle:e,viewHistory:n});return c.push(d),{stop:()=>{c.forEach(p=>p())}}}export{Ji as startRecording};
//# sourceMappingURL=startRecording-4IFME6YA.js.map
